

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="JiuGuiChen">
  <meta name="keywords" content="A,B,C">
  
    <meta name="description" content="VBA学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="【Excel高阶】宏与VBA">
<meta property="og:url" content="http://example.com/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/index.html">
<meta property="og:site_name" content="九规而已">
<meta property="og:description" content="VBA学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/Excel.png">
<meta property="article:published_time" content="2025-02-26T14:41:14.000Z">
<meta property="article:modified_time" content="2025-02-26T15:31:17.876Z">
<meta property="article:author" content="JiuGuiChen">
<meta property="article:tag" content="A,B,C">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/Excel.png">
  
  
  
  <title>【Excel高阶】宏与VBA - 九规而已</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":1},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":null,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"RVBrkM2zzP4n38YaXKMiT7qo-gzGzoHsz","app_key":"GOhdYcrdXsQttxanHr7Hglmo","server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>九规而已</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/Excel.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="【Excel高阶】宏与VBA"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-26 22:41" pubdate>
          2025年2月26日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          19k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          157 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span>次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">【Excel高阶】宏与VBA</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="【Chapter-1】宏录制方法与技巧"><a href="#【Chapter-1】宏录制方法与技巧" class="headerlink" title="【Chapter 1】宏录制方法与技巧"></a>【Chapter 1】宏录制方法与技巧</h1><h2 id="什么是宏和VBA"><a href="#什么是宏和VBA" class="headerlink" title="什么是宏和VBA"></a>什么是宏和VBA</h2><p>1.VBA（Visual Basic for Applications），一种编程语言。</p>
<p>2.通过VBA编写的一系列指令组成的程序，称之为宏。</p>
<p>3.通过学习VBA编写宏，有利于我们高效完成重复性的数据任务。</p>
<h2 id="宏安全设置"><a href="#宏安全设置" class="headerlink" title="宏安全设置"></a>宏安全设置</h2><p>文件-选项-信任中心-信任中心设置-受信任位置，只要是在这些路径下的Excel文档，我们都认为它是安全的。</p>
<h1 id="【Chapter-2】VBA编程基础语法"><a href="#【Chapter-2】VBA编程基础语法" class="headerlink" title="【Chapter 2】VBA编程基础语法"></a>【Chapter 2】VBA编程基础语法</h1><h2 id="相对引用"><a href="#相对引用" class="headerlink" title="相对引用"></a>相对引用</h2><p><a target="_blank" rel="noopener" href="https://www.notion.so/Excel-96c86e13f15644329bef8d9b6ed696e1?pvs=21"><strong>Excel 录制宏时绝对和相对引用的区别</strong></a></p>
<p>不使用相对引用，就是每一次执行宏都是对同一个区域进行操作；使用了相对引用，就是对一开始选定的“活动单元格”后面的相对区域，即进行一定的位置偏移，进行后续操作。</p>
<h2 id="运行宏的方法"><a href="#运行宏的方法" class="headerlink" title="运行宏的方法"></a>运行宏的方法</h2><ol>
<li>自定义的快捷键</li>
<li>表单控件：一个按钮</li>
<li>快速访问工具栏</li>
</ol>
<h2 id="自己编写VBA代码"><a href="#自己编写VBA代码" class="headerlink" title="自己编写VBA代码"></a>自己编写VBA代码</h2><p>Sub 表示一个子程序，可以理解为一串代码的集合</p>
<p>MsgBox就是弹出一个弹窗，显示相应的信息</p>
<p>点击三角形，或者按F5，就是运行这个VBA代码</p>
<h2 id="多个VBA程序及引用单元格内容"><a href="#多个VBA程序及引用单元格内容" class="headerlink" title="多个VBA程序及引用单元格内容"></a>多个VBA程序及引用单元格内容</h2><p>在同一个模块中，有多个子程序：</p>
<p>MsgBox “B2单元格内容是:”&amp;Range(B2).Value</p>
<p>就是引用了第二个单元格的内容，会出现一个弹窗</p>
<p>上下有两个Sub，也叫子程序，当鼠标点在第一个子程序时，就会运行第一个；鼠标点在第二个子程序时，就会运行第二个子程序。</p>
<p>假如有多个模块，可能在运行的时候，需要手动选择，要运行的是哪一个代码。</p>
<p>运行VBA代码的另一种方法：</p>
<ol>
<li><p>视图-立即窗口，在下面的小窗口中，输入“Call ＋宏的名字”，再按回车，也能运行。</p>
<p>call：调用的意思</p>
</li>
<li><p>开发工具-宏-运行</p>
</li>
</ol>
<h2 id="变量的含义"><a href="#变量的含义" class="headerlink" title="变量的含义"></a>变量的含义</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Dim 变量名 As 数据类型
变量名&#x3D;变量值（赋值）
MsgBox 变量名（通过窗口展示变量数据）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<p>同样都能存储数值，不同变量类型能存储的数据范围不同，详情看上面的表。一字节8位，可以容纳的大小是2的8次方减1，因为从0开始计算。</p>
<p>整数：比如我们要存储的数据范围在0-255之间，Byte就可以了。<strong>但是我们一般就直接用Integer和Long就可以。</strong></p>
<p>小数：用Double</p>
<p>日期：用Date</p>
<h2 id="不同数据类型的变量"><a href="#不同数据类型的变量" class="headerlink" title="不同数据类型的变量"></a>不同数据类型的变量</h2><p>整数类型：</p>
<p>当定义了一个变量为Integer，先后定义它为100，200，50000，就会弹窗为100，200，溢出，因为Integer最大值只有30000多。</p>
<p>小数类型代码：</p>
<p>把代码注释掉的方法：</p>
<p>选中代码，选择“编辑”，“编辑”块里面有个功能“设置注释块”。</p>
<p>同理，选择“解除注释块”就能取消注释。</p>
<p>日期类型代码：</p>
<p>注意，日期要用两个#包围起来</p>
<p>弹窗显示的日期格式，会是和电脑本身日期显示的格式一样，所以如果只显示了一部分内容，就去调整本机的日期格式。</p>
<p>文本类型代码：</p>
<p>要用英文的双引号</p>
<p>布尔类型变量：</p>
<p>赋值的时候，会有个自动出现的框，让你自己选是true，还是false</p>
<h2 id="多变量声明"><a href="#多变量声明" class="headerlink" title="多变量声明"></a>多变量声明</h2><p>不用每个都Dim，只需要Dim一次，后面加个逗号，新变量</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">&#96;&#96;&#96;vba
Sub 多变量声明()
    Dim Score As Integer, price As Double, birthday As Date
    
    Score &#x3D; 100
    price &#x3D; 9.8
    birthday &#x3D; #12&#x2F;8&#x2F;1998#
    
    MsgBox Score
    MsgBox price
    MsgBox birthday
    
End Sub
&#96;&#96;&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Variant可变数据类型"><a href="#Variant可变数据类型" class="headerlink" title="Variant可变数据类型"></a>Variant可变数据类型</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub 测试variant()
    Dim Var
    Var &#x3D; 100
    MsgBox Var
    
    Var &#x3D; #12&#x2F;8&#x2F;1998#
    MsgBox Var
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>可以存储整数，也可以存储日期等</p>
<p>可以用，但不推荐，会浪费内存空间</p>
<h2 id="强制变量声明"><a href="#强制变量声明" class="headerlink" title="强制变量声明"></a>强制变量声明</h2><p>Option Explicit</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub OptionTest()
    Dim Score As Integer
    Score &#x3D; 100
    MsgBox Scor
&#39;变量书写错误
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>若是无<code>Option Explicit</code>这一句，那么在输错变量名的时候，只会弹出一个“空”的弹窗，不利于纠错；加上后，就会提示，变量未定义。</p>
<p>若是记不住这行代码，也可以在“工具-选项-编辑器-要求变量声明”，选中“要求变量声明”，即可在新建模块时，自动加上这句代码。</p>
<h2 id="变量的生命周期"><a href="#变量的生命周期" class="headerlink" title="变量的生命周期"></a>变量的生命周期</h2><p>变量，实际上是占用了电脑的内存空间，所以需要有“死”的时机。</p>
<p>变量的生命周期，只存在于这个子程序内；在其他的子程序Sub时，就获取不到这个变量了。</p>
<p>（Sub和End Sub之间，就是一个子程序。）</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit
Sub Moudle1()
    Dim Score As Integer
    Score &#x3D; 100
    MsgBox Score
End Sub

Sub Moudle2()
    MsgBox Score
End Sub
&#39;会提示“变量未定义”<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>若是想要让一个变量的生命周期，在多个子程序中都能使用：就在开头就定义这个变量</p>
<p>先运行Moudle1()，显示100；再运行Moudle2()，也显示100。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

&#39;生命周期的范围只能是当前模块内
Dim Score As Integer

Sub Moudle1()
    Score &#x3D; 100
    MsgBox Score
End Sub

Sub Moudle2()
    MsgBox Score
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>若是想要让一个变量的生命周期，超过当前模块，即在多个模块中都能使用：就在开头，把Dim改成Public，这样定义这个变量。</p>
<p>如果Moudle1运行过再运行Moudle3，那么Moudle3的结果就是100；如果Moudle1没有运行过再运行Moudle3，那么Moudle3的结果就是0。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

&#39;生命周期的范围只能是当前模块内
Public Score As Integer

Sub Moudle1()
    Score &#x3D; 100
    MsgBox Score
End Sub

Sub Moudle2()
    MsgBox Score
End Sub

&#39;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;另一个模块内
Sub Moudle3()
    MsgBox Score
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="static修饰符"><a href="#static修饰符" class="headerlink" title="static修饰符"></a>static修饰符</h2><p>static表示的意思是，当这个程序运行完毕之后，这个变量占据的内存空间并不会消失，所以第一次执行之后初始值就还是0，结果count为1；第二次执行时count的初始值就是1，结果就是2。</p>
<p>如果用的是Dim，那么每次执行结束，这个变量占据的内存空间就会消失，第二次执行时，count的初始值就还是0，结果还是1。</p>
<p>如果担心占用内存，有两种方法可以解决：<br>方法①：可以单击这个“重新设置”，那么这个程序就彻底结束，即使是static修饰的变量，那么这个内存也会重新释放，再运行就是从初始值0开始；<br>方法②关闭掉该工作簿，因为变量占据的内存空间，实际上是依附于这个工作簿，工作簿关闭后，内存空间肯定会被释放。</p>
<aside>
💡 用static修饰的变量，它的生命周期会超出这个子程序的范围，所以可以用来统计这个程序用了多少次；但是在第二个子程序中仍然无法使用。
    <aside>

<h2 id="常量的使用"><a href="#常量的使用" class="headerlink" title="常量的使用"></a>常量的使用</h2><p>变量：在内存空间中，存储的数据会发生变化；常量：存储的数据不会发生变化。</p>
<p>Option Explicit</p>
<p> ‘如果想要在多个模块中使用这个常量，可以加个public<br>‘Public Const PI As Double &#x3D; 3.1415926</p>
<p> ‘如果想要让这个常量在多个子程序中都能使用，可以把这个常量的声明定义放在这个子程序外面；<br>‘Const PI As Double &#x3D; 3.1415926</p>
<p>Sub constant()<br>    ‘定义常量使用Const而不是Dim<br>    ‘定义常量的时候就要进行赋值<br>    ‘常量不能修改数值<br>    Const PI As Double &#x3D; 3.1415926</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Dim Price As Double
MsgBox Price
&#39;变量的话，是有一个初始值0的
&#39;赋值之后才会有新的值
Price &#x3D; 4.5
MsgBox Price

Dim Area As Double
&#39;计算半径为2的圆的面积
Area &#x3D; PI * 2 * 2
MsgBox &quot;半径为2的圆的面积是：&quot; &amp; Area

&#39;使用常量的好处在于非常直观
&#39;常量也有生命周期，在这个子程序中定义了这个常量，在另一个子程序中就无法使用；
&#39;如果想要让这个常量在多个子程序中都能使用，可以把这个常量的声明定义放在这个子程序外面；
&#39;如果想要在多个模块中使用这个常量，可以加个public

   &#39; VBA内置常量
    ActiveCell.Interior.Color &#x3D; vbGreen
    &#39;把活动单元格的颜色变成红色
    &#39;vbRed和vbGreen都是常量
    &#39;也就是内部有这么一句：Const vbRed As Integer &#x3D; 255

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="数学运算符"><a href="#数学运算符" class="headerlink" title="数学运算符"></a>数学运算符</h2><p>数学运算符：+加、-减、*乘、&#x2F;除、^幂运算、Mod取余</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub OperationTest()
    Dim num1 As Integer, num2 As Integer
    
    num1 &#x3D; 10
    num2 &#x3D; 20
    
    &#39;数学运算符+、-、*、&#x2F;、^幂运算、Mod取余
    Dim result1 As Integer
    
    result1 &#x3D; num1 + num2
    MsgBox result1
    &#39;结果为30
    
    result1 &#x3D; num1 &#x2F; num2
    MsgBox result1
    &#39;结果为0,原因是result1是整数类型，就忽略了小数部分
    &#39;如果把result1设置为double小数类型，就能显示为0.5
    
    Dim result2 As Double
    result2 &#x3D; num1 ^ num2
    MsgBox result2
    &#39;用double的数据类型，结果是1E+20，即10的20次方，其他数据类型会显示溢出
    
    Dim result3 As Integer
    result3 &#x3D; num1 Mod num2
    &#39;10除以20，取余，还是10
    MsgBox result3
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><p>用法：主要用于判断，走不同的分支（分支判断）</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub bijiaotest()
    Dim num1 As Integer, num2 As Integer
    num1 &#x3D; 10
    num2 &#x3D; 20
    
    &#39;比较运算符&gt; &lt; &gt;&#x3D; &lt;&#x3D; &#x3D; &lt;&gt;
    Dim result As Boolean
    
    
    result &#x3D; num1 &gt; num2
    MsgBox result
    &#39;结果是0，根据布尔值和integer，False就是0，True是1
    &#39;如果Dim result As Boolean,那么就会显示为False
    
    result &#x3D; num1 &lt; num2
    MsgBox result
    &#39;结果是-1 &#x2F; TRUE
    
    
    
    &#39;&gt;&#x3D;，大于或等于，都能成立
    result &#x3D; num1 &lt;&#x3D; num2
    MsgBox result
    &#39;结果是-1 &#x2F; TRUE
    
    &#39;&#x3D;，等于，为了方便区分，可以在判断的式子里面加上括号进行区分
    result &#x3D; (num1 * 2 &#x3D; num2)
    MsgBox result
    &#39;结果是-1 &#x2F; TRUE
    
    &#39;&lt;&gt;，不等于
    result &#x3D; num1 &lt;&gt; num2
    MsgBox result
    &#39;结果是-1 &#x2F; TRUE
    

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li><p>补充：为什么在vba中True&#x3D;-1?</p>
<p>当在vba中执行语句  MsgBox -1 &#x3D; True 时，将弹出True。<br>也就是在vba中True&#x3D;-1，这个是为什么呢。</p>
<p>因为Boolean类型的变量以两个字节存储，而值只能是True 或者 False，它表示的是两个相反的状态。</p>
<p>其中0的二进制形式为“0000 0000 0000 0000”，与0相反的二进制形式为“1111 1111 1111 1111”，这个二进制形式刚好是-1在内存中的存储形式，所以用这两种相反的状态来分别表示False 或者 True，这样True&#x3D;-1。</p>
</li>
</ul>
<h2 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub luojiyunsuanfu()
    Dim num1 As Integer, num2 As Integer, num3 As Integer
    
    num1 &#x3D; 2
    num2 &#x3D; 10
    num3 &#x3D; 20
    
    &#39;逻辑运算符And, Not, Or
    &#39;逻辑运算符主要是针对True和False来运算的
    Dim result As Boolean
    
    &#39;num1 &gt; num2
    &#39;False
    
    &#39;num1 &gt; num3
    &#39;False

    &#39;num3 &gt; num2
    &#39;True
    
    &#39;num2 &gt; num1
    &#39;True
    
    
    &#39;And，左右都是True，结果才是True
    result &#x3D; (num2 &gt; num1) And (num1 &gt; num3)
    MsgBox result
    &#39;一个True,一个False，用And，结果是False
    
    &#39;Or，左边或右边有一个为True，结果就是True
    result &#x3D; (num2 &gt; num1) Or (num1 &gt; num3)
    MsgBox result
    &#39;一个True,一个False，用Or，结果是True
    
    &#39;Not，Not False &#x3D; True
    result &#x3D; Not ((num2 &gt; num1) And (num1 &gt; num3))
    MsgBox result
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>



<h2 id="VBA命名规范"><a href="#VBA命名规范" class="headerlink" title="VBA命名规范"></a>VBA命名规范</h2><h2 id="If选择结构"><a href="#If选择结构" class="headerlink" title="If选择结构"></a>If选择结构</h2><p>有3种if语句判断的结构：1个分支；2个分支；多个分支</p>
<p>多个分支时注意判断的顺序</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit
Sub IfTest()
    Dim score As Integer
    score &#x3D; 95
   
   
    &#39;第一种If语句：一个分支
    &#39;score &gt;&#x3D;60,一个判断条件
    &#39;then，如果符合条件要做什么
    &#39;If开头，End If结尾
    If score &gt;&#x3D; 60 Then
        MsgBox &quot;PASS&quot;
    End If
    
    
    
    &#39;第二种If语句：两个分支
    &#39;else表示，如果不满足条件，要做什么
    If score &gt;&#x3D; 60 Then
        MsgBox &quot;PASS&quot;
    Else
        MsgBox &quot;NO PASS&quot;
    End If
    
    
    
    &#39;第三种If语句：多个分支
    &#39;&gt;&#x3D;90,优秀；&gt;&#x3D;80,中上；&gt;&#x3D;70,普通；&gt;&#x3D;60,及格；&lt;60,不及格
    &#39;注意判断的顺序，如果先判断是否大于80，再判断是否大于90，就会只显示大于80的结果
    If score &gt;&#x3D; 90 Then
        MsgBox &quot;优秀&quot;
    ElseIf score &gt;&#x3D; 80 Then
        MsgBox &quot;中上&quot;
    ElseIf score &gt;&#x3D; 70 Then
        MsgBox &quot;普通&quot;
    ElseIf score &gt;&#x3D; 60 Then
        MsgBox &quot;及格&quot;
    Else
        MsgBox &quot;不及格&quot;
    End If
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="SelectCase选择结构"><a href="#SelectCase选择结构" class="headerlink" title="SelectCase选择结构"></a>SelectCase选择结构</h2><p>if 的好处是可以灵活设置判断条件；<br>selcet case 就只能对上面设置的变量值做判断</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit
Sub SelectCaseTest()
    Dim score As Integer
    score &#x3D; 7
    
    &#39;Select Case表示基于某个变量的不同情况，进行不同的处理措施
    &#39;Case Is：表示针对特定的情况进行处理
    &#39;Case Else：表示如果上方的条件都不满足，该如何处理
    &#39;只能针对某一个变量进行处理，所以应用场景比if少很多
    Select Case score
        Case Is &gt;&#x3D; 90
            MsgBox &quot;优秀&quot;
        Case Is &gt;&#x3D; 80
            MsgBox &quot;中上&quot;
        Case Is &gt;&#x3D; 70
            MsgBox &quot;普通&quot;
        Case Is &gt;&#x3D; 60
            MsgBox &quot;及格&quot;
        Case Else
            MsgBox &quot;不及格&quot;
    
    
    End Select

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="For-Next循环结构"><a href="#For-Next循环结构" class="headerlink" title="For-Next循环结构"></a>For-Next循环结构</h2><h2 id="For-Next循环结构-1"><a href="#For-Next循环结构-1" class="headerlink" title="For-Next循环结构"></a>For-Next循环结构</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ForNextTest()
    Dim num As Integer
    
    &#39;用法一：连续展示某个信息5次
    &#39;num&#x3D;1表示先设置num变量的值为1，只有在第一次的时候才会进行赋值，后面只会判断是否超出条件(&gt;5)
    &#39;to 5 表示，当num &gt; 5 的时候，循环停止
    
    For num &#x3D; 1 To 5
        MsgBox num &amp; &quot;：循环结构&quot;
        &#39;next num表示每次循环num的值加1
        &#39;num &#x3D; num + 1
        Next num
    
    
&#39;第一次循环，Num＝1；弹出窗口，显示：1:循环结构；Num＝2
&#39;第二次循环，Num＝2；弹出窗口，显示：2:循环结构；Num＝3
&#39;第三次循环，Num＝3；弹出窗口，显示：3:循环结构；Num＝4
&#39;第四次循环，Num＝4；弹出窗口，显示：4:循环结构；Num＝5
&#39;第五次循环，Num＝5；弹出窗口，显示：5:循环结构；Num＝6；6 &gt; 5，循环结束
    
    

    &#39;用法二：计算1~100的求和结果
    &#39;如果求和结果过大，可以把total改成long
    Dim total As Integer
    total &#x3D; 0
        For num &#x3D; 1 To 3
            total &#x3D; total + num
            Next num
            MsgBox total

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Step的应用场景"><a href="#Step的应用场景" class="headerlink" title="Step的应用场景"></a>Step的应用场景</h2><p>控制变量在每次循环的时候，加多少的值，不加默认加1</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit
Sub StepTest()
    Dim num As Integer, total As Integer
    
    &#39;计算1~100里面的奇数求和结果
    &#39;1+3+5+7+……+99
    &#39;step 2 ，就是每次next num，每次加2的意思
    &#39;不写step 2 ，就是默认每次＋1
    For num &#x3D; 1 To 100 Step 2
        total &#x3D; total + num
        Next num
    
    MsgBox total
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="如何中断For循环"><a href="#如何中断For循环" class="headerlink" title="如何中断For循环"></a>如何中断For循环</h2><p>Exit For：这句话作用就是满足条件时退出for循环，一般搭配 If 来用</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit
Sub StepTest()
    Dim num As Integer, total As Integer
    
    
    &#39;让For循环中途退出
    &#39;计算1~50相加的结果，但是前面还是写的1到100
    For num &#x3D; 1 To 100
        If num &gt; 50 Then
            &#39;Exit For：这句话作用就是满足条件时退出for循环，一般搭配if来用
            Exit For
        End If
        total &#x3D; total + num
        Next num
    
    MsgBox num
    MsgBox total
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="嵌套for循环"><a href="#嵌套for循环" class="headerlink" title="嵌套for循环"></a>嵌套for循环</h2><p>大循环执行一次，小循环可能执行好几次</p>
<p>不建议嵌套3次for循环，一般只嵌套两次for循环</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ForForNextTest()
    Dim num1 As Integer, num2 As Integer
    Dim total As Long
    
  
    For num1 &#x3D; 1 To 3
        For num2 &#x3D; 1 To 3
            total &#x3D; total + num1 * num2
        Next num2
    Next num1

MsgBox total

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="DoUntil循环结构"><a href="#DoUntil循环结构" class="headerlink" title="DoUntil循环结构"></a>DoUntil循环结构</h2><p>满足条件，中断循环</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub DoUntilTest()
    Dim num As Integer
    num &#x3D; 1
    
    
    &#39;num &gt; 10，如果满足条件，则中断循环
    &#39;执行10次
&#39;    Do Until num &gt; 10
&#39;        MsgBox num &amp; &quot;：循环结构&quot;
&#39;        num &#x3D; num + 1
&#39;    Loop

    Dim total As Integer
    total &#x3D; 0
    
    &#39;计算1~100的数据相加的结果
    Do Until num &gt; 100
        total &#x3D; total + num
        num &#x3D; num + 1
    Loop

    MsgBox total

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="编写无参数子过程"><a href="#编写无参数子过程" class="headerlink" title="编写无参数子过程"></a>编写无参数子过程</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

&#39;无参数子过程，就是指“Sub SubTest()”，括号里面没有任何的参数的子过程
&#39;无参数子过程，可以把固定功能的代码放在一个子程序中

&#39;子过程（子函数、子程序）
Sub SubTest()
    &#39;包裹了一系列的指令代码，
    Dim num As Integer, total As Integer
    
    For num &#x3D; 1 To 10
        total &#x3D; total + num
        Next num
      
    MsgBox total
    
    Exit Sub
    &#39;表示中断这个子程序的执行
    &#39;后面的代码不会再执行了
  
    MsgBox total
End Sub

&#39;比如我们想写另一个功能代码，就可以再写一个子程序，
&#39;通过子程序&#x2F;子过程，可以把不同的功能分开
&#39;而在执行的时候，可以单击这个子程序(就是鼠标点在这个子程序里面)，就可以了<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="有参数子过程的编写和调用"><a href="#有参数子过程的编写和调用" class="headerlink" title="有参数子过程的编写和调用"></a>有参数子过程的编写和调用</h2><h3 id="一个参数"><a href="#一个参数" class="headerlink" title="一个参数"></a>一个参数</h3><p>上面的代码，<code>For num = 1 To 10</code>，若是想要这个10变成一个可变的数字，可以在<code>Sub SubTest()</code>的括号里，声明一个参数，这个参数就是变量。所以可以改成<code>Sub SubTest(ToNum As Integer)</code>，此时就可以把下面的改成<code>For num = 1 To ToNum</code>，这时就获得了一个有参数的子过程，也就可以调用这个子过程，并且传入一个参数，那执行的时候，传入的值就会替换掉<code>ToNum</code>。</p>
<p>如何调用这种有参数的子过程？——可以再去写一个子过程<code>Sub Test()</code>（无参数），来进行调用。</p>
<p>可以多次计算，1到10,1到100,1到1000，的结果。</p>
<p>这样就无需修改第一部分<code>Sub SubTest(ToNum As Integer)</code>的代码，因为有时含有参数的子程序会非常长，若是每次都要去代码内部修改，很有可能会出错（误删代码or修改错误），风险较高；所以我们就把固定功能的代码，保持不动，只需要把参数进行调整、传入进去。</p>
<p>如果传入的是10，那么程序在执行第一部分的子程序时，<code>ToNum</code>就接收了10这个值，执行时它就是10；100和1000同理。</p>
<p>如果传入的是10，那么程序在执行第一部分的子程序时，<code>ToNum</code>就接收了10这个值，执行时它就是10；100和1000同理。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub SubTest(ToNum As Integer)
    Dim num As Integer, total As Long
    
    For num &#x3D; 1 To ToNum
        total &#x3D; total + num
        Next num
      
    MsgBox total   
    Exit Sub
    MsgBox total
End Sub

Sub Test()
    SubTest (10)
    SubTest (100)
    SubTest (1000)
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>有参数的子过程，什么时候去使用？</p>
<p>当我们写了某一个功能后，可能针对其中的内容会经常进行调整，这时可以把它设置成一个变量，把这个变量作为一个参数放到前面的<code>sub()</code>的括号中。</p>
<p>如果有不止一个参数呢？——在前面的<code>sub()</code>的括号中，用逗号进行分隔……</p>
<h3 id="多个参数"><a href="#多个参数" class="headerlink" title="多个参数"></a>多个参数</h3><p>用逗号进行分隔</p>
<p>比如可以更改每次增长的数值为变量<code>AddStep</code>，在调用这种有多个参数的子过程的时候，注意：若有多个参数，就不再用左右的括号，改用英文逗号。第一个参数的值表示<code>ToNum</code>的值，第二个参数表示 <code>AddStep</code>的值</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub SubTest(ToNum As Integer, AddStep As Integer)
    Dim num As Integer, total As Long
    
    For num &#x3D; 1 To ToNum Step AddStep
        total &#x3D; total + num
        Next num
      
    MsgBox total
    
    Exit Sub

    MsgBox total
    

End Sub

Sub Test()
    &#39;SubTest (10)
    SubTest 100, 2
    SubTest 1000, 2
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>子程序的调用？</p>
<p>无参数的子程序调用方法：</p>
<ol>
<li>在编写程序的界面，直接单击运行；</li>
<li>在“开发工具”-“宏”，选择对应的宏程序，单击运行；</li>
<li>设置快捷键运行；</li>
<li>添加表单，即一个按钮来运行；</li>
<li>快速访问工具栏；</li>
<li>在编写程序的界面，“立即窗口”。</li>
<li>单独再去写一个（无参数）子程序，去调用无参数的子程序；</li>
</ol>
<p>有参数的子程序调用方法：</p>
<ol>
<li>单独再去写一个（无参数）子程序，去调用有参数的子程序；</li>
</ol>
<p>宏录制？</p>
<p>宏录制时编写的程序，都属于无参数的子程序；有参数的子程序，必须手动编写，无法录制宏。</p>
<h2 id="编写自定义函数：Function表示函数过程"><a href="#编写自定义函数：Function表示函数过程" class="headerlink" title="编写自定义函数：Function表示函数过程"></a>编写自定义函数：Function表示函数过程</h2><p>函数和子过程的区别——函数过程有返回值，子过程没有返回值。</p>
<p>function过程类似于Excel内置的工作表函数，主要有2个用途：①口 在工作表公式中使用，弥补 Excel 内置西数无法实现的计算功能，简化公式的复杂度。②在VBA 中被其他过程调用，或者作为表达式的一部分参与运算。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

&#39;Function表示函数过程，而不是子过程
&#39;这里的功能是计算两个数的立方值的和，返回给CubeSum
Function CubeSum(x As Double, y As Double)
    CubeSum &#x3D; x * x * x + y * y * y
End Function

Sub Test()
&#39;方法一：赋值给一个新变量
    Dim value As Double
    value &#x3D; CubeSum(1.5, 2.5)
    MsgBox value

&#39;方法二：不用定义新变量，直接弹窗出结果
    MsgBox CubeSum(1.5, 2.5)
End Sub

&#39;对三个值进行求和
Function MySum(x As Integer, y As Integer, z As Integer)
    MySum &#x3D; x + y + z
End Function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>上面我们自定义的函数，如何在Excel中使用？</p>
<ol>
<li>在单元格内输入<code>=CubeSum(A1,A2)</code>，就可以求出 A1单元格值的立方＋A2单元格值的立方的和。</li>
<li>“插入函数”-“选择分类”-“用户定义”-“确定”，就可以去自定义设定函数的参数了，再单击“确定”。</li>
</ol>
<p>还可以设置返回值的类型</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Function CubeSum(x As Double, y As Double) As Double
    CubeSum &#x3D; x * x * x + y * y * y
End Function
&#39;这里是让返回值的数据类型是Double<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ArrayTest()
    &#39;声明定义一维数组
    Dim MyArray(0 To 2) As Integer
    
    &#39;为一维数组赋值
    MyArray(0) &#x3D; 0
    MyArray(1) &#x3D; 100
    MyArray(2) &#x3D; 200
    
    &#39;访问某一个模块中的数据
    MsgBox MyArray(2)
    
    &#39;遍历方式访问一维数组
    Dim index As Integer
    For index &#x3D; 0 To 2
        MsgBox MyArray(index)
        Next index
        
    &#39;LBound表示数组的最小的角标
    &#39;UBound表示数组的最大的角标
    &#39;lower,upper
    &#39;这种方法的优点在于，如果后期数组增级了个数，那么遍历数组的时候，就不需要修改循环的条件了
    For index &#x3D; LBound(MyArray) To UBound(MyArray)
        MsgBox MyArray(index)
        Next index
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Option-Base"><a href="#Option-Base" class="headerlink" title="Option Base"></a>Option Base</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Base 1
Option Explicit

Sub ArrayTest2()
    &#39;声明定义一维数组
    &#39;若没有指定最小的角标，就默认最小角标为0;我们设置的数字，就是最大的角标
    &#39;Dim MyArray(3) As Integer就相当于Dim MyArray(0,3) As Integer
    &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    &#39;如果加上了Option Base 1，就表示Dim MyArray(3) As Integer是从1开始，相当于Dim MyArray(1,3) As Integer
    &#39;这时那么如果有MyArray(0) &#x3D; 100在，就会报错“下标越界”，必须删去or注释掉这一行

    Dim MyArray(3) As Integer
    
    &#39;MyArray(0) &#x3D; 100
    MyArray(1) &#x3D; 200
    MyArray(2) &#x3D; 300
    MyArray(3) &#x3D; 400
    
    Dim index As Integer
    For index &#x3D; LBound(MyArray) To UBound(MyArray)
        MsgBox MyArray(index)
        Next index
               
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ArrayTest()
    &#39;定义二维数组
    &#39;前面是行数，后面是列数
    Dim MyArray(1 To 2, 1 To 3) As Integer
    
    &#39;为二维数组赋值
    MyArray(1, 1) &#x3D; 100
    MyArray(1, 2) &#x3D; 200
    MyArray(1, 3) &#x3D; 300
    MyArray(2, 1) &#x3D; 400
    MyArray(2, 2) &#x3D; 500
    MyArray(2, 3) &#x3D; 600

    &#39;访问二维数组中某一个空间中的数据
    MsgBox MyArray(1, 3)
    
		&#39;遍历二维数组中的数据，方法：大循环嵌套小循环
    Dim rowno As Integer, cono As Integer
    For rowno &#x3D; 1 To 2
        For cono &#x3D; 1 To 3
            MsgBox MyArray(rowno, cono)
            Next cono
        Next rowno
    
    
    &#39;LBound(MyArray, 1):行的最小角标
    &#39;UBound(MyArray, 1):行的最大角标
    &#39;这里的1和2，与角标从几开始没关系（所以如果角标是从0开始，这里也还是1和2）
    Dim rowno As Integer, cono As Integer
    For rowno &#x3D; LBound(MyArray, 1) To UBound(MyArray, 1)
        &#39;LBound(MyArray, 2):列的最小角标
        &#39;UBound(MyArray, 2):列的最大角标
        For cono &#x3D; LBound(MyArray, 2) To UBound(MyArray, 2)
            MsgBox MyArray(rowno, cono)
            Next cono
        Next rowno
    

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="动态数组"><a href="#动态数组" class="headerlink" title="动态数组"></a>动态数组</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub MyDynArray()
    &#39;定义一个一维动态数组，括号空的
    Dim MyDynArray() As Integer
    
    &#39;redim:明确动态数组的最小角标和最大角标
    ReDim MyDynArray(1 To 3)
    
    &#39;为一维动态数组进行赋值
    MyDynArray(1) &#x3D; 100
    MyDynArray(2) &#x3D; 200
    MyDynArray(3) &#x3D; 300
    
    &#39;for循环，遍历数组
    Dim index As Integer
    
&#39;    For index &#x3D; LBound(MyDynArray) To UBound(MyDynArray)
&#39;        MsgBox MyDynArray(index)
&#39;        Next index
    
    &#39;可以通过redim多次调整角标
    &#39;又一次使用了redim，对这个数组的角标进行了调整，调整成了1-4;
    &#39;注意！！！redim调整动态数组的时候，之前的赋值都会自动抹除，即为0
    &#39;

    ReDim MyDynArray(1 To 4)
    
    &#39;如果需要保留之前的赋值，就在redim后面加一个Preserve
    &#39;加一个Preserve，就可以保留历史的赋值数据
    &#39;如果要运行查看效果，需要将上面未加preserve的代码注释掉
    
    ReDim Preserve MyDynArray(1 To 4)
    
    
    
    
    &#39;如果只对4位置进行赋值400，那么位置1-3的值就会是0
    MyDynArray(4) &#x3D; 400
    
    For index &#x3D; LBound(MyDynArray) To UBound(MyDynArray)
        MsgBox MyDynArray(index)
        Next index
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="【Chapter-3】面向对象和三"><a href="#【Chapter-3】面向对象和三" class="headerlink" title="【Chapter 3】面向对象和三"></a>【Chapter 3】面向对象和三</h1><h2 id="理解面向对象（入门）"><a href="#理解面向对象（入门）" class="headerlink" title="理解面向对象（入门）"></a>理解面向对象（入门）</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ObjectTest()
    &#39;内容
    &#39;设置A1单元格的数值
    &#39;Range(&quot;A1&quot;):表示的就是A1单元格（就是一个对象，这个对象有相关的一些属性，比如Value）
    &#39;Value就是A1单元格的值
    &#39;可以理解成Value就是一个变量，下面就是给这个变量赋值，只不过这个变量归属于A1单元格
    &#39;通过设置Range对象属性的值，从而设置了A1单元格的内容
    Range(&quot;A1&quot;).Value &#x3D; 200
    
    &#39;展示A1单元格的值
    &#39;展示时可以把上面的代码注释掉
    MsgBox Range(&quot;A1&quot;).Value
    
    &#39;方法
    &#39;运行时可以把上面的代码注释掉
    &#39;选中+清除内容
    Range(&quot;A1&quot;).Select
    Range(&quot;A1&quot;).Clear
    
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>对象，包含属性和方法；<br>属性：对于这个对象的描述信息；<br>方法：可以对这个对象做什么</p>
<p>但是实际上我们很少进行区分，可以这么理解：对于属性来说，可以理解为一个变量，但是实际情况可能会复杂一些，比如Font和Interior实际上还是一个对象，也就是说对象可以包含对象；而Font对象又有一些其他的属性和方法来进行操作。</p>
<p>Range对象，单元格区域（不止一个单元格）</p>
<p><strong>属性：</strong></p>
<ol>
<li>Value——单元格区域内的<strong>值</strong></li>
<li>Count——单元格区域内，有<strong>多少个单元格</strong></li>
<li>Font——单元格区域内，对<strong>字体</strong>进行设置</li>
<li>Interior——单元格区域内，对<strong>填充颜色</strong>进行设置</li>
</ol>
<p><strong>方法：</strong></p>
<ol>
<li>Select——通过代码，选中指定的单元格区域</li>
<li>Copy、Paste——把指定区域的内容，复制粘贴到另一块地方</li>
<li>Clear——把指定区域的内容清除掉</li>
<li>Delete——把区域单元格内容删除掉</li>
</ol>
<p><strong>clear和delete的区别：</strong></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.delete"><code>Range.Delete</code></a>实际上删除了相应的范围并相应地移动&#x2F;移动了单元格，从而改变了工作表的结构。如果您选择单元格，然后单击鼠标右键以删除所选内容，则情况相同。系统会询问您希望如何移动单元格。</p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clear"><code>Range.Clear</code></a>将仅清除内容和格式，但不会删除单元格，也不会更改工作表的结构。</p>
<p>还有仅清除内容但保留格式的<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearcontents"><code>Range.ClearContents</code></a>、仅清除单元格格式的<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearformats"><code>Range.ClearFormats</code></a>以及<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearcomments"><code>Range.ClearComments</code></a>、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearhyperlinks"><code>Range.ClearHyperlinks</code></a>、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearnotes"><code>Range.ClearNotes</code></a>和<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearoutline"><code>Range.ClearOutline</code></a></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub ObjectTest()
		&#39;选中
    Range(&quot;A1&quot;).Select

		&#39;仅清除内容和格式，但不会删除单元格，也不会更改工作表的结构。
    Range(&quot;A1&quot;).Clear

		&#39;清除内容和格式，同时删除单元格
    Range(&quot;A1&quot;).Delete
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="对象层级框架"><a href="#对象层级框架" class="headerlink" title="对象层级框架"></a>对象层级框架</h2><p>万物即对象（橙色的对象更常用）</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ObjectHierarchy()
    &#39;对象层次访问
    Application.Workbooks(&quot;练习VBA用.xlsm&quot;).Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Value &#x3D; 1000
    &#39;执行后，对应单元格就会有1000的值


    &#39;上面的写法较为繁琐
    &#39;
    &#39;简略写法
    &#39;可以省略Application：因为我们现在正在Excel的环境中进行编程；如果上面的代码只省略Application，也是可以正常运行的
    &#39;可以省略Workbooks：因为我们当前就是对这个工作簿进行操作的
    &#39;可以省略Worksheets：因为当前活动的工作表就是sheet1

    &#39;省略哪个就认为这个内容是活动的，比如工作簿和工作表
    &#39;
    &#39;如果切换了工作簿&#x2F;工作表，就默认在当期的工作簿&#x2F;工作表中运行

    &#39;如果要指定工作簿&#x2F;工作表，就不能忽略

    Range(&quot;A2&quot;).Value &#x3D; 300


    &#39;Workbooks和Worksheets，都有s，万物皆对象，表示有多张工作簿&#x2F;工作表，是集合对象；
    &#39;类似数组，可以把多个变量统一进行管理
    &#39;集合同理，把多个工作簿&#x2F;工作表统一进行管理，是对象，就有属性和方法

    &#39;属性
    Range(&quot;C2&quot;).Value &#x3D; 999
    &#39;方法
    Range(&quot;A1&quot;).Clear
    
    &#39;集合也是对象，也有属性和方法
    &#39;属性:显示sheet1的名字
    MsgBox Worksheets(&quot;Sheet1&quot;).Name
    &#39;方法：新增一个工作表
    Worksheets.Add
    
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="单元格引用"><a href="#单元格引用" class="headerlink" title="单元格引用"></a>单元格引用</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub CeilRefTest()
    &#39;单元格引用

    &#39;引用某个单元格
    &#39;如果没有加“.Value”，也可以对它进行赋值；
    &#39;说明“.Value”是它默认的属性，不加上实际上也就是加了“.Value”，可以对这个单元格进行赋值
    Range(&quot;A1&quot;).Value &#x3D; 100
    Range(&quot;A2&quot;) &#x3D; 500

    &#39;引用多个单元格
    &#39;同时引用了这3个单元格，并进行了数据的传输：赋值
    Range(&quot;A3,C3,E3&quot;).Value &#x3D; 666


    &#39;引用某个单元格区域（连续）
    Range(&quot;A5:C8&quot;).Value &#x3D; 456

    &#39;引用某些单元格区域（不连续）
    Range(&quot;A10:C11,E12:G14&quot;).Value &#x3D; 400

    &#39;引用单元格区域，带有名称的
    &#39;先选中一个区域，然后在显示位置如“C18”的地方，输入一个名称，如“TEST123”，即可完成对某个单元格区域的名称
    Range(&quot;TEST123&quot;).Value &#x3D; 999

    &#39;---------------分割线------------------
    &#39;---------------分割线------------------

    &#39;行和列的引用

    Range(&quot;26:26&quot;).Value &#x3D; 600 &#39;整个26行赋值600
    Range(&quot;J:J&quot;).Value &#x3D; 800 &#39;整个J列赋值800

    &#39;引用多行(不相连的行)
    Range(&quot;27:27,29:29,33:33&quot;).Value &#x3D; 900

    &#39;引用多列(不相连的列)
    Range(&quot;L:L,G:G,P:P&quot;).Value &#x3D; 35
    
    &#39;引用多行(相连的行)
    Range(&quot;32:35&quot;).Value &#x3D; 77
    
    &#39;引用多列(相连的列)
    Range(&quot;F:H&quot;).Value &#x3D; 35
    
    &#39;引用多行(相连的行)
    Rows(&quot;41:43&quot;) &#x3D; 123
    
    &#39;引用多列(相连的列)
    Columns(&quot;A:C&quot;).Value &#x3D; 555
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Cells和Offset属性"><a href="#Cells和Offset属性" class="headerlink" title="Cells和Offset属性"></a>Cells和Offset属性</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub CellRefTest()
    &#39;Cells属性
    &#39;可以通过数字来决定我们访问的是哪个单元格，可以结合变量相关知识，灵活引用单元格
    
    &#39;引用工作表中的某个单元格
    &#39;Cells(5, 2):表示第五行，第二列，列用数字表示而不是字母
    Worksheets(&quot;Sheet2&quot;).Cells(5, 2) &#x3D; 100
    
    &#39;引用单元格区域
    &#39;Range(,)，里面加上左上角的单元格位置，和右下角的单元格位置
    Range(Cells(8, 2), Cells(13, 5)) &#x3D; 200
    
    &#39;右上角和左下角的也可以
    Range(Cells(18, 5), Cells(25, 2)) &#x3D; 300

    &#39;引用单元格区域中的某个单元格
    &#39;Cells(3, 2)表示的是&quot;B8,E13&quot;这个区域中的第3行第2列，给它赋值400
    Range(&quot;B8,E13&quot;).Cells(3, 2) &#x3D; 400

    &#39;Offset属性
    &#39;宏录制，相对引用的时候遇到过
    &#39;offset可以控制选择的单元格的“偏移量”,移动了多少位置
    &#39;往右和往下是正数，往左往上是负数
    
    Range(&quot;B15&quot;).Offset(3, 2).Value &#x3D; 500
    Range(&quot;H15&quot;).Offset(-3, -2).Value &#x3D; 500

    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Select和Activate方法"><a href="#Select和Activate方法" class="headerlink" title="Select和Activate方法"></a>Select和Activate方法</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub CellRefTest()
    &#39;Range
    &#39;Range(&quot;G9&quot;).Select   &#39;选中了G9这个单元格
    &#39;Range(&quot;G10:I15&quot;).Select  &#39;选中了G10到I15这个区域的单元格
    
    &#39;Activate
    &#39;按Tab键可以在输入.之后，输入几个字母，不用全部输完，快速选中你想要的那个；enter会换行，Tab不会
    &#39;Range(&quot;G9&quot;).Activate
    
    &#39;Range(&quot;G10:I15&quot;).Activate
    &#39;好像是只选中了G9这个单元格，和G10到I15这个区域；好像和select一样
    
    
    
    &#39;Select和Activate的区别：
    &#39;活动单元格，就是选中了很多个单元格之后，这些单元格会变成灰色；活动单元格就是其中白色的那个
    &#39;某个区域的活动单元格，可以用Tab, enter, shift + tab, shift + enter进行上下左右的移动
    &#39;下面的代码运行后，就是先选中了G9:J14的这个区域，然后将H10作为了活动单元格
    
    Range(&quot;G9:J14&quot;).Select
    Range(&quot;H10&quot;).Activate
    
    &#39;引用选择的单元格&#x2F;单元格区域
    Selection.Value &#x3D; 100
    
    &#39;引用选择的单元格
    ActiveCell.Value &#x3D; 200
    
    &#39;就是把上面选中的单元格区域，赋值为100；除了活动单元格H10，这个赋值为200
    
    
    
    &#39;可以通过在上方工具栏右击出现想“调试”，点击“逐语句”，再点击“逐过程”（或者快捷键shift + F8），查看代码按每一句执行的过程，观察每一行代码到底产生了什么影响
    &#39;这里的代码就是：先选中G9:J14这个区域，再选中了H10这个活动单元格；
    &#39;然后把G9:J14这个区域里面每个单元格（包括H10）赋值100，再对H10这个活动单元格赋值200
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象的End属性"><a href="#Range对象的End属性" class="headerlink" title="Range对象的End属性"></a>Range对象的End属性</h2><p>假设有一块区域的数据，我们点击其中的某一个有数据的单元格，然后快捷键：<code>Ctrl + ↓</code> ，到达了这块有数值区域最下方的单元格；同理，<code>Ctrl + ↑</code>，<code>Ctrl + ←</code>，<code>Ctrl + →</code>，可以到达这块单元格区域的边缘 or 最上&#x2F;左&#x2F;右的单元格。</p>
<p>如果想要<strong>选中</strong>当前单元格到最下面的单元格，<code>Ctrl + Shift + ↓</code>，可以选中；可以先<code>Ctrl + Shift + ↓</code>，紧接着就<code>Ctrl + Shift + →</code>，可以连续选中多行多列的内容，可以灵活选择目前这块区域中的某一块区域。</p>
<p>这种操作在代码中如何实现？</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub CellRefTest()
&#39;End属性模拟&quot;Ctrl＋方向键&quot;的效果
&#39;选中H10最往下再最往右的单元格
Range(&quot;H10&quot;).End(xlDown).End(xlToRight).Select

&#39;End属性模拟&quot;Ctrl＋Shift + 方向键&quot;的效果
&#39;Range(A,B),表示从A到B中间所有的单元格
&#39;选中H10开始，到H10最往下再最往右的单元格，这一块区域的单元格
Range(&quot;H10&quot;, Range(&quot;H10&quot;).End(xlDown).End(xlToRight)).Select
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-剪切复制粘贴"><a href="#Range对象-剪切复制粘贴" class="headerlink" title="Range对象_剪切复制粘贴"></a>Range对象_剪切复制粘贴</h2><p>Range对象的常用操作很重要，因为我们在Excel里面基本上都是在对单元格进行一些操作，要讲这些操作如何通过VBA实现。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub RangeTest()
    Range(&quot;A1:A10&quot;).Value &#x3D; 100
    
    &#39;剪切+粘贴
    &#39;.Cut之后写一个空格，会有一个destination，意思表示我们剪切后粘贴到哪里
    Range(&quot;A1:A5&quot;).Cut Range(&quot;C2&quot;)
    &#39;将A1到A5单元格里面的数字剪切后，粘贴到C2去了；因为有5个单元格，所以C2-C6都有了100的值
    
    &#39;复制+粘贴
    &#39;将A6到A10单元格里面的数字复制后，粘贴到E3去了；因为有5个单元格，所以E3-E7都有了100的值
    Range(&quot;A6:A10&quot;).Copy Range(&quot;E3&quot;)
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置单元格公式"><a href="#Range对象-设置单元格公式" class="headerlink" title="Range对象_设置单元格公式"></a>Range对象_设置单元格公式</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub RangeTest()
    &#39;在G列，计算出计算1-10行的A列-E列对应单元格的求和
    &#39;G1是A1到E1的求和
    &#39;G2是A2到E2的求和
    &#39;G3是A3到E3的求和
    &#39;G4是A4到E4的求和
    &#39;………………
    Range(&quot;G1:G10&quot;).Formula &#x3D; &quot;&#x3D;SUM(A1:E1)&quot;
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-选择性粘贴"><a href="#Range对象-选择性粘贴" class="headerlink" title="Range对象_选择性粘贴"></a>Range对象_选择性粘贴</h2><p>选择性粘贴：粘贴的时候先右键，可以选择“粘贴为值”，“粘贴为公式”……</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub RangeTest()
    Range(&quot;G1:G10&quot;).Copy
    Range(&quot;J1&quot;).PasteSpecial xlPasteValues &#39;粘贴为值
    &#39;运行后在J列的单元格内就有粘贴的值，但是G列还是一个被选中的状态
    &#39;想要去除掉选中的状态，可以进行下面的操作
    
    Application.CutCopyMode &#x3D; False
    &#39;CutCopyMode，就是剪切或者复制的模式，设置成FALSE，也就是取消这种效果
    &#39;因为这种选中的状态（虚线&#x2F;蚂蚁线），只有在剪切或者复制的时候才会出现
    
    Range(&quot;J10&quot;).Select
    &#39;选中J10的单元格，这样就不是选中上方的单元格了

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置字体效果"><a href="#Range对象-设置字体效果" class="headerlink" title="Range对象_设置字体效果"></a>Range对象_设置字体效果</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ZiTiTest()
    &#39;把A1到A10写上字“文本”
    Range(&quot;A1:A10&quot;).Value &#x3D; &quot;文本&quot;
    
    &#39;font，字体，也是对象
    &#39;运行下面的代码时，推荐用“逐语句&#x2F;逐行”观察效果
    
    &#39;设置字体
    Range(&quot;A1:A10&quot;).Font.Name &#x3D; &quot;黑体&quot;
    
    &#39;设置大小
    Range(&quot;A1:A10&quot;).Font.Size &#x3D; 15
    
    &#39;加粗
    Range(&quot;A1:A10&quot;).Font.Bold &#x3D; True
    
    &#39;倾斜
    Range(&quot;A1:A10&quot;).Font.Italic &#x3D; True
    
    &#39;颜色
    &#39;方法一：(输入vb两个字母后，可以用快捷键【Ctrl + J】辅助
    Range(&quot;A1:A10&quot;).Font.Color &#x3D; vbRed
    
    &#39;方法二：用RGB值，3个值，每个值都可以设置0-255之间
    Range(&quot;A1:A10&quot;).Font.Color &#x3D; RGB(156, 191, 72)
    
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="通过文档查看对象属性和方法"><a href="#通过文档查看对象属性和方法" class="headerlink" title="通过文档查看对象属性和方法"></a>通过文档查看对象属性和方法</h2><p>不用死记硬背。工具栏这里有个“对象浏览器”，也可以在“视图”下方找到，快捷键是F2；</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/office/vba/api/excel.range(object)">Range 对象 (Excel)</a></p>
<p>【所有库】这里选择“Excel”；</p>
<p>【类】就是“对象”的意思，在“类”下面，找到Range：右侧是灰色手指图标的，表示这是“属性”；绿色图标，表示这是“方法”。（可以在这里找到所有的对象和方法，但是不需要全部完全掌握；如果英文看不懂，可以用“帮助”，按下F1，如果可以的话，会出现一个微软的网站，会有写教程；如果打不开，有一个微软的帮助文档，找到Obejct model，单击再点键盘上的“R”，找到Range Object，单击打开并单击Range Members，就能找到找到每一个属性和方法的介绍，都是英文的，每一个点进去都有示例代码方便理解）</p>
<aside>
💡 如果不知道该用什么属性和方法，可以用“宏录制”来辅助，或者去参考文档*Excel 2013 Developer Documentation.chm*，或者去[微软官网](https://learn.microsoft.com/zh-cn/office/vba/api/overview/excel/object-model)，看下应该使用什么属性和方法。
</aside>



<h2 id="With语法使用方法"><a href="#With语法使用方法" class="headerlink" title="With语法使用方法"></a>With语法使用方法</h2><p>之前学过，设置字体属性的时候，可以用<code>Range(&quot;A1:A10&quot;).Font.****</code>来设置相应属性，但是若有多个属性需要同时设置，多行写<code>Range(&quot;A1:A10&quot;).Font.</code>很浪费时间，可以通过<strong>With语句</strong>，把这个操作变得更加简单。</p>
<p>优点：不用每一次都在前面写上相应的对象，而是把对象固定好之后，紧接着再编写相应的属性。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ZiTiTest()
    Range(&quot;A1:A10&quot;).Value &#x3D; &quot;文本&quot;
&#39;不用With语句
&#39;    Range(&quot;A1:A10&quot;).Font.Name &#x3D; &quot;黑体&quot;
&#39;    Range(&quot;A1:A10&quot;).Font.Size &#x3D; 15
&#39;    Range(&quot;A1:A10&quot;).Font.Bold &#x3D; True
&#39;    Range(&quot;A1:A10&quot;).Font.Italic &#x3D; True
&#39;
&#39;    Range(&quot;A1:A10&quot;).Font.Color &#x3D; vbRed
&#39;    Range(&quot;A1:A10&quot;).Font.Color &#x3D; RGB(156, 191, 72)
    
&#39;用With语句
&#39;逐语句执行比较直观
    With Range(&quot;A1:A10&quot;).Font
        .Name &#x3D; &quot;微软雅黑&quot;
        .Size &#x3D; 15
        .Bold &#x3D; True
        .Italic &#x3D; True
        .Color &#x3D; RGB(156, 191, 72)
        
    
    End With
    &#39;别忘了End With
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置边框线"><a href="#Range对象-设置边框线" class="headerlink" title="Range对象_设置边框线"></a>Range对象_设置边框线</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub rangetest()

    Range(&quot;A1:A10&quot;).Value &#x3D; &quot;文本&quot;
    
    &#39;对象：Borders——边框线
    With Range(&quot;A1:A10&quot;).Borders
        &#39;按下xl之后，要按快捷键Ctrl + J
        .LineStyle &#x3D; xlDouble   &#39;边框线样式：双线条边框线
        .Color &#x3D; vbRed          &#39;边框线颜色：红色
        .Weight &#x3D; xlThick       &#39;边框线粗细：粗
        
    End With
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置填充颜色"><a href="#Range对象-设置填充颜色" class="headerlink" title="Range对象_设置填充颜色"></a>Range对象_设置填充颜色</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub rangetest()
    &#39;对象&#x2F;属性：Interior
      
    &#39;使用VB内部的颜色
    Range(&quot;A1:A10&quot;).Value &#x3D; &quot;文本&quot;
    Range(&quot;A1:A10&quot;).Interior.Color &#x3D; vbGreen
    
    &#39;使用RGB自定义颜色
    Range(&quot;A11:A20&quot;).Value &#x3D; &quot;填充颜色&quot;
    Range(&quot;A11:A20&quot;).Interior.Color &#x3D; RGB(0, 177, 236)
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置对齐方式"><a href="#Range对象-设置对齐方式" class="headerlink" title="Range对象_设置对齐方式"></a>Range对象_设置对齐方式</h2><p>可以设置两种对齐方式：水平方向上的 AND 竖直方向上的</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub rangetest()
    Range(&quot;A1:A10&quot;).Value &#x3D; &quot;文本&quot;
    &#39;逐行运行的时候，可以拉高行号辅助观察效果
    &#39;输入xl后，可以快捷键【Ctrl + J】辅助输入
    
    With Range(&quot;A1:A10&quot;)
        .Font.Size &#x3D; 13
        
        &#39;在水平方向上的对齐方式：靠右
        .HorizontalAlignment &#x3D; xlRight
        
        &#39;在竖直方向上的对齐方式：靠底部
        .VerticalAlignment &#x3D; xlBottom
        
    End With
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置缩进大小"><a href="#Range对象-设置缩进大小" class="headerlink" title="Range对象_设置缩进大小"></a>Range对象_设置缩进大小</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub RangeTest08()
    Range(&quot;A1:A10&quot;).Value &#x3D; &quot;文本&quot;
    
    &#39;左对齐，缩进值为2
    With Range(&quot;A1:A10&quot;)
        .HorizontalAlignment &#x3D; xlLeft
        .InsertIndent 2
    End With

End Sub
&#39;如何检查缩进值？看“单元格格式”里面的“对齐”，就是靠左缩进，缩进值为2。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置自动换行"><a href="#Range对象-设置自动换行" class="headerlink" title="Range对象_设置自动换行"></a>Range对象_设置自动换行</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub RangeTest56()
    &#39;在E1单元格，输入一些较长的文本
    Range(&quot;E1&quot;).Value &#x3D; &quot;学习VBA设置565656自动换行&quot;
    
    &#39;在E1单元格，实现换行的效果
    Range(&quot;E1&quot;).WrapText &#x3D; True
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-合并单元格"><a href="#Range对象-合并单元格" class="headerlink" title="Range对象_合并单元格"></a>Range对象_合并单元格</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub RangeTest45()
    &#39;合并单元格A1-A10，到A1中，那么A2-A10的内容就消失了
    &#39;Merge是合并的意思，合并的时候会弹窗说“合并单元格时，仅保留左上角的值，而放弃其他值。”
    &#39;Range(&quot;A1:A10&quot;).Merge
    
    &#39;UnMerge表示：取消合并单元格，执行时可注释掉上面一行的代码
    &#39;Range(&quot;A1:A10&quot;).UnMerge
    
    
    
    &#39;如果想要合并，并且保留其他单元格的内容
    &#39;就用一个for循环，把A1-A10的内容全部连接到一个字符串上
    &#39;再把这个字符串输出到A1里面
    &#39;再合并单元格，舍弃其他单元格的值
    Dim Num As Integer
    Dim txt As String
    
    &#39;为了方便观察，可以在“视图”里面，打开监视窗口，并且把变量txt【添加监视】
    
    
    For Num &#x3D; 1 To 10
    
        &#39;txt &#x3D; txt &amp; Cells(Num, 1) &amp; &quot;-&quot;
        &#39;这样出来，字符串最后会有一个短横线，比如【文本-文本-文本-文本-文本-文本-文本-文本-文本-文本-】
        
        &#39;如果不想要这个短横线
        &#39;就可以在循环的时候，加一个判断的语句
        &#39;如果是第10个单元格，末尾不加短横线
        &#39;如果不是第10个单元格，通过短横线，进行连接分隔
        If Num &#x3D; 10 Then
            txt &#x3D; txt &amp; Cells(Num, 1)
        Else
            txt &#x3D; txt &amp; Cells(Num, 1) &amp; &quot;-&quot;
        End If
        
    Next Num
    
    
    
    
    Range(&quot;A1&quot;) &#x3D; txt
    
    Range(&quot;A1:A10&quot;).Merge
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-阻止Excel提醒弹窗出现"><a href="#Range对象-阻止Excel提醒弹窗出现" class="headerlink" title="Range对象_阻止Excel提醒弹窗出现"></a>Range对象_阻止Excel提醒弹窗出现</h2><p>比如执行上面一节的代码的时候，会出现一个弹窗【合并单元格时，仅保留左上角的值，而放弃其他值。】此时单击“确定”，就会只保留左上角的值。</p>
<p>如果不想要弹窗出现，可以用<em>Application</em>这个对象</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Application.DisplayAlerts &#x3D; False
&#39;把这一句写在代码前半部分
&#39;就是不要弹窗出现的意思
&#39;即“阻止Excel通过弹窗进行提醒”

Application.DisplayAlerts &#x3D; True
&#39;再把这句写在End Sub之前，就代表
&#39;在这个Sub以内，就是只是在这个程序中阻止弹窗出现<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置数字格式"><a href="#Range对象-设置数字格式" class="headerlink" title="Range对象_设置数字格式"></a>Range对象_设置数字格式</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub RangeTest12()
    Range(&quot;G1:G10&quot;).Value &#x3D; 100000
    Range(&quot;G1:G10&quot;).NumberFormat &#x3D; &quot;￥#,##0.00&quot;
    &#39;如果不知道数字格式怎么用代码写，就去查吧
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-插入删除行和列-删除-清除单元格"><a href="#Range对象-插入删除行和列-删除-清除单元格" class="headerlink" title="Range对象_插入删除行和列+删除&#x2F;清除单元格"></a>Range对象_插入删除行和列+删除&#x2F;清除单元格</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub RangeTest13()
    Range(&quot;A1:N30&quot;).Value &#x3D; 100

    &#39;插入单行
    &#39;方法一：在第3行的上方，插入一行
    &#39;Range(&quot;3:3&quot;).Insert
    &#39;方法二：在A5单元格上方，插入1行
    &#39;就是在A5单元格对应的这一行的上方，插入一行
    &#39;Range(&quot;A5&quot;).EntireRow.Insert

    &#39;插入单列
    &#39;方法一：在C列的左侧，插入了一列
    &#39;Range(&quot;C:C&quot;).Insert
    &#39;方法二：在E1单元格左侧，插入1列
    &#39;就是在E1单元格对应的这一列的左侧，插入1列
    &#39;Range(&quot;E1&quot;).EntireColumn.Insert
    
    &#39;删除单行
    &#39;删除第3行
    &#39;Range(&quot;3:3&quot;).Delete
    &#39;删除A5这一行
    &#39;Range(&quot;A5&quot;).EntireRow.Delete
    
    &#39;删除单列
    &#39;Range(&quot;C:C&quot;).Delete
    &#39;Range(&quot;E1&quot;).EntireColumn.Delete
    
    &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;分割线&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    &#39;插入多行
    &#39;Range(&quot;A3:A5&quot;).EntireRow.Insert
    &#39;效果就是3.4.5行新增了3行空白行
    &#39;Rows(&quot;9:11&quot;).Insert
    &#39;效果就是9.10.11行新增了3行空白行
    
    &#39;插入多列
    &#39;Range(&quot;C1:E1&quot;).EntireColumn.Insert
    &#39;Columns(&quot;G:I&quot;).Insert
    
    &#39;删除多行(下面的行会自动补上)
    &#39;Range(&quot;A3:A5&quot;).Delete &#39;这样只会删除这3个单元格
    &#39;Range(&quot;A3:A5&quot;).EntireRow.Delete
    &#39;Rows(&quot;6:8&quot;).Delete
    
    
    &#39;删除多列(右边的列会自动补上)
    &#39;Range(&quot;C1:E1&quot;).EntireColumn.Delete
    &#39;Columns(&quot;D:F&quot;).Delete
    
     
     &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;分割线&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
     &#39;删除单元格(删除后右侧内容会自动补上)
     &#39;Range(&quot;B3:D10&quot;).Delete
    
     &#39;删除单元格(删除后，不希望其他内容移动，也就是清除内容，可以用clear)
     Range(&quot;F5:I10&quot;).Clear
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-设置行高与列宽"><a href="#Range对象-设置行高与列宽" class="headerlink" title="Range对象_设置行高与列宽"></a>Range对象_设置行高与列宽</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub RangeTest14()
    &#39;设置单行行高
    Range(&quot;A1&quot;).RowHeight &#x3D; 30
    
    &#39;设置多行行高
    Range(&quot;A3:A5&quot;).EntireRow.RowHeight &#x3D; 40
    Rows(&quot;7:12&quot;).RowHeight &#x3D; 50
    
    
    &#39;设置单列列宽
    Range(&quot;C1&quot;).ColumnWidth &#x3D; 20
    
    &#39;设置多列列宽
    Range(&quot;D1:F1&quot;).EntireColumn.ColumnWidth &#x3D; 30
    Columns(&quot;H:J&quot;).ColumnWidth &#x3D; 20
    

    &#39;设置列宽行高自适应
    Rows(&quot;1:10&quot;).AutoFit
    Columns(&quot;A:J&quot;).AutoFit
  
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-隐藏和取消隐藏-行和列"><a href="#Range对象-隐藏和取消隐藏-行和列" class="headerlink" title="Range对象_隐藏和取消隐藏 行和列"></a>Range对象_隐藏和取消隐藏 行和列</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub RangeTest15()
    &#39;隐藏多行
    Range(&quot;A3:A5&quot;).EntireRow.Hidden &#x3D; True  
    &#39;隐藏多列
    Range(&quot;G1:I1&quot;).EntireColumn.Hidden &#x3D; True
    
    &#39;显示行和列，即取消隐藏行和列  
    Range(&quot;A3:A5&quot;).EntireRow.Hidden &#x3D; False
    Range(&quot;G1:I1&quot;).EntireColumn.Hidden &#x3D; False
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Range对象-清除单元格格式及内容"><a href="#Range对象-清除单元格格式及内容" class="headerlink" title="Range对象_清除单元格格式及内容"></a>Range对象_清除单元格格式及内容</h2><p>分别表示清除批注、内容、格式、超链接</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub RangeTest16()
    &#39;清除格式
    Range(&quot;A1:N30&quot;).Value &#x3D; 100
    
    &#39;对A1:N30的单元格设置格式

    With Range(&quot;A1:N30&quot;).Font
        .Color &#x3D; vbRed
        .Name &#x3D; &quot;微软雅黑&quot;
        .Bold &#x3D; True
        .Underline &#x3D; True
    End With

    &#39;清除A1:N3的格式
    Range(&quot;A1:N3&quot;).ClearFormats
    
    &#39;清除A1:K15的内容
    Range(&quot;A1:K15&quot;).ClearContents
    
    
    &#39;或者一步到位，直接一个clear清除内容和格式
    Range(&quot;A1:K15&quot;).Clear

    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Sheets对象-Sheets对象的基本使用"><a href="#Sheets对象-Sheets对象的基本使用" class="headerlink" title="Sheets对象_Sheets对象的基本使用"></a>Sheets对象_Sheets对象的基本使用</h2><p>针对工作表的操作</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub SheetsTest()
    &#39;写名称：Sheet2是工作表的名称
    &#39;【更推荐写名称这个，具有唯一性，不会因为sheet表的移动而发生改变】
    &#39;Worksheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;) &#x3D; 100

    &#39;按顺序：第3张工作表
    &#39;Worksheets(3).Range(&quot;B2&quot;).Value &#x3D; 1000
    
    
    Sheets(&quot;Sheet2&quot;).Range(&quot;B2&quot;).Value &#x3D; 5000
    Sheets(2).Range(&quot;C2&quot;).Value &#x3D; 7999
    
    &#39;好像sheets和Worksheets一样，但是他们是不一样的
    &#39;Worksheets：表示的就是普通的工作表
    &#39;Sheets：既可以表示包含数据的工作表，也可以表示这个插入图表的工作表
        &#39;就是在Sheet表那里，点击插入，可以插入的是Chart图表
        &#39;实际操作中，用Sheets比较方便
        
        
    &#39;选择工作表，
    &#39;效果类似从别的工作表跳到这个工作表里面
    Sheets(&quot;Sheet4&quot;).Select
    &#39;在A10输入值
    Range(&quot;A10&quot;).Value &#x3D; 9999
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Sheets对象-添加工作表"><a href="#Sheets对象-添加工作表" class="headerlink" title="Sheets对象_添加工作表"></a>Sheets对象_添加工作表</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub SheetsTest2()

    &#39;Sheets.Add
    &#39;若当前活动的工作表是“Sheet2”，执行这个代码后，会在当前工作表的左侧，也就是前面，插入一个新的工作表
    
    
    
    &#39;若是想要明确指定插入的工作表是某张工作表的前&#x2F;后面
    
    &#39;比如想要在工作表Sheet4后面插入一个工作表
    &#39;Sheets.Add after:&#x3D;Sheets(&quot;Sheet4&quot;)

    &#39;在sheet1前面插入一个工作表
    &#39;Sheets.Add before:&#x3D;Sheets(&quot;Sheet1&quot;)

    &#39;弹窗显示第一个sheet表的名称
    &#39;MsgBox Sheets(1).Name

    &#39;把第2个工作表的名称改成“添加工作表2”
    &#39;Sheets(2).Name &#x3D; &quot;添加工作表2&quot;

    &#39;在添加工作表时，设置好添加的工作表的名称
    &#39;即在指定位置，添加一个指定名称的Sheet表
    &#39;在sheet6前面，插入一个名称为“指定名称的工作表”的工作表
    Sheets(&quot;sheet6&quot;).Select         &#39;这一步会跳到Sheet6里
    Sheets.Add.Name &#x3D; &quot;指定名称的工作表&quot;        &#39;这一步会在Sheet6前面插入一个有名称的工作表
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Sheets对象-移动工作表"><a href="#Sheets对象-移动工作表" class="headerlink" title="Sheets对象_移动工作表"></a>Sheets对象_移动工作表</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub SheetsTest3()
    &#39;把“添加工作表”这个sheet移动，放在“指定名称的工作表”之前
    Sheets(&quot;添加工作表&quot;).Move before:&#x3D;Sheets(&quot;指定名称的工作表&quot;)
    
    &#39;把“添加工作表”这个sheet移动，放在“Sheet4”之前
    Sheets(&quot;添加工作表&quot;).Move after:&#x3D;Sheets(&quot;Sheet4&quot;)
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Sheets对象-复制工作表"><a href="#Sheets对象-复制工作表" class="headerlink" title="Sheets对象_复制工作表"></a>Sheets对象_复制工作表</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub SheetsTest4()
    &#39;既然要复制，那还需要指定复制后的位置
    &#39;把&quot;添加工作表&quot;，复制后，放在Sheet2前面
    Sheets(&quot;添加工作表&quot;).Copy before:&#x3D;Sheets(&quot;Sheet2&quot;)
    
    &#39;把&quot;添加工作表&quot;，复制后，放在Sheet6后面
    Sheets(&quot;添加工作表&quot;).Copy after:&#x3D;Sheets(&quot;Sheet6&quot;)
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Sheets对象-隐藏和删除工作表"><a href="#Sheets对象-隐藏和删除工作表" class="headerlink" title="Sheets对象_隐藏和删除工作表"></a>Sheets对象_隐藏和删除工作表</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub SheetsTest5()
    &#39;隐藏Sheet1
    &#39;就是能看见吗？不能的意思
    &#39;Sheets(&quot;Sheet1&quot;).Visible &#x3D; False

    &#39;取消隐藏Sheet1
    &#39;Sheets(&quot;Sheet1&quot;).Visible &#x3D; True

    &#39;删除工作表
    &#39;不可恢复，不可撤销，谨慎操作
    &#39;Sheets(&quot;Sheet6&quot;).Delete
    &#39;只写这一行，会有弹窗
    
    &#39;如果不想要弹窗，就这么写
    &#39;不可恢复，不可撤销，谨慎操作
    Application.DisplayAlerts &#x3D; False
    Sheets(&quot;Sheet1&quot;).Delete
    Application.DisplayAlerts &#x3D; True

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Workbooks对象-新建工作簿"><a href="#Workbooks对象-新建工作簿" class="headerlink" title="Workbooks对象_新建工作簿"></a>Workbooks对象_新建工作簿</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub WorkbooksTest()
    &#39;Workbooks.Add
    &#39;运行后，只会新建一个工作簿，但是没有保存
    
    &#39;新建文档，并且设置好另存为的路径及名称
    &#39;设置保存的地方
    &#39;filename后面要加一个完整的路径，并且加上文件的名字+格式
    Workbooks.Add.SaveAs Filename:&#x3D;&quot;C:\Users\陈勇平\Desktop\vvjjcjy\测试文档.xlsx&quot;

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Workbooks对象-打开和关闭工作簿"><a href="#Workbooks对象-打开和关闭工作簿" class="headerlink" title="Workbooks对象_打开和关闭工作簿"></a>Workbooks对象_打开和关闭工作簿</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub WorkbooksTest2()
    &#39;打开工作簿
    &#39;记得写后缀名
    &#39;Workbooks.Open Filename:&#x3D;&quot;C:\Users\陈勇平\Desktop\vvjjcjy\测试文档.xlsx&quot;
    
    &#39;关闭工作簿
    &#39;因为Excel不会同时打开重名的工作簿，所以一个名字只会有1个打开着的工作簿
    
    Workbooks(&quot;测试文档.xlsx&quot;).Close

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Workbooks对象-保存工作簿"><a href="#Workbooks对象-保存工作簿" class="headerlink" title="Workbooks对象_保存工作簿"></a>Workbooks对象_保存工作簿</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub WorkbooksTest3()
    &#39;先对表格做修改
    Range(&quot;A1:A10&quot;).Value &#x3D; 100
    
    Workbooks(&quot;20221029jy.xlsm&quot;).Save
    &#39;此时已经成功进行了保存
  
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Workbooks对象-删除工作簿"><a href="#Workbooks对象-删除工作簿" class="headerlink" title="Workbooks对象_删除工作簿"></a>Workbooks对象_删除工作簿</h2><p>用kill</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub WorkbooksTest4()
    Kill pathname:&#x3D;&quot;C:\Users\陈勇平\Desktop\vvjjcjy\测试文档.xlsx&quot;
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Workbooks对象-显示文档的名称及路径"><a href="#Workbooks对象-显示文档的名称及路径" class="headerlink" title="Workbooks对象_显示文档的名称及路径"></a>Workbooks对象_显示文档的名称及路径</h2><p>path: 路径</p>
<p>name: 文件名</p>
<p>full name: 路径＋名称</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub WorkbooksTest5()
    &#39;弹窗显示，显示当前文档的路径
    MsgBox ThisWorkbook.Path
    &#39;在某个单元格中显示，显示当前文档的路径
		&#39;效果类似：C:\Users\******\Desktop
    Range(&quot;A20&quot;).Value &#x3D; ThisWorkbook.Path
    
    
    &#39;ThisWorkbook与ActiveWorkbook的区别
    &#39;ThisWorkbook：表示这个模块所在的这个文档
    &#39;ActiveWorkbook：表示当前的活动工作簿
    &#39;【这两个有可能不一样】
		MsgBox ThisWorkbook.Name
    MsgBox ActiveWorkbook.Name
    Range(&quot;A21&quot;).Value &#x3D; ThisWorkbook.Name
    
    
    &#39;一步到位，显示路径+名称
    &#39;效果类似：C:\Users\******\Desktop\20221029Jemma.xlsm
    MsgBox ThisWorkbook.FullName
    MsgBox ActiveWorkbook.FullName
    Range(&quot;A22&quot;).Value &#x3D; ThisWorkbook.FullName

		&#39;打开相同路径下的其他文件，需要输入名称及后缀名
    Workbooks.Open Filename:&#x3D;ThisWorkbook.Path &amp; &quot;\&quot; &amp; &quot;******.xlsm&quot;
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="使用ForEach遍历工作簿"><a href="#使用ForEach遍历工作簿" class="headerlink" title="使用ForEach遍历工作簿"></a>使用ForEach遍历工作簿</h2><p>遍历3个Excel文档，展示它们的名称</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub ForEachTest()
    &#39;for循环时，遍历的都是一些基本的数据类型，比如整数、小数、文本、日期等等
    &#39;遍历对象，需要用for each
    &#39;操作方法类似
    
    Dim book As Workbook
    &#39;workbook 既是对象，也可以是一种数据类型——工作簿类型
    
    For Each book In Workbooks
    &#39;for each表示遍历，workbooks表示现在打开的所有工作簿
    &#39;也就是去遍历每一个打开的工作簿，每一个工作簿的名称都会赋值给变量book
        MsgBox book.Name
    Next book

    &#39;使用ForEach遍历Workbooks（打开的所有的工作簿）
		&#39;打开的工作簿赋值给变量book
		&#39;book的数据类型就是Workbook，所以可以接受Workbooks遍历后的赋值

End Sub
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="使用ForEach遍历工作表"><a href="#使用ForEach遍历工作表" class="headerlink" title="使用ForEach遍历工作表"></a>使用ForEach遍历工作表</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub ForEachTest2()
    Dim sheet As Worksheet
    &#39;定义一个变量，为Worksheet类型
    
    
    For Each sheet In Worksheets
    &#39;Worksheets表示：当前工作簿中的这些工作表
    &#39;遍历工作表，并且把每个工作表赋值给变量sheet
        
        MsgBox sheet.Name
        
    Next sheet
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="使用ForEach遍历单元格"><a href="#使用ForEach遍历单元格" class="headerlink" title="使用ForEach遍历单元格"></a>使用ForEach遍历单元格</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub ForEachTest3()
    Dim cell As Range
&#39;    &#39;方法一：for each
&#39;    For Each cell In Range(&quot;A5:A10&quot;)
&#39;        MsgBox cell.Value
&#39;        &#39;如果不想弹窗太多，可以把数据范围弄小一点
&#39;    Next cell
&#39;
    
    &#39;方法二：for循环
    Dim index As Integer, RowIndex As Integer, ColumnIndex As Integer
    Dim Rng As Range
    Set Rng &#x3D; Range(&quot;A5:A10&quot;)
    &#39;Set的应用：这里的Rng是个对象类型
    
    For RowIndex &#x3D; 1 To Rng.Rows.Count
        &#39;Rng.Rows.Count:表示的是Range(&quot;A5:A10&quot;)，这里面有多少行，即行的数量
        For ColumnIndex &#x3D; 1 To Rng.Columns.Count
            &#39;可以弹窗显示
            &#39;MsgBox Rng.Cells(RowIndex, ColumnIndex)
            
            &#39;弹窗显示如果很多，就可以把这部分数据安排到别的单元格区域去
            Range(&quot;C14&quot;).Offset(RowIndex, ColumnIndex) &#x3D; Rng.Cells(RowIndex, ColumnIndex)

        Next ColumnIndex
        
    Next RowIndex
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="【Chapter-4】VBA日期与文本函数"><a href="#【Chapter-4】VBA日期与文本函数" class="headerlink" title="【Chapter 4】VBA日期与文本函数"></a>【Chapter 4】VBA日期与文本函数</h1><h2 id="日期类型数据基础知识"><a href="#日期类型数据基础知识" class="headerlink" title="日期类型数据基础知识"></a>日期类型数据基础知识</h2><p>不是Excel函数，而是VBA函数。</p>
<p>“立即窗口”中的内容会叠加，不会自动消失。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub DateTimeFunctionTest()
    &#39;VBA中提供了很多的函数，msgbox就是VBA的函数
    &#39;前缀VBA.可以省略
    &#39;msgbox本质上也是个vba函数，只是我们之前用的时候没加上前缀
    &#39;VBA.MsgBox &quot;VBA函数&quot;
    
    
    &#39;常用的有2类函数：1.对于日期和时间处理的函数；2. 对于文本和字符串的函数
    
    Dim dt As Date
    
    
    
    &#39;dt &#x3D; #11&#x2F;5&#x2F;2022#
    &#39;MsgBox dt
    &#39;如果显示出来只有年月，是和本机电脑显示日期的格式有关
    
    &#39;Debug.Print dt
    &#39;如果不想要msgbox弹窗，可以用Debug.Print配合【视图-立即窗口】
    &#39;如果&quot;立即窗口&quot;有多余信息，可以选中后delete掉
    
    
    &#39;获得当天日期？
    dt &#x3D; VBA.Date
    Debug.Print dt
    
    &#39;如获得当前时间？
    dt &#x3D; VBA.Time
    Debug.Print dt
    
    &#39;使当天日期与时间同时显示出来？
    dt &#x3D; VBA.Now
    Debug.Print dt
    
    &#39;单独获得年月日、时分秒？
    Debug.Print VBA.Year(dt)
    Debug.Print VBA.Month(dt)
    Debug.Print VBA.Day(dt)
    
    &#39;不写vba.的前缀也可以
    Debug.Print Hour(dt)
    Debug.Print Minute(dt)
    Debug.Print Second(dt)
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="日期格式化操作"><a href="#日期格式化操作" class="headerlink" title="日期格式化操作"></a>日期格式化操作</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub DateTimeFunctionTest2()
    Dim dt As Date, dt2 As Date
    
    dt &#x3D; Date
    
    dt2 &#x3D; VBA.Time
    
    &#39;通过VBA的format进行日期的格式化操作
    Debug.Print VBA.Format(dt, &quot;yyyy-mm-dd&quot;)
    
    Debug.Print VBA.Format(dt, &quot;现在是yyyy年mm月dd日，我好爱你！&quot;)
    
    
    &#39;通过VBA的FormatDateTime函数，设置日期的格式，和本机的日期、事件的格式设置相关
    Debug.Print VBA.FormatDateTime(dt, vbGeneralDate) &#39;默认的日期格式
    
    Debug.Print VBA.FormatDateTime(dt, vbLongDate) &#39;效果是长日期，如2022年11月9日
    Debug.Print VBA.FormatDateTime(dt, vbShortDate) &#39;效果是短日期，如2022&#x2F;11&#x2F;9
    
    Debug.Print VBA.FormatDateTime(dt2, vbLongTime) &#39;效果是长时间，17:28:13
    Debug.Print VBA.FormatDateTime(dt2, vbShortTime) &#39;效果是短时间，17:28
    
    &#39;如果想对单元格中的日期进行设置
    &#39;NumberFormat不是VBA提供的日期函数，是单元格的属性
    Range(&quot;A2:A21&quot;).NumberFormat &#x3D; &quot;yyyy年mm月dd日&quot;
    

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="日期计算操作"><a href="#日期计算操作" class="headerlink" title="日期计算操作"></a>日期计算操作</h2><p>可以用<em>VBA.DateDiff</em>直接相减，也可以<em>VBA.DateAdd</em>表示 加&#x2F;减 几年几月几日</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub DateTimeFunctionTest3()
    Dim StartDate As Date, EndDate As Date
    
    StartDate &#x3D; Date &#39;获取当期日期
    EndDate &#x3D; #12&#x2F;12&#x2F;2024# &#39;赋值一个日期
    
    Debug.Print &quot;剩余天数：&quot; &amp; (EndDate - StartDate) &amp; &quot; Days&quot;
    &#39;把2个日期直接相减，可以获得他们相差的天数
    
    &#39;也可以用函数
    &#39;如果想要知道他们相差的年份&#x2F;月数
    &#39;
    Debug.Print &quot;剩余天数：&quot; &amp; VBA.DateDiff(&quot;d&quot;, StartDate, EndDate) &amp; &quot; Days&quot;
      
    Debug.Print &quot;剩余月数：&quot; &amp; VBA.DateDiff(&quot;m&quot;, StartDate, EndDate) &amp; &quot; Months&quot;
    
    &#39;注意年数要使用4个y，“yyyy”
    Debug.Print &quot;剩余年数：&quot; &amp; VBA.DateDiff(&quot;yyyy&quot;, StartDate, EndDate) &amp; &quot; Years&quot;
    
    
    
    &#39;在 当期日期 上加上正的5年，得到的日期
    
    
    &#39;表示在 当期日期 上加上5年，得到的日期
    Debug.Print VBA.DateAdd(&quot;yyyy&quot;, 5, StartDate)
    
    &#39;表示在 当期日期 上加上5个月，得到的日期
    Debug.Print VBA.DateAdd(&quot;m&quot;, 5, StartDate)
    
    &#39;表示在 当期日期 上加上10天，得到的日期
    Debug.Print VBA.DateAdd(&quot;d&quot;, 10, StartDate)
    
    
    
    &#39;也可以加上负数，表示在 当期日期 减去5年&#x2F;5个月&#x2F;10天
    
    Debug.Print VBA.DateAdd(&quot;yyyy&quot;, -5, StartDate)
    
    Debug.Print VBA.DateAdd(&quot;m&quot;, -5, StartDate)
    
    Debug.Print VBA.DateAdd(&quot;d&quot;, -10, StartDate)
    
    
    &#39;表示在当期日期上先加5年，再加5个月，再加10天
    &#39;可以用函数赋值的思想，一步一步操作
    
    StartDate &#x3D; VBA.DateAdd(&quot;yyyy&quot;, 5, StartDate)
    Debug.Print &quot;先加上5年后的日期：&quot; &amp; StartDate
    
    StartDate &#x3D; VBA.DateAdd(&quot;m&quot;, 5, StartDate)
    Debug.Print &quot;先加上5个月的日期：&quot; &amp; StartDate

    StartDate &#x3D; VBA.DateAdd(&quot;d&quot;, 10, StartDate)
    Debug.Print &quot;先加上10天后的日期：&quot; &amp; StartDate
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="日期案例实战"><a href="#日期案例实战" class="headerlink" title="日期案例实战"></a>日期案例实战</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub DateTimeFunctionTest4()
    &#39;计算日期1和日期2的相隔天数，并存储到C列
    Dim StartDate As Date, EndDate As Date
    
    &#39;Cell表示A列活动的单元格
    &#39;NextCell表示B列活动的单元格
    &#39;DiffCell表示C列活动的单元格
    
    Dim Cell As Range, NextCell As Range, DiffCell As Range
    
    &#39;遍历
    &#39;针对A列的A2单元格，到最末尾的单元格进行遍历
    &#39;表示从A2开始，到A2最底下这块区域
    For Each Cell In Range(Range(&quot;A2&quot;), Range(&quot;A2&quot;).End(xlDown))
    
        &#39;针对A列的活动单元格进行格式化操作
        Cell.NumberFormat &#x3D; &quot;yyyy-mm-dd&quot;
        
        &#39;获得A列活动单元格旁边的单元格，赋值给NextCell
        Set NextCell &#x3D; Cell.Offset(0, 1)
        &#39;针对B列的活动单元格进行格式化操作
        NextCell.NumberFormat &#x3D; &quot;yyyy-mm-dd&quot;
    
        &#39;获得C列的对应单元格
        Set DiffCell &#x3D; NextCell.Offset(0, 1)
        
        &#39;获得日期1、日期2，分别赋值给日期类型的变量
        StartDate &#x3D; Cell.Value
        EndDate &#x3D; NextCell.Value
        
        &#39;使用VBA提供的DateDiff函数，获取相差天数，算出的结果赋值给C列对应单元格
        DiffCell.Value &#x3D; DateDiff(&quot;d&quot;, StartDate, EndDate)

				&#39;把相差天数超过400的，字体颜色设置成红色，并进行加粗
        If DiffCell &gt; 400 Then
            DiffCell.Font.Color &#x3D; vbRed
            DiffCell.Font.Bold &#x3D; True
        End If
    
    Next Cell
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="文本类型数据基础知识"><a href="#文本类型数据基础知识" class="headerlink" title="文本类型数据基础知识"></a>文本类型数据基础知识</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub StringTest()
    Dim Str As String
    
    &#39;文本类型变量赋值
    Str &#x3D; &quot;文本类型数值&quot;
    Debug.Print Str
    
    &#39;隐式类型转换
    &#39;整数类型数据，赋值给文本类型变量
    &#39;为什么没问题？因为发生了隐式类型转化，也就是说，这里看上去是123456这样1个整数类型的数据；
    &#39;但是实际上它已经是包括有双引号这样的1个文本类型数据，即“123456”
    
    Str &#x3D; 123456
    Debug.Print Str
    &#39;有方法可以查看当前的str是个什么数据类型
    &#39;可以发现这里的123456是文本数据类型，string，变量类型没有发生变化
    Debug.Print TypeName(Str)
    
    
    &#39;显示类型转换
    Str &#x3D; CStr(123456) &#39;这里的作用就是把123456，用VBA的方法变成文本数据类型
    Debug.Print Str
    Debug.Print TypeName(Str)
    
    
    
    &#39;固定长度文本变量
    Dim s As String * 3
    s &#x3D; Str
    Debug.Print &quot;Str的内容是：&quot; &amp; Str
    Debug.Print &quot;s的内容是：&quot; &amp; s
    
    &#39;为什么str是123456，而s是123呢？
    &#39;因为定义s变量的时候，我们限制了它的长度为3；会把超出它限制长度的数据给删除
    &#39;和python里不一样
    &#39;实际编写代码时，不推荐使用
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="拆分字符串"><a href="#拆分字符串" class="headerlink" title="拆分字符串"></a>拆分字符串</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub StringTest2()
    Dim str As String
    
    str &#x3D; &quot;本节课是关于字符串的拆分&quot;
    
    
&#39;    &#39;left，mid，right函数
&#39;    Debug.Print VBA.Left(str, 3)
&#39;    Debug.Print VBA.Right(str, 3)
&#39;    &#39;2个参数，表示截取哪个字符串，要从左&#x2F;右截取字符串的长度
&#39;
&#39;    Debug.Print VBA.Mid(str, 4) &#39;第3个参数，不填默认从指定的字符串开始，往后的所有内容都会获取到
&#39;    Debug.Print VBA.Mid(str, 4, 3) &#39;第3个参数，填了就表示，从第4个文字开始，想要获取几个长度的文字
&#39;
&#39;
&#39;
&#39;
&#39;    &#39;有固定放分隔符，需要定义一个数组，由于不知道长度，就是不知道会拆分成几个，就定义1个动态数组
&#39;    Dim SplitStr() As String
&#39;    str &#x3D; &quot;ACV-KJH-OMS-LLX&quot;
&#39;
&#39;    &#39;split函数：根据特定的字符对文本字符串进行拆分
&#39;    SplitStr &#x3D; Split(str, &quot;-&quot;, 2)
&#39;    &#39;第1个参数表示，需要进行拆分的字符串
&#39;    &#39;第2个参数表示，根据哪个分隔符拆分
&#39;    &#39;第3个参数表示，我们想要把这个文本的字符串，想要拆分成几份，那么在从左往右拆分时，已拆到这个数量时，就不继续拆分，即使后面还有这个拆分符；不填的话就是有多少拆多少
&#39;    &#39;第4个参数，有3中可选，我们这里进行更加详细的说明
&#39;
&#39;
&#39;    &#39;想要展示数组，需要通过for循环，遍历数组内容
&#39;    Dim index As Integer
&#39;    For index &#x3D; LBound(SplitStr) To UBound(SplitStr)
&#39;        Debug.Print SplitStr(index)
&#39;    Next index
&#39;
&#39;
    
    
    
    &#39;第4个参数就表示，假如是用英文字母做拆分符号，那么是否采用大小写敏感
    
    str &#x3D; &quot;JKavcFGAJKLAHYH&quot;
    &#39;这个字符串里，有大写的A和小写的a
    &#39;假定我们就用字母Dd，把这个文本的字符串进行拆分
    
    &#39;大小写敏感，表示和大小写相关，那么只会对A进行拆分，a不进行拆分
    &#39;SplitStr &#x3D; Split(str, &quot;A&quot;, , vbBinaryCompare)
    
    &#39;与数据库有关，目前暂时不学习，目前只涉及到excel，而不是数据库
    &#39;SplitStr &#x3D; Split(str, &quot;A&quot;, , vbDatabaseCompare)
    
    &#39;大小写不敏感，表示和大小写吧相关，A和a都会进行拆分
    SplitStr &#x3D; Split(str, &quot;A&quot;, , vbTextCompare)
    
     &#39;想要展示数组，需要通过for循环，遍历数组内容
    Dim index As Integer
    For index &#x3D; LBound(SplitStr) To UBound(SplitStr)
        Debug.Print SplitStr(index)
    Next index
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="拆分字符串应用案例"><a href="#拆分字符串应用案例" class="headerlink" title="拆分字符串应用案例"></a>拆分字符串应用案例</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Function GetOrderPart(OrderInfoRange As Range, index As Integer)
&#39;编写一个子函数，函数名是GetOrderPart，&quot;意思是获得订单编号对应部分“；
&#39;订单编号是类似ABC-123-jlj这样的数据
&#39;第一个参数：设置了1个range类型的变量作为参数，指引用的单元格，也就是想要用短横线作为分隔符的原始数据&#x2F;针对哪个单元格中的内容进行拆分
&#39;第二个参数：用短横线作为分隔符，拆分后的字符串会有好几个，我们想要输出其中的第几个

    Dim InfoAray() As String
    &#39;设置了一个文本类型的数组，用于接收拆分之后的信息
    
    InfoAray &#x3D; Split(OrderInfoRange, &quot;-&quot;)
    &#39;拆分，针对单元格中的内容进行拆分，拆分的分隔符就是短横线；用InfoAray进行接收，会有&gt;&#x3D;1个部分，组成了数组
    
    GetOrderPart &#x3D; InfoAray(index - 1)
    &#39;返回指定部分，即数组中的第(index-1)个：因为文本类型的数组是从0开始，所以index要减1；数组中的第(index-1)个就是这个函数的结果，即输出的结果
    
End Function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="连接字符串"><a href="#连接字符串" class="headerlink" title="连接字符串"></a>连接字符串</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub StringTest3()
    Dim str1 As String, str2 As String, str3 As String
    str1 &#x3D; &quot;蓦然回首&quot;
    str2 &#x3D; &quot;那人却在&quot;
    str3 &#x3D; &quot;灯火阑珊处&quot;
    
    
    &#39;通过&amp;链接运算符
    Debug.Print str1 &amp; &quot;，&quot; &amp; str2 &amp; &quot;，&quot; &amp; str3 &amp; &quot;。&quot;
    
    &#39;通过VBA的Join函数，实现字符串数组元素的连接
    &#39;第一步：把想要连接的内容，转变成字符串数组；
    &#39;第二步：通过join函数进行连接，设定特点字符进行连接
    
    
    
    &#39;先把str1.2.3转化成一个字符串的数组
    Dim strarray() As Variant
    &#39;声明一个可变的类型的动态数组
    
    strarray &#x3D; Array(str1, str2, str3)
    &#39;VBA有1个array函数，就是把变量包含的所有内容，作为这样的数组元素；用array函数处理之后，就会返回这样的1个数组
    
    Debug.Print Join(strarray, &quot;,&quot;)
    
    
End Sub

Function StrConcat(str1 As String, str2 As String, str3 As String)
&#39;这个函数的用处在于把(str1, str2, str3)这3个文本的内容，用斜杠&#x2F;连接起来
    Dim strarray() As Variant
    strarray &#x3D; Array(str1, str2, str3)
    StrConcat &#x3D; Join(strarray, &quot;&#x2F;&quot;)
End Function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="替换字符串"><a href="#替换字符串" class="headerlink" title="替换字符串"></a>替换字符串</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub StringTest4()
    Dim str As String
    &#39;字符串穿插了很多d，其中有大写的和小写的
    str &#x3D; &quot;dfhDGHJdttDOO99gggd&quot;
    
    &#39;把字符串中的小写d全都替换成短横线-
    Debug.Print Replace(str, &quot;d&quot;, &quot;-&quot;)
    &#39;效果是【-fhDGHJ-ttDOO99ggg-】
    &#39;默认情况下，大小写敏感
    
    &#39;第1个参数：需要对哪个字符串进行部分字符串的替换
    &#39;第2个参数：对哪个字符串进行替换
    &#39;第3个参数：替换成什么字符串
    &#39;第4个参数：设置替换的起始位置，即从str第一个字符开始计数，从第几个字符串开始替换，没有设置为起点范围内的字符，都会自动被清除掉
    &#39;第5个参数：设置替换的数量，替换了这么多之后，后面的就不再进行替换
    &#39;第6个参数：大小写敏感，vbBinaryCompare——大小写敏感；vbTextCompare——大小写不敏感
    
    
    &#39;第6个参数：想要实现大小写不敏感的效果，需要去考虑最后一个参数
    
    &#39;大小写敏感:
    Debug.Print Replace(str, &quot;d&quot;, &quot;-&quot;, , , vbBinaryCompare)
    &#39;效果：【-fhDGHJ-ttDOO99ggg-】
    
    &#39;大小写不敏感
    Debug.Print Replace(str, &quot;d&quot;, &quot;-&quot;, , , vbTextCompare)
    &#39;效果：【-fh-GHJ-tt-OO99ggg-】
    
    
    
    &#39;第4个参数：设置替换的起始位置，即从str第一个字符开始计数，从第几个字符串开始替换，没有设置为起点范围内的字符，都会自动被清除掉
    Debug.Print Replace(str, &quot;d&quot;, &quot;-&quot;, 3, , vbTextCompare)
    &#39;效果：【h-GHJ-tt-OO99ggg-】
    
    
    &#39;第5个参数：设置替换的数量，替换了这么多之后，后面的就不再进行替换
    Debug.Print Replace(str, &quot;d&quot;, &quot;-&quot;, 3, 2, vbTextCompare)
    &#39;效果：【h-GHJ-ttDOO99gggd】
    
End Sub

&#39;目的是将JK替换为AC
Function replaceJKtoAC(orderinforange As Range)
    replaceJKtoAC &#x3D; Replace(orderinforange.Value, &quot;JK&quot;, &quot;AC&quot;, , 1, vbTextCompare)
End Function

&#39;有点像定义一个y&#x3D;f(x),x&gt;0,y&#x3D;(x+1)*(x-9)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="字母大小写设置"><a href="#字母大小写设置" class="headerlink" title="字母大小写设置"></a>字母大小写设置</h2><p>大小写不敏感：vbTextCompare</p>
<p>大小写敏感：vbBinaryCompare</p>
<p>大小写设置本身就是很重要的一个点</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub StringTest5()
    Dim str1 As String, str2 As String, str3 As String
    str1 &#x3D; &quot;JK&quot;
    str2 &#x3D; &quot;jk&quot;
    str3 &#x3D; &quot;jkJK&quot;
    
    Debug.Print str1 &#x3D; str2
    &#39;结果是False，说明：默认情况下，大小写敏感。

    &#39;comp,compare的缩写
    Debug.Print StrComp(str1, str2, vbTextCompare)
    &#39;结果是0，说明相等
    
    Debug.Print StrComp(str1, str3, vbTextCompare)
    &#39;结果是-1，说明不相等
    
    
    
    &#39;切换大小写，可以使用函数LCase（小写处理）、Ucase（大写处理）
    Debug.Print LCase(str1)
    Debug.Print UCase(str2)
    
    
    &#39;切换大小写，也可以使用大小写切换函数，根据后面的参数，表现为不同的效果
    &#39;Conv，Converter
    Debug.Print StrConv(str3, vbUpperCase) &#39;全部变成大写
    Debug.Print StrConv(str3, vbLowerCase) &#39;全部变成小写
    Debug.Print StrConv(str3, vbProperCase) &#39;首字母变成大写，其他字母全都变成小写
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="查找字符串"><a href="#查找字符串" class="headerlink" title="查找字符串"></a>查找字符串</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub StringTest()
    Dim str As String
    str &#x3D; &quot;ABdCDdEAFdGaAbcddAefg&quot;
    
    &#39;获取某个字母的起始位置
    &#39;使用Instr查看在某个文本变量中，是否存在某个字符串，如果存在，就会返回相应的位置；
    &#39;如果不存在，就返回0
&#39;    Debug.Print InStr(1, str, &quot;d&quot;, vbBinaryCompare)
&#39;
&#39;    Debug.Print InStr(12, str, &quot;d&quot;, vbBinaryCompare)

    &#39;想要查找字母d出现的次数
    
    Dim index As Integer, count As Integer
    index &#x3D; 1
    
    &#39;只要还有“d”存在，就继续执行
    While index &lt;&gt; 0
    
    
        &#39;不加这段代码的话，档要查找的字符串是整个字符串的第一个字母的时候，会有bug
        &#39;因为是从整个字符串的第二个字母开始查找的，那么第一个位置的字符串就会查找不到
        If count &#x3D; 0 Then
            index &#x3D; 0
        End If
    

        &#39;从上一次查找到的位置的右边开始，继续查找“d”的位置
        index &#x3D; InStr(index + 1, str, &quot;A&quot;, vbBinaryCompare)
        &#39;如果不为0，就继续查找
        If index &lt;&gt; 0 Then
            count &#x3D; count + 1
        End If
        Debug.Print index
        
        
    Wend
    
    Debug.Print &quot;Count&#x3D;&quot; &amp; count

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="LIKE运算符"><a href="#LIKE运算符" class="headerlink" title="LIKE运算符"></a>LIKE运算符</h2><table>
<thead>
<tr>
<th>Pattern规则</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>零个或多个字符</td>
</tr>
<tr>
<td>?</td>
<td>任意单个字符</td>
</tr>
<tr>
<td>#</td>
<td>任何单个数字 (0-9)</td>
</tr>
<tr>
<td>[ charlist ]</td>
<td>charlist 内的任意单个字符</td>
</tr>
<tr>
<td>[ !charlist ]</td>
<td>charlist 外的任意单个字符</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>订单编号(练习素材)</th>
</tr>
</thead>
<tbody><tr>
<td>IPV-NSU-36456</td>
</tr>
<tr>
<td>TS-EYS-77G</td>
</tr>
<tr>
<td>HDC-HUJ-19481</td>
</tr>
<tr>
<td>OY-HX-815</td>
</tr>
<tr>
<td>LNG-ZSN-831</td>
</tr>
<tr>
<td>OS-SW-852</td>
</tr>
<tr>
<td>NVH-OHD-9376</td>
</tr>
<tr>
<td>OZW-SR-125</td>
</tr>
<tr>
<td>JI-TKX-132</td>
</tr>
<tr>
<td>FGX-CPZ-26532</td>
</tr>
<tr>
<td>EY-HXR-4334</td>
</tr>
<tr>
<td>UUK-IZT-46</td>
</tr>
<tr>
<td>ZUF-BCV-6146</td>
</tr>
<tr>
<td>GHW-UOU-457</td>
</tr>
<tr>
<td>SHN-MJN-37</td>
</tr>
<tr>
<td>DHD-OCT-3716</td>
</tr>
</tbody></table>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub StringTest()
    &#39;Like：符合某个文本的模式
    &#39;I*：设置了某个模型，含义就是以I字母开头
    &#39;下面这行代码的意思就是，验证这个字符串是不是以字母A开头，是的话就输出TRUE，不是就输出FALSE
    &#39;只有A这个字符，也是会返回TRUE
    &#39;Debug.Print &quot;ABC-DEF-GHIJ&quot; Like &quot;A*&quot;
    
    Dim pattern As String
    
    &#39;以O开头
    &#39;pattern &#x3D; &quot;O*&quot;
    
    &#39;以两个字符开头
    &#39;也就是短横线左侧有两个字符，所以要加个短横线；短横线右侧就可以有0个或者多个字符串，所以要加个*
    &#39;pattern &#x3D; &quot;??-*&quot;
    
    &#39;以3个数字结尾，就是最后短横线后面只有3个数字
    &#39;pattern &#x3D; &quot;*-###&quot;
    
    &#39;以O和G开头，记得加上双引号
    &#39;pattern &#x3D; &quot;[OG]*&quot;
    
    
    &#39;不以O和G开头，记得加上双引号
    &#39;pattern &#x3D; &quot;[!OG]*&quot;
    
    &#39;以O开头，两个字符开头，中间两个字符，三个数字结尾
    pattern &#x3D; &quot;O?-??-###&quot;
    
    
    Dim cell As Range
    
    For Each cell In Range(&quot;A2&quot;, Range(&quot;A2&quot;).End(xlDown)) &#39;从A2开始的，到A2以下的所有单元格
        cell.Font.Color &#x3D; vbBlack &#39;如果重复操作几次，修改过格式，需要先把之前操作的格式清除，也就是把字体颜色变成黑色
        If cell.Value Like pattern Then
            cell.Font.Color &#x3D; vbRed
        End If
    Next cell
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="Excel内置函数的使用"><a href="#Excel内置函数的使用" class="headerlink" title="Excel内置函数的使用"></a>Excel内置函数的使用</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit

Sub ExcelFunctionTest()
    Range(&quot;E2&quot;).Value &#x3D; &quot;求和结果：&quot;
    Range(&quot;F2&quot;).Value &#x3D; Application.WorksheetFunction.Sum(Range(&quot;A1:A15&quot;))
    
    Range(&quot;E3&quot;).Value &#x3D; &quot;最大值为：&quot;
    Range(&quot;F3&quot;).Value &#x3D; Application.WorksheetFunction.Max(Range(&quot;A1:A15&quot;))
    
    Range(&quot;E4&quot;).Value &#x3D; &quot;最小值为：&quot;
    Range(&quot;F4&quot;).Value &#x3D; Application.WorksheetFunction.Min(Range(&quot;A1:A15&quot;))
    
    
    Range(&quot;E6&quot;).Value &#x3D; &quot;排名第5的单元格的值为：&quot;
    Range(&quot;F6&quot;).Value &#x3D; Application.WorksheetFunction.Large(Range(&quot;A1:A15&quot;), 5)
    
    
    Range(&quot;E8&quot;).Value &#x3D; &quot;对大于5000的数进行求和：&quot;
    Range(&quot;F8&quot;).Value &#x3D; Application.WorksheetFunction.SumIf(Range(&quot;A1:A15&quot;), &quot;&gt;&quot; &amp; 5000)
    
    &#39;并不是Excel所有的内置函数都可以进行使用
    &#39;VBA函数包含的功能，与Excel内置函数有冲突时，Excel内置函数无法使用！
    &#39;就是说，当你想用一个Excel内置函数却发现VBA不支持时，有可能是VBA自己有这个功能的函数
    
    &#39;举例
    &#39;无法使用Excel里面的rand函数生成随机数，因为VBA有这个功能的函数
    &#39;Application.WorksheetFunction.Rand
    
    &#39;初始化随机数：0~1（不包含）
    &#39;会在H4单元格生成一个0~1（不包含）之间的随机数
    VBA.Randomize
    Range(&quot;H3&quot;).Value &#x3D; &quot;生成一个0~1（不包含）之间的随机数&quot;
    Range(&quot;H4&quot;).Value &#x3D; VBA.Rnd
    
    
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h1 id="【Chapter-5】VBA异常和事件处理"><a href="#【Chapter-5】VBA异常和事件处理" class="headerlink" title="【Chapter 5】VBA异常和事件处理"></a>【Chapter 5】VBA异常和事件处理</h1><h2 id="VBA程序异常OnError处理"><a href="#VBA程序异常OnError处理" class="headerlink" title="VBA程序异常OnError处理"></a>VBA程序异常OnError处理</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub ExceptionTest1()
    Dim Num As Variant
    
    Num &#x3D; InputBox(&quot;请输入一个数字：&quot;)
    
    &#39;输出输入的数字的平方根
&#39;    Debug.Print VBA.Sqr(Num)
    
    &#39;假如输入的是负数&#x2F;文本&#x2F;空值，就会报错
    
    
    &#39;思路一：用if和msgbox
    If Num &lt; 0 Then
        MsgBox &quot;请不要输入负数&quot;
    ElseIf Not VBA.IsNumeric(Num) Then
        MsgBox &quot;请输入数字&quot;
    Else
        Debug.Print VBA.Sqr(Num)
    End If
&#39;
End Sub

Sub ExceptionTest2()
    Dim Num As Variant
    
    &#39;如果出现错误，就跳过其他代码，直接跳转到相应标签
    &#39;如果没有这行代码，那么输入负数&#x2F;文本&#x2F;空值时，就会提示错误
    On Error GoTo ErrorHandler
    
    
    Num &#x3D; InputBox(&quot;请输入一个数字：&quot;)
    Debug.Print VBA.Sqr(Num)
    
    &#39;没有错误，不再显示错误信息
    &#39;如果没有这段代码，那么输入正数时，代码运行没有任何错误时，也会弹窗“请确认输入一个正数”
    Exit Sub
    
ErrorHandler:
    MsgBox &quot;请确认输入一个正数&quot;
    
    
End Sub

Sub ExceptionTest3()
    Dim Num As Variant
    
    &#39;出现错误，跳过继续执行；可以跳过不止一次
    &#39;没有这段代码，代码执行会报错；加上这段代码，就代码不会报错，只是继续往下执行：弹窗“异常”
    On Error Resume Next
    
    
    Num &#x3D; InputBox(&quot;请输入一个数字：&quot;)
    
    Debug.Print VBA.Sqr(Num)
    Exit Sub
    
    MsgBox &quot;VBA异常处理1&quot;
    
    &#39;如果不想要下面的代码出现错误时，和上面是一样的处理方式，那么就用这段代码
    &#39;重置错误默认处理方式
    On Error GoTo 0
    
    Debug.Print 1 &#x2F; 0 &#39;不会在立即窗口出现结果，因为有上面的代码，所以出现错误就跳过了，继续执行接下来的代码
    
    MsgBox &quot;VBA异常处理2&quot;
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="VBA程序异常Resume处理"><a href="#VBA程序异常Resume处理" class="headerlink" title="VBA程序异常Resume处理"></a>VBA程序异常Resume处理</h2><p>可以考虑再听一遍课程，resume的三种用法下，代码的运行逻辑不一样</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Sub ExceptionTest()
    Dim Num As Variant
        
InputNum:
    &#39;如果出现错误，就跳过其他代码，直接跳转到相应标签
    &#39;如果没有这行代码，那么输入负数&#x2F;文本&#x2F;空值时，就会提示错误
    On Error GoTo ErrorHandler

    Num &#x3D; InputBox(&quot;请输入一个数字：&quot;)
    Debug.Print VBA.Sqr(Num)
    
    MsgBox &quot;VBA代码异常&quot;
    
    &#39;没有错误，不再显示错误信息
    &#39;如果没有这段代码，那么输入正数时，代码运行没有任何错误时，也会弹窗“请确认输入一个正数”
    Exit Sub
    
ErrorHandler:
    MsgBox &quot;请确认输入一个正数&quot;
    &#39;弹出这个窗口后，点击“确定”，这个程序就结束了，这是因为程序的意思是，
    &#39;出现错误后直接跳过其他代码，跳转到这个弹窗，作用仅仅是弹窗一下
    
    
    &#39;resume有三种使用方式：
    
    &#39;方法一：
    &#39;如果想要弹窗之后，处理错误之后，继续允许输入数字，再写一个标签InputNum，到达相应的标签处再次运行
&#39;    Resume InputNum
    
    &#39;方法二：
    &#39;跳过错误的代码行，继续执行
&#39;    Resume Next
    
    &#39;方法三：
    &#39;从出现错误的代码处开始执行（就是Debug.Print VBA.Sqr(Num)这一行）
    &#39;如果进入死循环，就长按ESC按钮；
    &#39;如果出现错误，就将num赋值为100
    &#39;Num&#x3D;100
    Num &#x3D; -Num
    Resume
    

End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="VBA程序Bug处理技巧"><a href="#VBA程序Bug处理技巧" class="headerlink" title="VBA程序Bug处理技巧"></a>VBA程序Bug处理技巧</h2><figure><div class="code-wrapper"><pre class="line-numbers language-visual" data-language="visual"><div class="caption"><span>basic</span></div><code class="language-visual">Option Explicit
Sub DebugTest1()
    &#39;编译错误
    &#39;查看代码，确保代码语法没有问题
    &#39;比如这里少了个括号或者英文引号之类的
    Range(&quot;A1&quot;).Value &#x3D; 100
End Sub

Sub DebugTest2()
    &#39;运行时错误
    &#39;执行代码的时候，如果代码行数很多，遇到了“运行时错误”，且不知道哪一行代码错了
    &#39;1. 可以点击【调试】按钮，它会提示你哪一行代码错了
    &#39;2. 还可以通过注释某一行代码的方式，去缩小错误排查范围
    &#39;3. 也可以通过逐语句执行的方式
    Dim Num As Integer
    
    For Num &#x3D; 1 To 10
        Range(&quot;A&quot; &amp; Num).Value &#x3D; Num * 100
        Range(&quot;A&quot; &amp; Num).Interior.Color &#x3D; vbRed
    Next Num
End Sub

Sub DebugTest3()
&#39;1. 明确非常常见的错误：程序没有语法错误，而是程序执行的结果并没有出现预期的结果，逻辑性错误。
&#39;2. 针对程序的逻辑性错误，就需要通过变量或者表达式在执行的过程中的内容判定逻辑问题出在哪里。
&#39;3. 有三种方式查看变量的内容。本地窗口、监控窗口、立即窗口
&#39;4. 打断点：希望程序在哪个位置停止运行，方便我们查看当前状态下的变量以及表达式的内容。
    
    
    
    &#39;1. 可以逐行写注释，来展示思路
    &#39;2. 还可以通过打断点的方式，就是在这行代码的左侧，点一下红色，会有个红点
        &#39;这个红点的意思就是：程序运行时，到达这个断点之后，就停止了运行，可以查看到达这个断点的时候，各个变量的数值是多少（有点麻烦）
    &#39;3. 想要看到各个变量的值，还可以去【视图-本地窗口】，可以看到当前的子程序中，所有的相关的变量所发生的变化
    &#39;4. 【视图-立即窗口】，输入【?Num1】，然后回车，可以展示当前变量的值
    &#39;5. 【视图-监视窗口】，可以指定想要监视某个变量，比如想要监视变量num1，就鼠标点在num1处，右击，点击“添加监视”；
        &#39;【监视窗口】，除了可以监视变量，还可以监视表达式，比如想要监视【Num1 * Num2】的结果，就鼠标左键选中代码中的Num1 * Num2，然后右击“添加监视”；监视【Num2 &amp; &quot;*&quot; &amp; Num1 &amp; &quot;&#x3D;&quot; &amp; (Num1 * Num2)】也可以
    Dim Num1 As Integer, Num2 As Integer
    
    &#39;将num1作为行数
    For Num1 &#x3D; 1 To 9
        &#39;将num2作为列数
        For Num2 &#x3D; 1 To 9
            &#39;只有行数大于列数的时候，才会执行相应的内容设置代码
            If Num1 &gt;&#x3D; Num2 Then
                &#39;设置相应单元格的内容
                Cells(Num1, Num2) &#x3D; Num2 &amp; &quot;*&quot; &amp; Num1 &amp; &quot;&#x3D;&quot; &amp; (Num1 * Num2)
            End If
        Next Num2
    Next Num1
    
End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="工作表—事件处理程序"><a href="#工作表—事件处理程序" class="headerlink" title="工作表—事件处理程序"></a>工作表—事件处理程序</h2><h2 id="工作簿—事件处理程序"><a href="#工作簿—事件处理程序" class="headerlink" title="工作簿—事件处理程序"></a>工作簿—事件处理程序</h2><h1 id="【Chapter-6】MsgBox和InputBox"><a href="#【Chapter-6】MsgBox和InputBox" class="headerlink" title="【Chapter 6】MsgBox和InputBox"></a>【Chapter 6】MsgBox和InputBox</h1><p>MsgBox各个参数的作用</p>
<p>MsgBox返回值处理技巧</p>
<p>InputBox函数的使用方式</p>
<p>InputBox函数的Type参数使用</p>
<p>【Chapter 7】VBA工作应用实战</p>
<p>拆分工作表（上）</p>
<p>拆分工作表（下）</p>
<p>多工作表合并</p>
<p>拆分成多工作簿</p>
<p>多工作簿合并</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>【Excel高阶】宏与VBA</div>
      <div>http://example.com/2025/02/26/【Excel高阶】宏与VBA/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>JiuGuiChen</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年2月26日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/01/18/%E5%9F%BA%E9%87%91%E6%94%BB%E7%95%A5/" title="基金攻略">
                        <span class="hidden-mobile">基金攻略</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"RVBrkM2zzP4n38YaXKMiT7qo-gzGzoHsz","appKey":"GOhdYcrdXsQttxanHr7Hglmo","path":"window.location.pathname","placeholder":"说点什么","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://rvbrkm2z.lc-cn-n1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
