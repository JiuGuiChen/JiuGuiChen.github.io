<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【Excel高阶】宏与VBA | 九规而已</title><meta name="author" content="JiuGuiChen"><meta name="copyright" content="JiuGuiChen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="VBA学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="【Excel高阶】宏与VBA">
<meta property="og:url" content="http://yoursite.com/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/index.html">
<meta property="og:site_name" content="九规而已">
<meta property="og:description" content="VBA学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/img/Excel.png">
<meta property="article:published_time" content="2025-02-26T14:41:14.000Z">
<meta property="article:modified_time" content="2025-02-27T16:16:15.562Z">
<meta property="article:author" content="JiuGuiChen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/img/Excel.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【Excel高阶】宏与VBA",
  "url": "http://yoursite.com/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/",
  "image": "http://yoursite.com/img/Excel.png",
  "datePublished": "2025-02-26T14:41:14.000Z",
  "dateModified": "2025-02-27T16:16:15.562Z",
  "author": [
    {
      "@type": "Person",
      "name": "JiuGuiChen",
      "url": "http://yoursite.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/rabbit.jpg"><link rel="canonical" href="http://yoursite.com/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?[object Object]";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【Excel高阶】宏与VBA',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/Excel.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">九规而已</span></a><a class="nav-page-title" href="/"><span class="site-name">【Excel高阶】宏与VBA</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">【Excel高阶】宏与VBA</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-26T14:41:14.000Z" title="发表于 2025-02-26 22:41:14">2025-02-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-27T16:16:15.562Z" title="更新于 2025-02-28 00:16:15">2025-02-28</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">19.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>75分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="【Chapter-1】1宏录制方法与技巧"><a href="#【Chapter-1】1宏录制方法与技巧" class="headerlink" title="【Chapter 1】1宏录制方法与技巧"></a>【Chapter 1】1宏录制方法与技巧</h1><h2 id="什么是宏和VBA"><a href="#什么是宏和VBA" class="headerlink" title="什么是宏和VBA"></a>什么是宏和VBA</h2><p>1.VBA（vb for Applications），一种编程语言。</p>
<p>2.通过VBA编写的一系列指令组成的程序，称之为宏。</p>
<p>3.通过学习VBA编写宏，有利于我们高效完成重复性的数据任务。</p>
<h2 id="宏安全设置"><a href="#宏安全设置" class="headerlink" title="宏安全设置"></a>宏安全设置</h2><p>文件-选项-信任中心-信任中心设置-受信任位置，只要是在这些路径下的Excel文档，我们都认为它是安全的。</p>
<h1 id="【Chapter-2】VBA编程基础语法"><a href="#【Chapter-2】VBA编程基础语法" class="headerlink" title="【Chapter 2】VBA编程基础语法"></a>【Chapter 2】VBA编程基础语法</h1><h2 id="相对引用"><a href="#相对引用" class="headerlink" title="相对引用"></a>相对引用</h2><p><a target="_blank" rel="noopener" href="https://www.notion.so/Excel-96c86e13f15644329bef8d9b6ed696e1?pvs=21"><strong>Excel 录制宏时绝对和相对引用的区别</strong></a></p>
<p>不使用相对引用，就是每一次执行宏都是对同一个区域进行操作；使用了相对引用，就是对一开始选定的“活动单元格”后面的相对区域，即进行一定的位置偏移，进行后续操作。</p>
<h2 id="运行宏的方法"><a href="#运行宏的方法" class="headerlink" title="运行宏的方法"></a>运行宏的方法</h2><ol>
<li>自定义的快捷键</li>
<li>表单控件：一个按钮</li>
<li>快速访问工具栏</li>
</ol>
<h2 id="自己编写VBA代码"><a href="#自己编写VBA代码" class="headerlink" title="自己编写VBA代码"></a>自己编写VBA代码</h2><p>Sub 表示一个子程序，可以理解为一串代码的集合</p>
<p>MsgBox就是弹出一个弹窗，显示相应的信息</p>
<p>点击三角形，或者按F5，就是运行这个VBA代码</p>
<h2 id="多个VBA程序及引用单元格内容"><a href="#多个VBA程序及引用单元格内容" class="headerlink" title="多个VBA程序及引用单元格内容"></a>多个VBA程序及引用单元格内容</h2><p>在同一个模块中，有多个子程序：</p>
<p>MsgBox “B2单元格内容是:”&amp;Range(B2).Value</p>
<p>就是引用了第二个单元格的内容，会出现一个弹窗</p>
<p>上下有两个Sub，也叫子程序，当鼠标点在第一个子程序时，就会运行第一个；鼠标点在第二个子程序时，就会运行第二个子程序。</p>
<p>假如有多个模块，可能在运行的时候，需要手动选择，要运行的是哪一个代码。</p>
<p>运行VBA代码的另一种方法：</p>
<ol>
<li><p>视图-立即窗口，在下面的小窗口中，输入“Call ＋宏的名字”，再按回车，也能运行。</p>
<p>call：调用的意思</p>
</li>
<li><p>开发工具-宏-运行</p>
</li>
</ol>
<h2 id="变量的含义"><a href="#变量的含义" class="headerlink" title="变量的含义"></a>变量的含义</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> 变量名 <span class="keyword">As</span> 数据类型</span><br><span class="line">变量名=变量值（赋值）</span><br><span class="line">MsgBox 变量名（通过窗口展示变量数据）</span><br></pre></td></tr></table></figure>

<p>同样都能存储数值，不同变量类型能存储的数据范围不同，详情看上面的表。一字节8位，可以容纳的大小是2的8次方减1，因为从0开始计算。</p>
<p>整数：比如我们要存储的数据范围在0-255之间，Byte就可以了。<strong>但是我们一般就直接用Integer和Long就可以。</strong></p>
<p>小数：用Double</p>
<p>日期：用Date</p>
<h2 id="不同数据类型的变量"><a href="#不同数据类型的变量" class="headerlink" title="不同数据类型的变量"></a>不同数据类型的变量</h2><p>整数类型：</p>
<p>当定义了一个变量为Integer，先后定义它为100，200，50000，就会弹窗为100，200，溢出，因为Integer最大值只有30000多。</p>
<p>小数类型代码：</p>
<p>把代码注释掉的方法：</p>
<p>选中代码，选择“编辑”，“编辑”块里面有个功能“设置注释块”。</p>
<p>同理，选择“解除注释块”就能取消注释。</p>
<p>日期类型代码：</p>
<p>注意，日期要用两个#包围起来</p>
<p>弹窗显示的日期格式，会是和电脑本身日期显示的格式一样，所以如果只显示了一部分内容，就去调整本机的日期格式。</p>
<p>文本类型代码：</p>
<p>要用英文的双引号</p>
<p>布尔类型变量：</p>
<p>赋值的时候，会有个自动出现的框，让你自己选是true，还是false</p>
<h2 id="多变量声明"><a href="#多变量声明" class="headerlink" title="多变量声明"></a>多变量声明</h2><p>不用每个都Dim，只需要Dim一次，后面加个逗号，新变量lll</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">```vba</span><br><span class="line"><span class="keyword">Sub</span> 多变量声明()</span><br><span class="line">    <span class="keyword">Dim</span> Score <span class="keyword">As</span> <span class="type">Integer</span>, price <span class="keyword">As</span> <span class="type">Double</span>, birthday <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    Score = <span class="number">100</span></span><br><span class="line">    price = <span class="number">9.8</span></span><br><span class="line">    birthday = <span class="literal">#12/8/1998#</span></span><br><span class="line">    </span><br><span class="line">    MsgBox Score</span><br><span class="line">    MsgBox price</span><br><span class="line">    MsgBox birthday</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">```</span><br></pre></td></tr></table></figure>

<h2 id="Variant可变数据类型"><a href="#Variant可变数据类型" class="headerlink" title="Variant可变数据类型"></a>Variant可变数据类型</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 测试variant()</span><br><span class="line">    <span class="keyword">Dim</span> Var</span><br><span class="line">    Var = <span class="number">100</span></span><br><span class="line">    MsgBox Var</span><br><span class="line">    </span><br><span class="line">    Var = <span class="literal">#12/8/1998#</span></span><br><span class="line">    MsgBox Var</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>可以存储整数，也可以存储日期等</p>
<p>可以用，但不推荐，会浪费内存空间</p>
<h2 id="强制变量声明"><a href="#强制变量声明" class="headerlink" title="强制变量声明"></a>强制变量声明</h2><p>Option Explicit</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> OptionTest()</span><br><span class="line">    <span class="keyword">Dim</span> Score <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    Score = <span class="number">100</span></span><br><span class="line">    MsgBox Scor</span><br><span class="line"><span class="comment">&#x27;变量书写错误</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>若是无<code>Option Explicit</code>这一句，那么在输错变量名的时候，只会弹出一个“空”的弹窗，不利于纠错；加上后，就会提示，变量未定义。</p>
<p>若是记不住这行代码，也可以在“工具-选项-编辑器-要求变量声明”，选中“要求变量声明”，即可在新建模块时，自动加上这句代码。</p>
<h2 id="变量的生命周期"><a href="#变量的生命周期" class="headerlink" title="变量的生命周期"></a>变量的生命周期</h2><p>变量，实际上是占用了电脑的内存空间，所以需要有“死”的时机。</p>
<p>变量的生命周期，只存在于这个子程序内；在其他的子程序Sub时，就获取不到这个变量了。</p>
<p>（Sub和End Sub之间，就是一个子程序。）</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Sub</span> Moudle1()</span><br><span class="line">    <span class="keyword">Dim</span> Score <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    Score = <span class="number">100</span></span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Moudle2()</span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="comment">&#x27;会提示“变量未定义”</span></span><br></pre></td></tr></table></figure>

<p>若是想要让一个变量的生命周期，在多个子程序中都能使用：就在开头就定义这个变量</p>
<p>先运行Moudle1()，显示100；再运行Moudle2()，也显示100。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;生命周期的范围只能是当前模块内</span></span><br><span class="line"><span class="keyword">Dim</span> Score <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Moudle1()</span><br><span class="line">    Score = <span class="number">100</span></span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Moudle2()</span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>若是想要让一个变量的生命周期，超过当前模块，即在多个模块中都能使用：就在开头，把Dim改成Public，这样定义这个变量。</p>
<p>如果Moudle1运行过再运行Moudle3，那么Moudle3的结果就是100；如果Moudle1没有运行过再运行Moudle3，那么Moudle3的结果就是0。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;生命周期的范围只能是当前模块内</span></span><br><span class="line"><span class="keyword">Public</span> Score <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Moudle1()</span><br><span class="line">    Score = <span class="number">100</span></span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Moudle2()</span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;=====另一个模块内</span></span><br><span class="line"><span class="keyword">Sub</span> Moudle3()</span><br><span class="line">    MsgBox Score</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="static修饰符"><a href="#static修饰符" class="headerlink" title="static修饰符"></a>static修饰符</h2><p>static表示的意思是，当这个程序运行完毕之后，这个变量占据的内存空间并不会消失，所以第一次执行之后初始值就还是0，结果count为1；第二次执行时count的初始值就是1，结果就是2。</p>
<p>如果用的是Dim，那么每次执行结束，这个变量占据的内存空间就会消失，第二次执行时，count的初始值就还是0，结果还是1。</p>
<p>如果担心占用内存，有两种方法可以解决：<br>方法①：可以单击这个“重新设置”，那么这个程序就彻底结束，即使是static修饰的变量，那么这个内存也会重新释放，再运行就是从初始值0开始；<br>方法②关闭掉该工作簿，因为变量占据的内存空间，实际上是依附于这个工作簿，工作簿关闭后，内存空间肯定会被释放。</p>
<aside>
💡 用static修饰的变量，它的生命周期会超出这个子程序的范围，所以可以用来统计这个程序用了多少次；但是在第二个子程序中仍然无法使用。
    <aside>

<h2 id="常量的使用"><a href="#常量的使用" class="headerlink" title="常量的使用"></a>常量的使用</h2><p>变量：在内存空间中，存储的数据会发生变化；常量：存储的数据不会发生变化。</p>
<p>Option Explicit</p>
<p> ‘如果想要在多个模块中使用这个常量，可以加个public<br>‘Public Const PI As Double &#x3D; 3.1415926</p>
<p> ‘如果想要让这个常量在多个子程序中都能使用，可以把这个常量的声明定义放在这个子程序外面；<br>‘Const PI As Double &#x3D; 3.1415926</p>
<p>Sub constant()<br>    ‘定义常量使用Const而不是Dim<br>    ‘定义常量的时候就要进行赋值<br>    ‘常量不能修改数值<br>    Const PI As Double &#x3D; 3.1415926</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> Price <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">MsgBox Price</span><br><span class="line"><span class="comment">&#x27;变量的话，是有一个初始值0的</span></span><br><span class="line"><span class="comment">&#x27;赋值之后才会有新的值</span></span><br><span class="line">Price = <span class="number">4.5</span></span><br><span class="line">MsgBox Price</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> Area <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"><span class="comment">&#x27;计算半径为2的圆的面积</span></span><br><span class="line">Area = PI * <span class="number">2</span> * <span class="number">2</span></span><br><span class="line">MsgBox <span class="string">&quot;半径为2的圆的面积是：&quot;</span> &amp; Area</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;使用常量的好处在于非常直观</span></span><br><span class="line"><span class="comment">&#x27;常量也有生命周期，在这个子程序中定义了这个常量，在另一个子程序中就无法使用；</span></span><br><span class="line"><span class="comment">&#x27;如果想要让这个常量在多个子程序中都能使用，可以把这个常量的声明定义放在这个子程序外面；</span></span><br><span class="line"><span class="comment">&#x27;如果想要在多个模块中使用这个常量，可以加个public</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&#x27; VBA内置常量</span></span><br><span class="line">    ActiveCell.Interior.Color = vbGreen</span><br><span class="line">    <span class="comment">&#x27;把活动单元格的颜色变成红色</span></span><br><span class="line">    <span class="comment">&#x27;vbRed和vbGreen都是常量</span></span><br><span class="line">    <span class="comment">&#x27;也就是内部有这么一句：Const vbRed As Integer = 255</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="数学运算符"><a href="#数学运算符" class="headerlink" title="数学运算符"></a>数学运算符</h2><p>数学运算符：+加、-减、*乘、&#x2F;除、^幂运算、Mod取余</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> OperationTest()</span><br><span class="line">    <span class="keyword">Dim</span> num1 <span class="keyword">As</span> <span class="type">Integer</span>, num2 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    num1 = <span class="number">10</span></span><br><span class="line">    num2 = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;数学运算符+、-、*、/、^幂运算、Mod取余</span></span><br><span class="line">    <span class="keyword">Dim</span> result1 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    result1 = num1 + num2</span><br><span class="line">    MsgBox result1</span><br><span class="line">    <span class="comment">&#x27;结果为30</span></span><br><span class="line">    </span><br><span class="line">    result1 = num1 / num2</span><br><span class="line">    MsgBox result1</span><br><span class="line">    <span class="comment">&#x27;结果为0,原因是result1是整数类型，就忽略了小数部分</span></span><br><span class="line">    <span class="comment">&#x27;如果把result1设置为double小数类型，就能显示为0.5</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> result2 <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    result2 = num1 ^ num2</span><br><span class="line">    MsgBox result2</span><br><span class="line">    <span class="comment">&#x27;用double的数据类型，结果是1E+20，即10的20次方，其他数据类型会显示溢出</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> result3 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    result3 = num1 <span class="built_in">Mod</span> num2</span><br><span class="line">    <span class="comment">&#x27;10除以20，取余，还是10</span></span><br><span class="line">    MsgBox result3</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><p>用法：主要用于判断，走不同的分支（分支判断）</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> bijiaotest()</span><br><span class="line">    <span class="keyword">Dim</span> num1 <span class="keyword">As</span> <span class="type">Integer</span>, num2 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    num1 = <span class="number">10</span></span><br><span class="line">    num2 = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;比较运算符&gt; &lt; &gt;= &lt;= = &lt;&gt;</span></span><br><span class="line">    <span class="keyword">Dim</span> result <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    result = num1 &gt; num2</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;结果是0，根据布尔值和integer，False就是0，True是1</span></span><br><span class="line">    <span class="comment">&#x27;如果Dim result As Boolean,那么就会显示为False</span></span><br><span class="line">    </span><br><span class="line">    result = num1 &lt; num2</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;结果是-1 / TRUE</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;&gt;=，大于或等于，都能成立</span></span><br><span class="line">    result = num1 &lt;= num2</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;结果是-1 / TRUE</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;=，等于，为了方便区分，可以在判断的式子里面加上括号进行区分</span></span><br><span class="line">    result = (num1 * <span class="number">2</span> = num2)</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;结果是-1 / TRUE</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;&lt;&gt;，不等于</span></span><br><span class="line">    result = num1 &lt;&gt; num2</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;结果是-1 / TRUE</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>补充：为什么在vba中True&#x3D;-1?</p>
<p>当在vba中执行语句  MsgBox -1 &#x3D; True 时，将弹出True。<br>也就是在vba中True&#x3D;-1，这个是为什么呢。</p>
<p>因为Boolean类型的变量以两个字节存储，而值只能是True 或者 False，它表示的是两个相反的状态。</p>
<p>其中0的二进制形式为“0000 0000 0000 0000”，与0相反的二进制形式为“1111 1111 1111 1111”，这个二进制形式刚好是-1在内存中的存储形式，所以用这两种相反的状态来分别表示False 或者 True，这样True&#x3D;-1。</p>
</li>
</ul>
<h2 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> luojiyunsuanfu()</span><br><span class="line">    <span class="keyword">Dim</span> num1 <span class="keyword">As</span> <span class="type">Integer</span>, num2 <span class="keyword">As</span> <span class="type">Integer</span>, num3 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    num1 = <span class="number">2</span></span><br><span class="line">    num2 = <span class="number">10</span></span><br><span class="line">    num3 = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;逻辑运算符And, Not, Or</span></span><br><span class="line">    <span class="comment">&#x27;逻辑运算符主要是针对True和False来运算的</span></span><br><span class="line">    <span class="keyword">Dim</span> result <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;num1 &gt; num2</span></span><br><span class="line">    <span class="comment">&#x27;False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;num1 &gt; num3</span></span><br><span class="line">    <span class="comment">&#x27;False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;num3 &gt; num2</span></span><br><span class="line">    <span class="comment">&#x27;True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;num2 &gt; num1</span></span><br><span class="line">    <span class="comment">&#x27;True</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;And，左右都是True，结果才是True</span></span><br><span class="line">    result = (num2 &gt; num1) <span class="built_in">And</span> (num1 &gt; num3)</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;一个True,一个False，用And，结果是False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Or，左边或右边有一个为True，结果就是True</span></span><br><span class="line">    result = (num2 &gt; num1) <span class="built_in">Or</span> (num1 &gt; num3)</span><br><span class="line">    MsgBox result</span><br><span class="line">    <span class="comment">&#x27;一个True,一个False，用Or，结果是True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Not，Not False = True</span></span><br><span class="line">    result = <span class="built_in">Not</span> ((num2 &gt; num1) <span class="built_in">And</span> (num1 &gt; num3))</span><br><span class="line">    MsgBox result</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>



<h2 id="VBA命名规范"><a href="#VBA命名规范" class="headerlink" title="VBA命名规范"></a>VBA命名规范</h2><h2 id="If选择结构"><a href="#If选择结构" class="headerlink" title="If选择结构"></a>If选择结构</h2><p>有3种if语句判断的结构：1个分支；2个分支；多个分支</p>
<p>多个分支时注意判断的顺序</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Sub</span> IfTest()</span><br><span class="line">    <span class="keyword">Dim</span> score <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    score = <span class="number">95</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">    <span class="comment">&#x27;第一种If语句：一个分支</span></span><br><span class="line">    <span class="comment">&#x27;score &gt;=60,一个判断条件</span></span><br><span class="line">    <span class="comment">&#x27;then，如果符合条件要做什么</span></span><br><span class="line">    <span class="comment">&#x27;If开头，End If结尾</span></span><br><span class="line">    <span class="keyword">If</span> score &gt;= <span class="number">60</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;PASS&quot;</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第二种If语句：两个分支</span></span><br><span class="line">    <span class="comment">&#x27;else表示，如果不满足条件，要做什么</span></span><br><span class="line">    <span class="keyword">If</span> score &gt;= <span class="number">60</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;PASS&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        MsgBox <span class="string">&quot;NO PASS&quot;</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第三种If语句：多个分支</span></span><br><span class="line">    <span class="comment">&#x27;&gt;=90,优秀；&gt;=80,中上；&gt;=70,普通；&gt;=60,及格；&lt;60,不及格</span></span><br><span class="line">    <span class="comment">&#x27;注意判断的顺序，如果先判断是否大于80，再判断是否大于90，就会只显示大于80的结果</span></span><br><span class="line">    <span class="keyword">If</span> score &gt;= <span class="number">90</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;优秀&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> score &gt;= <span class="number">80</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;中上&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> score &gt;= <span class="number">70</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;普通&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> score &gt;= <span class="number">60</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;及格&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        MsgBox <span class="string">&quot;不及格&quot;</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="SelectCase选择结构"><a href="#SelectCase选择结构" class="headerlink" title="SelectCase选择结构"></a>SelectCase选择结构</h2><p>if 的好处是可以灵活设置判断条件；<br>selcet case 就只能对上面设置的变量值做判断</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Sub</span> SelectCaseTest()</span><br><span class="line">    <span class="keyword">Dim</span> score <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    score = <span class="number">7</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Select Case表示基于某个变量的不同情况，进行不同的处理措施</span></span><br><span class="line">    <span class="comment">&#x27;Case Is：表示针对特定的情况进行处理</span></span><br><span class="line">    <span class="comment">&#x27;Case Else：表示如果上方的条件都不满足，该如何处理</span></span><br><span class="line">    <span class="comment">&#x27;只能针对某一个变量进行处理，所以应用场景比if少很多</span></span><br><span class="line">    <span class="keyword">Select</span> <span class="keyword">Case</span> score</span><br><span class="line">        <span class="keyword">Case</span> <span class="built_in">Is</span> &gt;= <span class="number">90</span></span><br><span class="line">            MsgBox <span class="string">&quot;优秀&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="built_in">Is</span> &gt;= <span class="number">80</span></span><br><span class="line">            MsgBox <span class="string">&quot;中上&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="built_in">Is</span> &gt;= <span class="number">70</span></span><br><span class="line">            MsgBox <span class="string">&quot;普通&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="built_in">Is</span> &gt;= <span class="number">60</span></span><br><span class="line">            MsgBox <span class="string">&quot;及格&quot;</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line">            MsgBox <span class="string">&quot;不及格&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="For-Next循环结构"><a href="#For-Next循环结构" class="headerlink" title="For-Next循环结构"></a>For-Next循环结构</h2><h2 id="For-Next循环结构-1"><a href="#For-Next循环结构-1" class="headerlink" title="For-Next循环结构"></a>For-Next循环结构</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ForNextTest()</span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;用法一：连续展示某个信息5次</span></span><br><span class="line">    <span class="comment">&#x27;num=1表示先设置num变量的值为1，只有在第一次的时候才会进行赋值，后面只会判断是否超出条件(&gt;5)</span></span><br><span class="line">    <span class="comment">&#x27;to 5 表示，当num &gt; 5 的时候，循环停止</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">5</span></span><br><span class="line">        MsgBox num &amp; <span class="string">&quot;：循环结构&quot;</span></span><br><span class="line">        <span class="comment">&#x27;next num表示每次循环num的值加1</span></span><br><span class="line">        <span class="comment">&#x27;num = num + 1</span></span><br><span class="line">        <span class="keyword">Next</span> num</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">&#x27;第一次循环，Num＝1；弹出窗口，显示：1:循环结构；Num＝2</span></span><br><span class="line"><span class="comment">&#x27;第二次循环，Num＝2；弹出窗口，显示：2:循环结构；Num＝3</span></span><br><span class="line"><span class="comment">&#x27;第三次循环，Num＝3；弹出窗口，显示：3:循环结构；Num＝4</span></span><br><span class="line"><span class="comment">&#x27;第四次循环，Num＝4；弹出窗口，显示：4:循环结构；Num＝5</span></span><br><span class="line"><span class="comment">&#x27;第五次循环，Num＝5；弹出窗口，显示：5:循环结构；Num＝6；6 &gt; 5，循环结束</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;用法二：计算1~100的求和结果</span></span><br><span class="line">    <span class="comment">&#x27;如果求和结果过大，可以把total改成long</span></span><br><span class="line">    <span class="keyword">Dim</span> total <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">        <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span></span><br><span class="line">            total = total + num</span><br><span class="line">            <span class="keyword">Next</span> num</span><br><span class="line">            MsgBox total</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Step的应用场景"><a href="#Step的应用场景" class="headerlink" title="Step的应用场景"></a>Step的应用场景</h2><p>控制变量在每次循环的时候，加多少的值，不加默认加1</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Sub</span> StepTest()</span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span>, total <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;计算1~100里面的奇数求和结果</span></span><br><span class="line">    <span class="comment">&#x27;1+3+5+7+……+99</span></span><br><span class="line">    <span class="comment">&#x27;step 2 ，就是每次next num，每次加2的意思</span></span><br><span class="line">    <span class="comment">&#x27;不写step 2 ，就是默认每次＋1</span></span><br><span class="line">    <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">100</span> <span class="keyword">Step</span> <span class="number">2</span></span><br><span class="line">        total = total + num</span><br><span class="line">        <span class="keyword">Next</span> num</span><br><span class="line">    </span><br><span class="line">    MsgBox total</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="如何中断For循环"><a href="#如何中断For循环" class="headerlink" title="如何中断For循环"></a>如何中断For循环</h2><p>Exit For：这句话作用就是满足条件时退出for循环，一般搭配 If 来用</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Sub</span> StepTest()</span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span>, total <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;让For循环中途退出</span></span><br><span class="line">    <span class="comment">&#x27;计算1~50相加的结果，但是前面还是写的1到100</span></span><br><span class="line">    <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">100</span></span><br><span class="line">        <span class="keyword">If</span> num &gt; <span class="number">50</span> <span class="keyword">Then</span></span><br><span class="line">            <span class="comment">&#x27;Exit For：这句话作用就是满足条件时退出for循环，一般搭配if来用</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        total = total + num</span><br><span class="line">        <span class="keyword">Next</span> num</span><br><span class="line">    </span><br><span class="line">    MsgBox num</span><br><span class="line">    MsgBox total</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="嵌套for循环"><a href="#嵌套for循环" class="headerlink" title="嵌套for循环"></a>嵌套for循环</h2><p>大循环执行一次，小循环可能执行好几次</p>
<p>不建议嵌套3次for循环，一般只嵌套两次for循环</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ForForNextTest()</span><br><span class="line">    <span class="keyword">Dim</span> num1 <span class="keyword">As</span> <span class="type">Integer</span>, num2 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> total <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">For</span> num1 = <span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span></span><br><span class="line">        <span class="keyword">For</span> num2 = <span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span></span><br><span class="line">            total = total + num1 * num2</span><br><span class="line">        <span class="keyword">Next</span> num2</span><br><span class="line">    <span class="keyword">Next</span> num1</span><br><span class="line"></span><br><span class="line">MsgBox total</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="DoUntil循环结构"><a href="#DoUntil循环结构" class="headerlink" title="DoUntil循环结构"></a>DoUntil循环结构</h2><p>满足条件，中断循环</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DoUntilTest()</span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;num &gt; 10，如果满足条件，则中断循环</span></span><br><span class="line">    <span class="comment">&#x27;执行10次</span></span><br><span class="line"><span class="comment">&#x27;    Do Until num &gt; 10</span></span><br><span class="line"><span class="comment">&#x27;        MsgBox num &amp; &quot;：循环结构&quot;</span></span><br><span class="line"><span class="comment">&#x27;        num = num + 1</span></span><br><span class="line"><span class="comment">&#x27;    Loop</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> total <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;计算1~100的数据相加的结果</span></span><br><span class="line">    <span class="keyword">Do</span> <span class="keyword">Until</span> num &gt; <span class="number">100</span></span><br><span class="line">        total = total + num</span><br><span class="line">        num = num + <span class="number">1</span></span><br><span class="line">    <span class="keyword">Loop</span></span><br><span class="line"></span><br><span class="line">    MsgBox total</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="编写无参数子过程"><a href="#编写无参数子过程" class="headerlink" title="编写无参数子过程"></a>编写无参数子过程</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;无参数子过程，就是指“Sub SubTest()”，括号里面没有任何的参数的子过程</span></span><br><span class="line"><span class="comment">&#x27;无参数子过程，可以把固定功能的代码放在一个子程序中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;子过程（子函数、子程序）</span></span><br><span class="line"><span class="keyword">Sub</span> SubTest()</span><br><span class="line">    <span class="comment">&#x27;包裹了一系列的指令代码，</span></span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span>, total <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">10</span></span><br><span class="line">        total = total + num</span><br><span class="line">        <span class="keyword">Next</span> num</span><br><span class="line">      </span><br><span class="line">    MsgBox total</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    <span class="comment">&#x27;表示中断这个子程序的执行</span></span><br><span class="line">    <span class="comment">&#x27;后面的代码不会再执行了</span></span><br><span class="line">  </span><br><span class="line">    MsgBox total</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;比如我们想写另一个功能代码，就可以再写一个子程序，</span></span><br><span class="line"><span class="comment">&#x27;通过子程序/子过程，可以把不同的功能分开</span></span><br><span class="line"><span class="comment">&#x27;而在执行的时候，可以单击这个子程序(就是鼠标点在这个子程序里面)，就可以了</span></span><br></pre></td></tr></table></figure>

<h2 id="有参数子过程的编写和调用"><a href="#有参数子过程的编写和调用" class="headerlink" title="有参数子过程的编写和调用"></a>有参数子过程的编写和调用</h2><h3 id="一个参数"><a href="#一个参数" class="headerlink" title="一个参数"></a>一个参数</h3><p>上面的代码，<code>For num = 1 To 10</code>，若是想要这个10变成一个可变的数字，可以在<code>Sub SubTest()</code>的括号里，声明一个参数，这个参数就是变量。所以可以改成<code>Sub SubTest(ToNum As Integer)</code>，此时就可以把下面的改成<code>For num = 1 To ToNum</code>，这时就获得了一个有参数的子过程，也就可以调用这个子过程，并且传入一个参数，那执行的时候，传入的值就会替换掉<code>ToNum</code>。</p>
<p>如何调用这种有参数的子过程？——可以再去写一个子过程<code>Sub Test()</code>（无参数），来进行调用。</p>
<p>可以多次计算，1到10,1到100,1到1000，的结果。</p>
<p>这样就无需修改第一部分<code>Sub SubTest(ToNum As Integer)</code>的代码，因为有时含有参数的子程序会非常长，若是每次都要去代码内部修改，很有可能会出错（误删代码or修改错误），风险较高；所以我们就把固定功能的代码，保持不动，只需要把参数进行调整、传入进去。</p>
<p>如果传入的是10，那么程序在执行第一部分的子程序时，<code>ToNum</code>就接收了10这个值，执行时它就是10；100和1000同理。</p>
<p>如果传入的是10，那么程序在执行第一部分的子程序时，<code>ToNum</code>就接收了10这个值，执行时它就是10；100和1000同理。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> SubTest(ToNum <span class="keyword">As</span> <span class="type">Integer</span>)</span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span>, total <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> ToNum</span><br><span class="line">        total = total + num</span><br><span class="line">        <span class="keyword">Next</span> num</span><br><span class="line">      </span><br><span class="line">    MsgBox total   </span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    MsgBox total</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Test()</span><br><span class="line">    SubTest (<span class="number">10</span>)</span><br><span class="line">    SubTest (<span class="number">100</span>)</span><br><span class="line">    SubTest (<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>有参数的子过程，什么时候去使用？</p>
<p>当我们写了某一个功能后，可能针对其中的内容会经常进行调整，这时可以把它设置成一个变量，把这个变量作为一个参数放到前面的<code>sub()</code>的括号中。</p>
<p>如果有不止一个参数呢？——在前面的<code>sub()</code>的括号中，用逗号进行分隔……</p>
<h3 id="多个参数"><a href="#多个参数" class="headerlink" title="多个参数"></a>多个参数</h3><p>用逗号进行分隔</p>
<p>比如可以更改每次增长的数值为变量<code>AddStep</code>，在调用这种有多个参数的子过程的时候，注意：若有多个参数，就不再用左右的括号，改用英文逗号。第一个参数的值表示<code>ToNum</code>的值，第二个参数表示 <code>AddStep</code>的值</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> SubTest(ToNum <span class="keyword">As</span> <span class="type">Integer</span>, AddStep <span class="keyword">As</span> <span class="type">Integer</span>)</span><br><span class="line">    <span class="keyword">Dim</span> num <span class="keyword">As</span> <span class="type">Integer</span>, total <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> num = <span class="number">1</span> <span class="keyword">To</span> ToNum <span class="keyword">Step</span> AddStep</span><br><span class="line">        total = total + num</span><br><span class="line">        <span class="keyword">Next</span> num</span><br><span class="line">      </span><br><span class="line">    MsgBox total</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line">    MsgBox total</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Test()</span><br><span class="line">    <span class="comment">&#x27;SubTest (10)</span></span><br><span class="line">    SubTest <span class="number">100</span>, <span class="number">2</span></span><br><span class="line">    SubTest <span class="number">1000</span>, <span class="number">2</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>子程序的调用？</p>
<p>无参数的子程序调用方法：</p>
<ol>
<li>在编写程序的界面，直接单击运行；</li>
<li>在“开发工具”-“宏”，选择对应的宏程序，单击运行；</li>
<li>设置快捷键运行；</li>
<li>添加表单，即一个按钮来运行；</li>
<li>快速访问工具栏；</li>
<li>在编写程序的界面，“立即窗口”。</li>
<li>单独再去写一个（无参数）子程序，去调用无参数的子程序；</li>
</ol>
<p>有参数的子程序调用方法：</p>
<ol>
<li>单独再去写一个（无参数）子程序，去调用有参数的子程序；</li>
</ol>
<p>宏录制？</p>
<p>宏录制时编写的程序，都属于无参数的子程序；有参数的子程序，必须手动编写，无法录制宏。</p>
<h2 id="编写自定义函数：Function表示函数过程"><a href="#编写自定义函数：Function表示函数过程" class="headerlink" title="编写自定义函数：Function表示函数过程"></a>编写自定义函数：Function表示函数过程</h2><p>函数和子过程的区别——函数过程有返回值，子过程没有返回值。</p>
<p>function过程类似于Excel内置的工作表函数，主要有2个用途：①口 在工作表公式中使用，弥补 Excel 内置西数无法实现的计算功能，简化公式的复杂度。②在VBA 中被其他过程调用，或者作为表达式的一部分参与运算。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;Function表示函数过程，而不是子过程</span></span><br><span class="line"><span class="comment">&#x27;这里的功能是计算两个数的立方值的和，返回给CubeSum</span></span><br><span class="line"><span class="keyword">Function</span> CubeSum(x <span class="keyword">As</span> <span class="type">Double</span>, y <span class="keyword">As</span> <span class="type">Double</span>)</span><br><span class="line">    CubeSum = x * x * x + y * y * y</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Test()</span><br><span class="line"><span class="comment">&#x27;方法一：赋值给一个新变量</span></span><br><span class="line">    <span class="keyword">Dim</span> value <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    value = CubeSum(<span class="number">1.5</span>, <span class="number">2.5</span>)</span><br><span class="line">    MsgBox value</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;方法二：不用定义新变量，直接弹窗出结果</span></span><br><span class="line">    MsgBox CubeSum(<span class="number">1.5</span>, <span class="number">2.5</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;对三个值进行求和</span></span><br><span class="line"><span class="keyword">Function</span> MySum(x <span class="keyword">As</span> <span class="type">Integer</span>, y <span class="keyword">As</span> <span class="type">Integer</span>, z <span class="keyword">As</span> <span class="type">Integer</span>)</span><br><span class="line">    MySum = x + y + z</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<p>上面我们自定义的函数，如何在Excel中使用？</p>
<ol>
<li>在单元格内输入<code>=CubeSum(A1,A2)</code>，就可以求出 A1单元格值的立方＋A2单元格值的立方的和。</li>
<li>“插入函数”-“选择分类”-“用户定义”-“确定”，就可以去自定义设定函数的参数了，再单击“确定”。</li>
</ol>
<p>还可以设置返回值的类型</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> CubeSum(x <span class="keyword">As</span> <span class="type">Double</span>, y <span class="keyword">As</span> <span class="type">Double</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    CubeSum = x * x * x + y * y * y</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"><span class="comment">&#x27;这里是让返回值的数据类型是Double</span></span><br></pre></td></tr></table></figure>

<h2 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ArrayTest()</span><br><span class="line">    <span class="comment">&#x27;声明定义一维数组</span></span><br><span class="line">    <span class="keyword">Dim</span> MyArray(<span class="number">0</span> <span class="keyword">To</span> <span class="number">2</span>) <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;为一维数组赋值</span></span><br><span class="line">    MyArray(<span class="number">0</span>) = <span class="number">0</span></span><br><span class="line">    MyArray(<span class="number">1</span>) = <span class="number">100</span></span><br><span class="line">    MyArray(<span class="number">2</span>) = <span class="number">200</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;访问某一个模块中的数据</span></span><br><span class="line">    MsgBox MyArray(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;遍历方式访问一维数组</span></span><br><span class="line">    <span class="keyword">Dim</span> index <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> index = <span class="number">0</span> <span class="keyword">To</span> <span class="number">2</span></span><br><span class="line">        MsgBox MyArray(index)</span><br><span class="line">        <span class="keyword">Next</span> index</span><br><span class="line">        </span><br><span class="line">    <span class="comment">&#x27;LBound表示数组的最小的角标</span></span><br><span class="line">    <span class="comment">&#x27;UBound表示数组的最大的角标</span></span><br><span class="line">    <span class="comment">&#x27;lower,upper</span></span><br><span class="line">    <span class="comment">&#x27;这种方法的优点在于，如果后期数组增级了个数，那么遍历数组的时候，就不需要修改循环的条件了</span></span><br><span class="line">    <span class="keyword">For</span> index = LBound(MyArray) <span class="keyword">To</span> UBound(MyArray)</span><br><span class="line">        MsgBox MyArray(index)</span><br><span class="line">        <span class="keyword">Next</span> index</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Option-Base"><a href="#Option-Base" class="headerlink" title="Option Base"></a>Option Base</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> Base <span class="number">1</span></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ArrayTest2()</span><br><span class="line">    <span class="comment">&#x27;声明定义一维数组</span></span><br><span class="line">    <span class="comment">&#x27;若没有指定最小的角标，就默认最小角标为0;我们设置的数字，就是最大的角标</span></span><br><span class="line">    <span class="comment">&#x27;Dim MyArray(3) As Integer就相当于Dim MyArray(0,3) As Integer</span></span><br><span class="line">    <span class="comment">&#x27;========</span></span><br><span class="line">    <span class="comment">&#x27;如果加上了Option Base 1，就表示Dim MyArray(3) As Integer是从1开始，相当于Dim MyArray(1,3) As Integer</span></span><br><span class="line">    <span class="comment">&#x27;这时那么如果有MyArray(0) = 100在，就会报错“下标越界”，必须删去or注释掉这一行</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> MyArray(<span class="number">3</span>) <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;MyArray(0) = 100</span></span><br><span class="line">    MyArray(<span class="number">1</span>) = <span class="number">200</span></span><br><span class="line">    MyArray(<span class="number">2</span>) = <span class="number">300</span></span><br><span class="line">    MyArray(<span class="number">3</span>) = <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> index <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> index = LBound(MyArray) <span class="keyword">To</span> UBound(MyArray)</span><br><span class="line">        MsgBox MyArray(index)</span><br><span class="line">        <span class="keyword">Next</span> index</span><br><span class="line">               </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ArrayTest()</span><br><span class="line">    <span class="comment">&#x27;定义二维数组</span></span><br><span class="line">    <span class="comment">&#x27;前面是行数，后面是列数</span></span><br><span class="line">    <span class="keyword">Dim</span> MyArray(<span class="number">1</span> <span class="keyword">To</span> <span class="number">2</span>, <span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span>) <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;为二维数组赋值</span></span><br><span class="line">    MyArray(<span class="number">1</span>, <span class="number">1</span>) = <span class="number">100</span></span><br><span class="line">    MyArray(<span class="number">1</span>, <span class="number">2</span>) = <span class="number">200</span></span><br><span class="line">    MyArray(<span class="number">1</span>, <span class="number">3</span>) = <span class="number">300</span></span><br><span class="line">    MyArray(<span class="number">2</span>, <span class="number">1</span>) = <span class="number">400</span></span><br><span class="line">    MyArray(<span class="number">2</span>, <span class="number">2</span>) = <span class="number">500</span></span><br><span class="line">    MyArray(<span class="number">2</span>, <span class="number">3</span>) = <span class="number">600</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;访问二维数组中某一个空间中的数据</span></span><br><span class="line">    MsgBox MyArray(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">		<span class="comment">&#x27;遍历二维数组中的数据，方法：大循环嵌套小循环</span></span><br><span class="line">    <span class="keyword">Dim</span> rowno <span class="keyword">As</span> <span class="type">Integer</span>, cono <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> rowno = <span class="number">1</span> <span class="keyword">To</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">For</span> cono = <span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span></span><br><span class="line">            MsgBox MyArray(rowno, cono)</span><br><span class="line">            <span class="keyword">Next</span> cono</span><br><span class="line">        <span class="keyword">Next</span> rowno</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;LBound(MyArray, 1):行的最小角标</span></span><br><span class="line">    <span class="comment">&#x27;UBound(MyArray, 1):行的最大角标</span></span><br><span class="line">    <span class="comment">&#x27;这里的1和2，与角标从几开始没关系（所以如果角标是从0开始，这里也还是1和2）</span></span><br><span class="line">    <span class="keyword">Dim</span> rowno <span class="keyword">As</span> <span class="type">Integer</span>, cono <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> rowno = LBound(MyArray, <span class="number">1</span>) <span class="keyword">To</span> UBound(MyArray, <span class="number">1</span>)</span><br><span class="line">        <span class="comment">&#x27;LBound(MyArray, 2):列的最小角标</span></span><br><span class="line">        <span class="comment">&#x27;UBound(MyArray, 2):列的最大角标</span></span><br><span class="line">        <span class="keyword">For</span> cono = LBound(MyArray, <span class="number">2</span>) <span class="keyword">To</span> UBound(MyArray, <span class="number">2</span>)</span><br><span class="line">            MsgBox MyArray(rowno, cono)</span><br><span class="line">            <span class="keyword">Next</span> cono</span><br><span class="line">        <span class="keyword">Next</span> rowno</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="动态数组"><a href="#动态数组" class="headerlink" title="动态数组"></a>动态数组</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> MyDynArray()</span><br><span class="line">    <span class="comment">&#x27;定义一个一维动态数组，括号空的</span></span><br><span class="line">    <span class="keyword">Dim</span> MyDynArray() <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;redim:明确动态数组的最小角标和最大角标</span></span><br><span class="line">    <span class="keyword">ReDim</span> MyDynArray(<span class="number">1</span> <span class="keyword">To</span> <span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;为一维动态数组进行赋值</span></span><br><span class="line">    MyDynArray(<span class="number">1</span>) = <span class="number">100</span></span><br><span class="line">    MyDynArray(<span class="number">2</span>) = <span class="number">200</span></span><br><span class="line">    MyDynArray(<span class="number">3</span>) = <span class="number">300</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;for循环，遍历数组</span></span><br><span class="line">    <span class="keyword">Dim</span> index <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&#x27;    For index = LBound(MyDynArray) To UBound(MyDynArray)</span></span><br><span class="line"><span class="comment">&#x27;        MsgBox MyDynArray(index)</span></span><br><span class="line"><span class="comment">&#x27;        Next index</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;可以通过redim多次调整角标</span></span><br><span class="line">    <span class="comment">&#x27;又一次使用了redim，对这个数组的角标进行了调整，调整成了1-4;</span></span><br><span class="line">    <span class="comment">&#x27;注意！！！redim调整动态数组的时候，之前的赋值都会自动抹除，即为0</span></span><br><span class="line">    <span class="comment">&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">ReDim</span> MyDynArray(<span class="number">1</span> <span class="keyword">To</span> <span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果需要保留之前的赋值，就在redim后面加一个Preserve</span></span><br><span class="line">    <span class="comment">&#x27;加一个Preserve，就可以保留历史的赋值数据</span></span><br><span class="line">    <span class="comment">&#x27;如果要运行查看效果，需要将上面未加preserve的代码注释掉</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">ReDim</span> <span class="keyword">Preserve</span> MyDynArray(<span class="number">1</span> <span class="keyword">To</span> <span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果只对4位置进行赋值400，那么位置1-3的值就会是0</span></span><br><span class="line">    MyDynArray(<span class="number">4</span>) = <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> index = LBound(MyDynArray) <span class="keyword">To</span> UBound(MyDynArray)</span><br><span class="line">        MsgBox MyDynArray(index)</span><br><span class="line">        <span class="keyword">Next</span> index</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h1 id="【Chapter-3】面向对象和三"><a href="#【Chapter-3】面向对象和三" class="headerlink" title="【Chapter 3】面向对象和三"></a>【Chapter 3】面向对象和三</h1><h2 id="理解面向对象（入门）"><a href="#理解面向对象（入门）" class="headerlink" title="理解面向对象（入门）"></a>理解面向对象（入门）</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ObjectTest()</span><br><span class="line">    <span class="comment">&#x27;内容</span></span><br><span class="line">    <span class="comment">&#x27;设置A1单元格的数值</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A1&quot;):表示的就是A1单元格（就是一个对象，这个对象有相关的一些属性，比如Value）</span></span><br><span class="line">    <span class="comment">&#x27;Value就是A1单元格的值</span></span><br><span class="line">    <span class="comment">&#x27;可以理解成Value就是一个变量，下面就是给这个变量赋值，只不过这个变量归属于A1单元格</span></span><br><span class="line">    <span class="comment">&#x27;通过设置Range对象属性的值，从而设置了A1单元格的内容</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Value = <span class="number">200</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;展示A1单元格的值</span></span><br><span class="line">    <span class="comment">&#x27;展示时可以把上面的代码注释掉</span></span><br><span class="line">    MsgBox Range(<span class="string">&quot;A1&quot;</span>).Value</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;方法</span></span><br><span class="line">    <span class="comment">&#x27;运行时可以把上面的代码注释掉</span></span><br><span class="line">    <span class="comment">&#x27;选中+清除内容</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).<span class="keyword">Select</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Clear</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>对象，包含属性和方法；<br>属性：对于这个对象的描述信息；<br>方法：可以对这个对象做什么</p>
<p>但是实际上我们很少进行区分，可以这么理解：对于属性来说，可以理解为一个变量，但是实际情况可能会复杂一些，比如Font和Interior实际上还是一个对象，也就是说对象可以包含对象；而Font对象又有一些其他的属性和方法来进行操作。</p>
<p>Range对象，单元格区域（不止一个单元格）</p>
<p><strong>属性：</strong></p>
<ol>
<li>Value——单元格区域内的<strong>值</strong></li>
<li>Count——单元格区域内，有<strong>多少个单元格</strong></li>
<li>Font——单元格区域内，对<strong>字体</strong>进行设置</li>
<li>Interior——单元格区域内，对<strong>填充颜色</strong>进行设置</li>
</ol>
<p><strong>方法：</strong></p>
<ol>
<li>Select——通过代码，选中指定的单元格区域</li>
<li>Copy、Paste——把指定区域的内容，复制粘贴到另一块地方</li>
<li>Clear——把指定区域的内容清除掉</li>
<li>Delete——把区域单元格内容删除掉</li>
</ol>
<p><strong>clear和delete的区别：</strong></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.delete"><code>Range.Delete</code></a>实际上删除了相应的范围并相应地移动&#x2F;移动了单元格，从而改变了工作表的结构。如果您选择单元格，然后单击鼠标右键以删除所选内容，则情况相同。系统会询问您希望如何移动单元格。</p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clear"><code>Range.Clear</code></a>将仅清除内容和格式，但不会删除单元格，也不会更改工作表的结构。</p>
<p>还有仅清除内容但保留格式的<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearcontents"><code>Range.ClearContents</code></a>、仅清除单元格格式的<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearformats"><code>Range.ClearFormats</code></a>以及<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearcomments"><code>Range.ClearComments</code></a>、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearhyperlinks"><code>Range.ClearHyperlinks</code></a>、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearnotes"><code>Range.ClearNotes</code></a>和<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.clearoutline"><code>Range.ClearOutline</code></a></p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ObjectTest()</span><br><span class="line">		<span class="comment">&#x27;选中</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).<span class="keyword">Select</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&#x27;仅清除内容和格式，但不会删除单元格，也不会更改工作表的结构。</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Clear</span><br><span class="line"></span><br><span class="line">		<span class="comment">&#x27;清除内容和格式，同时删除单元格</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Delete</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="对象层级框架"><a href="#对象层级框架" class="headerlink" title="对象层级框架"></a>对象层级框架</h2><p>万物即对象（橙色的对象更常用）</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ObjectHierarchy()</span><br><span class="line">    <span class="comment">&#x27;对象层次访问</span></span><br><span class="line">    Application.Workbooks(<span class="string">&quot;练习VBA用.xlsm&quot;</span>).Worksheets(<span class="string">&quot;Sheet1&quot;</span>).Range(<span class="string">&quot;A1&quot;</span>).Value = <span class="number">1000</span></span><br><span class="line">    <span class="comment">&#x27;执行后，对应单元格就会有1000的值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;上面的写法较为繁琐</span></span><br><span class="line">    <span class="comment">&#x27;</span></span><br><span class="line">    <span class="comment">&#x27;简略写法</span></span><br><span class="line">    <span class="comment">&#x27;可以省略Application：因为我们现在正在Excel的环境中进行编程；如果上面的代码只省略Application，也是可以正常运行的</span></span><br><span class="line">    <span class="comment">&#x27;可以省略Workbooks：因为我们当前就是对这个工作簿进行操作的</span></span><br><span class="line">    <span class="comment">&#x27;可以省略Worksheets：因为当前活动的工作表就是sheet1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;省略哪个就认为这个内容是活动的，比如工作簿和工作表</span></span><br><span class="line">    <span class="comment">&#x27;</span></span><br><span class="line">    <span class="comment">&#x27;如果切换了工作簿/工作表，就默认在当期的工作簿/工作表中运行</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;如果要指定工作簿/工作表，就不能忽略</span></span><br><span class="line"></span><br><span class="line">    Range(<span class="string">&quot;A2&quot;</span>).Value = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;Workbooks和Worksheets，都有s，万物皆对象，表示有多张工作簿/工作表，是集合对象；</span></span><br><span class="line">    <span class="comment">&#x27;类似数组，可以把多个变量统一进行管理</span></span><br><span class="line">    <span class="comment">&#x27;集合同理，把多个工作簿/工作表统一进行管理，是对象，就有属性和方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;属性</span></span><br><span class="line">    Range(<span class="string">&quot;C2&quot;</span>).Value = <span class="number">999</span></span><br><span class="line">    <span class="comment">&#x27;方法</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Clear</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;集合也是对象，也有属性和方法</span></span><br><span class="line">    <span class="comment">&#x27;属性:显示sheet1的名字</span></span><br><span class="line">    MsgBox Worksheets(<span class="string">&quot;Sheet1&quot;</span>).Name</span><br><span class="line">    <span class="comment">&#x27;方法：新增一个工作表</span></span><br><span class="line">    Worksheets.Add</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="单元格引用"><a href="#单元格引用" class="headerlink" title="单元格引用"></a>单元格引用</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> CeilRefTest()</span><br><span class="line">    <span class="comment">&#x27;单元格引用</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用某个单元格</span></span><br><span class="line">    <span class="comment">&#x27;如果没有加“.Value”，也可以对它进行赋值；</span></span><br><span class="line">    <span class="comment">&#x27;说明“.Value”是它默认的属性，不加上实际上也就是加了“.Value”，可以对这个单元格进行赋值</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Value = <span class="number">100</span></span><br><span class="line">    Range(<span class="string">&quot;A2&quot;</span>) = <span class="number">500</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用多个单元格</span></span><br><span class="line">    <span class="comment">&#x27;同时引用了这3个单元格，并进行了数据的传输：赋值</span></span><br><span class="line">    Range(<span class="string">&quot;A3,C3,E3&quot;</span>).Value = <span class="number">666</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用某个单元格区域（连续）</span></span><br><span class="line">    Range(<span class="string">&quot;A5:C8&quot;</span>).Value = <span class="number">456</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用某些单元格区域（不连续）</span></span><br><span class="line">    Range(<span class="string">&quot;A10:C11,E12:G14&quot;</span>).Value = <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用单元格区域，带有名称的</span></span><br><span class="line">    <span class="comment">&#x27;先选中一个区域，然后在显示位置如“C18”的地方，输入一个名称，如“TEST123”，即可完成对某个单元格区域的名称</span></span><br><span class="line">    Range(<span class="string">&quot;TEST123&quot;</span>).Value = <span class="number">999</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;---------------分割线------------------</span></span><br><span class="line">    <span class="comment">&#x27;---------------分割线------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;行和列的引用</span></span><br><span class="line"></span><br><span class="line">    Range(<span class="string">&quot;26:26&quot;</span>).Value = <span class="number">600</span> <span class="comment">&#x27;整个26行赋值600</span></span><br><span class="line">    Range(<span class="string">&quot;J:J&quot;</span>).Value = <span class="number">800</span> <span class="comment">&#x27;整个J列赋值800</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用多行(不相连的行)</span></span><br><span class="line">    Range(<span class="string">&quot;27:27,29:29,33:33&quot;</span>).Value = <span class="number">900</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用多列(不相连的列)</span></span><br><span class="line">    Range(<span class="string">&quot;L:L,G:G,P:P&quot;</span>).Value = <span class="number">35</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用多行(相连的行)</span></span><br><span class="line">    Range(<span class="string">&quot;32:35&quot;</span>).Value = <span class="number">77</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用多列(相连的列)</span></span><br><span class="line">    Range(<span class="string">&quot;F:H&quot;</span>).Value = <span class="number">35</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用多行(相连的行)</span></span><br><span class="line">    Rows(<span class="string">&quot;41:43&quot;</span>) = <span class="number">123</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用多列(相连的列)</span></span><br><span class="line">    Columns(<span class="string">&quot;A:C&quot;</span>).Value = <span class="number">555</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Cells和Offset属性"><a href="#Cells和Offset属性" class="headerlink" title="Cells和Offset属性"></a>Cells和Offset属性</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> CellRefTest()</span><br><span class="line">    <span class="comment">&#x27;Cells属性</span></span><br><span class="line">    <span class="comment">&#x27;可以通过数字来决定我们访问的是哪个单元格，可以结合变量相关知识，灵活引用单元格</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用工作表中的某个单元格</span></span><br><span class="line">    <span class="comment">&#x27;Cells(5, 2):表示第五行，第二列，列用数字表示而不是字母</span></span><br><span class="line">    Worksheets(<span class="string">&quot;Sheet2&quot;</span>).Cells(<span class="number">5</span>, <span class="number">2</span>) = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用单元格区域</span></span><br><span class="line">    <span class="comment">&#x27;Range(,)，里面加上左上角的单元格位置，和右下角的单元格位置</span></span><br><span class="line">    Range(Cells(<span class="number">8</span>, <span class="number">2</span>), Cells(<span class="number">13</span>, <span class="number">5</span>)) = <span class="number">200</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;右上角和左下角的也可以</span></span><br><span class="line">    Range(Cells(<span class="number">18</span>, <span class="number">5</span>), Cells(<span class="number">25</span>, <span class="number">2</span>)) = <span class="number">300</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;引用单元格区域中的某个单元格</span></span><br><span class="line">    <span class="comment">&#x27;Cells(3, 2)表示的是&quot;B8,E13&quot;这个区域中的第3行第2列，给它赋值400</span></span><br><span class="line">    Range(<span class="string">&quot;B8,E13&quot;</span>).Cells(<span class="number">3</span>, <span class="number">2</span>) = <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;Offset属性</span></span><br><span class="line">    <span class="comment">&#x27;宏录制，相对引用的时候遇到过</span></span><br><span class="line">    <span class="comment">&#x27;offset可以控制选择的单元格的“偏移量”,移动了多少位置</span></span><br><span class="line">    <span class="comment">&#x27;往右和往下是正数，往左往上是负数</span></span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;B15&quot;</span>).Offset(<span class="number">3</span>, <span class="number">2</span>).Value = <span class="number">500</span></span><br><span class="line">    Range(<span class="string">&quot;H15&quot;</span>).Offset(-<span class="number">3</span>, -<span class="number">2</span>).Value = <span class="number">500</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Select和Activate方法"><a href="#Select和Activate方法" class="headerlink" title="Select和Activate方法"></a>Select和Activate方法</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> CellRefTest()</span><br><span class="line">    <span class="comment">&#x27;Range</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;G9&quot;).Select   &#x27;选中了G9这个单元格</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;G10:I15&quot;).Select  &#x27;选中了G10到I15这个区域的单元格</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Activate</span></span><br><span class="line">    <span class="comment">&#x27;按Tab键可以在输入.之后，输入几个字母，不用全部输完，快速选中你想要的那个；enter会换行，Tab不会</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;G9&quot;).Activate</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Range(&quot;G10:I15&quot;).Activate</span></span><br><span class="line">    <span class="comment">&#x27;好像是只选中了G9这个单元格，和G10到I15这个区域；好像和select一样</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Select和Activate的区别：</span></span><br><span class="line">    <span class="comment">&#x27;活动单元格，就是选中了很多个单元格之后，这些单元格会变成灰色；活动单元格就是其中白色的那个</span></span><br><span class="line">    <span class="comment">&#x27;某个区域的活动单元格，可以用Tab, enter, shift + tab, shift + enter进行上下左右的移动</span></span><br><span class="line">    <span class="comment">&#x27;下面的代码运行后，就是先选中了G9:J14的这个区域，然后将H10作为了活动单元格</span></span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;G9:J14&quot;</span>).<span class="keyword">Select</span></span><br><span class="line">    Range(<span class="string">&quot;H10&quot;</span>).Activate</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用选择的单元格/单元格区域</span></span><br><span class="line">    Selection.Value = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;引用选择的单元格</span></span><br><span class="line">    ActiveCell.Value = <span class="number">200</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;就是把上面选中的单元格区域，赋值为100；除了活动单元格H10，这个赋值为200</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;可以通过在上方工具栏右击出现想“调试”，点击“逐语句”，再点击“逐过程”（或者快捷键shift + F8），查看代码按每一句执行的过程，观察每一行代码到底产生了什么影响</span></span><br><span class="line">    <span class="comment">&#x27;这里的代码就是：先选中G9:J14这个区域，再选中了H10这个活动单元格；</span></span><br><span class="line">    <span class="comment">&#x27;然后把G9:J14这个区域里面每个单元格（包括H10）赋值100，再对H10这个活动单元格赋值200</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象的End属性"><a href="#Range对象的End属性" class="headerlink" title="Range对象的End属性"></a>Range对象的End属性</h2><p>假设有一块区域的数据，我们点击其中的某一个有数据的单元格，然后快捷键：<code>Ctrl + ↓</code> ，到达了这块有数值区域最下方的单元格；同理，<code>Ctrl + ↑</code>，<code>Ctrl + ←</code>，<code>Ctrl + →</code>，可以到达这块单元格区域的边缘 or 最上&#x2F;左&#x2F;右的单元格。</p>
<p>如果想要<strong>选中</strong>当前单元格到最下面的单元格，<code>Ctrl + Shift + ↓</code>，可以选中；可以先<code>Ctrl + Shift + ↓</code>，紧接着就<code>Ctrl + Shift + →</code>，可以连续选中多行多列的内容，可以灵活选择目前这块区域中的某一块区域。</p>
<p>这种操作在代码中如何实现？</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> CellRefTest()</span><br><span class="line"><span class="comment">&#x27;End属性模拟&quot;Ctrl＋方向键&quot;的效果</span></span><br><span class="line"><span class="comment">&#x27;选中H10最往下再最往右的单元格</span></span><br><span class="line">Range(<span class="string">&quot;H10&quot;</span>).<span class="keyword">End</span>(xlDown).<span class="keyword">End</span>(xlToRight).<span class="keyword">Select</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;End属性模拟&quot;Ctrl＋Shift + 方向键&quot;的效果</span></span><br><span class="line"><span class="comment">&#x27;Range(A,B),表示从A到B中间所有的单元格</span></span><br><span class="line"><span class="comment">&#x27;选中H10开始，到H10最往下再最往右的单元格，这一块区域的单元格</span></span><br><span class="line">Range(<span class="string">&quot;H10&quot;</span>, Range(<span class="string">&quot;H10&quot;</span>).<span class="keyword">End</span>(xlDown).<span class="keyword">End</span>(xlToRight)).<span class="keyword">Select</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-剪切复制粘贴"><a href="#Range对象-剪切复制粘贴" class="headerlink" title="Range对象_剪切复制粘贴"></a>Range对象_剪切复制粘贴</h2><p>Range对象的常用操作很重要，因为我们在Excel里面基本上都是在对单元格进行一些操作，要讲这些操作如何通过VBA实现。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> RangeTest()</span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;剪切+粘贴</span></span><br><span class="line">    <span class="comment">&#x27;.Cut之后写一个空格，会有一个destination，意思表示我们剪切后粘贴到哪里</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A5&quot;</span>).Cut Range(<span class="string">&quot;C2&quot;</span>)</span><br><span class="line">    <span class="comment">&#x27;将A1到A5单元格里面的数字剪切后，粘贴到C2去了；因为有5个单元格，所以C2-C6都有了100的值</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;复制+粘贴</span></span><br><span class="line">    <span class="comment">&#x27;将A6到A10单元格里面的数字复制后，粘贴到E3去了；因为有5个单元格，所以E3-E7都有了100的值</span></span><br><span class="line">    Range(<span class="string">&quot;A6:A10&quot;</span>).Copy Range(<span class="string">&quot;E3&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置单元格公式"><a href="#Range对象-设置单元格公式" class="headerlink" title="Range对象_设置单元格公式"></a>Range对象_设置单元格公式</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> RangeTest()</span><br><span class="line">    <span class="comment">&#x27;在G列，计算出计算1-10行的A列-E列对应单元格的求和</span></span><br><span class="line">    <span class="comment">&#x27;G1是A1到E1的求和</span></span><br><span class="line">    <span class="comment">&#x27;G2是A2到E2的求和</span></span><br><span class="line">    <span class="comment">&#x27;G3是A3到E3的求和</span></span><br><span class="line">    <span class="comment">&#x27;G4是A4到E4的求和</span></span><br><span class="line">    <span class="comment">&#x27;………………</span></span><br><span class="line">    Range(<span class="string">&quot;G1:G10&quot;</span>).Formula = <span class="string">&quot;=SUM(A1:E1)&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-选择性粘贴"><a href="#Range对象-选择性粘贴" class="headerlink" title="Range对象_选择性粘贴"></a>Range对象_选择性粘贴</h2><p>选择性粘贴：粘贴的时候先右键，可以选择“粘贴为值”，“粘贴为公式”……</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> RangeTest()</span><br><span class="line">    Range(<span class="string">&quot;G1:G10&quot;</span>).Copy</span><br><span class="line">    Range(<span class="string">&quot;J1&quot;</span>).PasteSpecial xlPasteValues <span class="comment">&#x27;粘贴为值</span></span><br><span class="line">    <span class="comment">&#x27;运行后在J列的单元格内就有粘贴的值，但是G列还是一个被选中的状态</span></span><br><span class="line">    <span class="comment">&#x27;想要去除掉选中的状态，可以进行下面的操作</span></span><br><span class="line">    </span><br><span class="line">    Application.CutCopyMode = <span class="literal">False</span></span><br><span class="line">    <span class="comment">&#x27;CutCopyMode，就是剪切或者复制的模式，设置成FALSE，也就是取消这种效果</span></span><br><span class="line">    <span class="comment">&#x27;因为这种选中的状态（虚线/蚂蚁线），只有在剪切或者复制的时候才会出现</span></span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;J10&quot;</span>).<span class="keyword">Select</span></span><br><span class="line">    <span class="comment">&#x27;选中J10的单元格，这样就不是选中上方的单元格了</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置字体效果"><a href="#Range对象-设置字体效果" class="headerlink" title="Range对象_设置字体效果"></a>Range对象_设置字体效果</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ZiTiTest()</span><br><span class="line">    <span class="comment">&#x27;把A1到A10写上字“文本”</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="string">&quot;文本&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;font，字体，也是对象</span></span><br><span class="line">    <span class="comment">&#x27;运行下面的代码时，推荐用“逐语句/逐行”观察效果</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;设置字体</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Font.Name = <span class="string">&quot;黑体&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;设置大小</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Font.Size = <span class="number">15</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;加粗</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Font.Bold = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;倾斜</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Font.Italic = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;颜色</span></span><br><span class="line">    <span class="comment">&#x27;方法一：(输入vb两个字母后，可以用快捷键【Ctrl + J】辅助</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Font.Color = vbRed</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;方法二：用RGB值，3个值，每个值都可以设置0-255之间</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Font.Color = RGB(<span class="number">156</span>, <span class="number">191</span>, <span class="number">72</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="通过文档查看对象属性和方法"><a href="#通过文档查看对象属性和方法" class="headerlink" title="通过文档查看对象属性和方法"></a>通过文档查看对象属性和方法</h2><p>不用死记硬背。工具栏这里有个“对象浏览器”，也可以在“视图”下方找到，快捷键是F2；</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/office/vba/api/excel.range(object)">Range 对象 (Excel)</a></p>
<p>【所有库】这里选择“Excel”；</p>
<p>【类】就是“对象”的意思，在“类”下面，找到Range：右侧是灰色手指图标的，表示这是“属性”；绿色图标，表示这是“方法”。（可以在这里找到所有的对象和方法，但是不需要全部完全掌握；如果英文看不懂，可以用“帮助”，按下F1，如果可以的话，会出现一个微软的网站，会有写教程；如果打不开，有一个微软的帮助文档，找到Obejct model，单击再点键盘上的“R”，找到Range Object，单击打开并单击Range Members，就能找到找到每一个属性和方法的介绍，都是英文的，每一个点进去都有示例代码方便理解）</p>
<aside>
💡 如果不知道该用什么属性和方法，可以用“宏录制”来辅助，或者去参考文档*Excel 2013 Developer Documentation.chm*，或者去[微软官网](https://learn.microsoft.com/zh-cn/office/vba/api/overview/excel/object-model)，看下应该使用什么属性和方法。
</aside>



<h2 id="With语法使用方法"><a href="#With语法使用方法" class="headerlink" title="With语法使用方法"></a>With语法使用方法</h2><p>之前学过，设置字体属性的时候，可以用<code>Range(&quot;A1:A10&quot;).Font.****</code>来设置相应属性，但是若有多个属性需要同时设置，多行写<code>Range(&quot;A1:A10&quot;).Font.</code>很浪费时间，可以通过<strong>With语句</strong>，把这个操作变得更加简单。</p>
<p>优点：不用每一次都在前面写上相应的对象，而是把对象固定好之后，紧接着再编写相应的属性。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ZiTiTest()</span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="string">&quot;文本&quot;</span></span><br><span class="line"><span class="comment">&#x27;不用With语句</span></span><br><span class="line"><span class="comment">&#x27;    Range(&quot;A1:A10&quot;).Font.Name = &quot;黑体&quot;</span></span><br><span class="line"><span class="comment">&#x27;    Range(&quot;A1:A10&quot;).Font.Size = 15</span></span><br><span class="line"><span class="comment">&#x27;    Range(&quot;A1:A10&quot;).Font.Bold = True</span></span><br><span class="line"><span class="comment">&#x27;    Range(&quot;A1:A10&quot;).Font.Italic = True</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;    Range(&quot;A1:A10&quot;).Font.Color = vbRed</span></span><br><span class="line"><span class="comment">&#x27;    Range(&quot;A1:A10&quot;).Font.Color = RGB(156, 191, 72)</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&#x27;用With语句</span></span><br><span class="line"><span class="comment">&#x27;逐语句执行比较直观</span></span><br><span class="line">    <span class="keyword">With</span> Range(<span class="string">&quot;A1:A10&quot;</span>).Font</span><br><span class="line">        .Name = <span class="string">&quot;微软雅黑&quot;</span></span><br><span class="line">        .Size = <span class="number">15</span></span><br><span class="line">        .Bold = <span class="literal">True</span></span><br><span class="line">        .Italic = <span class="literal">True</span></span><br><span class="line">        .Color = RGB(<span class="number">156</span>, <span class="number">191</span>, <span class="number">72</span>)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="comment">&#x27;别忘了End With</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置边框线"><a href="#Range对象-设置边框线" class="headerlink" title="Range对象_设置边框线"></a>Range对象_设置边框线</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> rangetest()</span><br><span class="line"></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="string">&quot;文本&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;对象：Borders——边框线</span></span><br><span class="line">    <span class="keyword">With</span> Range(<span class="string">&quot;A1:A10&quot;</span>).Borders</span><br><span class="line">        <span class="comment">&#x27;按下xl之后，要按快捷键Ctrl + J</span></span><br><span class="line">        .LineStyle = xlDouble   <span class="comment">&#x27;边框线样式：双线条边框线</span></span><br><span class="line">        .Color = vbRed          <span class="comment">&#x27;边框线颜色：红色</span></span><br><span class="line">        .Weight = xlThick       <span class="comment">&#x27;边框线粗细：粗</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置填充颜色"><a href="#Range对象-设置填充颜色" class="headerlink" title="Range对象_设置填充颜色"></a>Range对象_设置填充颜色</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> rangetest()</span><br><span class="line">    <span class="comment">&#x27;对象/属性：Interior</span></span><br><span class="line">      </span><br><span class="line">    <span class="comment">&#x27;使用VB内部的颜色</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="string">&quot;文本&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Interior.Color = vbGreen</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;使用RGB自定义颜色</span></span><br><span class="line">    Range(<span class="string">&quot;A11:A20&quot;</span>).Value = <span class="string">&quot;填充颜色&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;A11:A20&quot;</span>).Interior.Color = RGB(<span class="number">0</span>, <span class="number">177</span>, <span class="number">236</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置对齐方式"><a href="#Range对象-设置对齐方式" class="headerlink" title="Range对象_设置对齐方式"></a>Range对象_设置对齐方式</h2><p>可以设置两种对齐方式：水平方向上的 AND 竖直方向上的</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> rangetest()</span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="string">&quot;文本&quot;</span></span><br><span class="line">    <span class="comment">&#x27;逐行运行的时候，可以拉高行号辅助观察效果</span></span><br><span class="line">    <span class="comment">&#x27;输入xl后，可以快捷键【Ctrl + J】辅助输入</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">With</span> Range(<span class="string">&quot;A1:A10&quot;</span>)</span><br><span class="line">        .Font.Size = <span class="number">13</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;在水平方向上的对齐方式：靠右</span></span><br><span class="line">        .HorizontalAlignment = xlRight</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;在竖直方向上的对齐方式：靠底部</span></span><br><span class="line">        .VerticalAlignment = xlBottom</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置缩进大小"><a href="#Range对象-设置缩进大小" class="headerlink" title="Range对象_设置缩进大小"></a>Range对象_设置缩进大小</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> RangeTest08()</span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="string">&quot;文本&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;左对齐，缩进值为2</span></span><br><span class="line">    <span class="keyword">With</span> Range(<span class="string">&quot;A1:A10&quot;</span>)</span><br><span class="line">        .HorizontalAlignment = xlLeft</span><br><span class="line">        .InsertIndent <span class="number">2</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="comment">&#x27;如何检查缩进值？看“单元格格式”里面的“对齐”，就是靠左缩进，缩进值为2。</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置自动换行"><a href="#Range对象-设置自动换行" class="headerlink" title="Range对象_设置自动换行"></a>Range对象_设置自动换行</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> RangeTest56()</span><br><span class="line">    <span class="comment">&#x27;在E1单元格，输入一些较长的文本</span></span><br><span class="line">    Range(<span class="string">&quot;E1&quot;</span>).Value = <span class="string">&quot;学习VBA设置565656自动换行&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;在E1单元格，实现换行的效果</span></span><br><span class="line">    Range(<span class="string">&quot;E1&quot;</span>).WrapText = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-合并单元格"><a href="#Range对象-合并单元格" class="headerlink" title="Range对象_合并单元格"></a>Range对象_合并单元格</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> RangeTest45()</span><br><span class="line">    <span class="comment">&#x27;合并单元格A1-A10，到A1中，那么A2-A10的内容就消失了</span></span><br><span class="line">    <span class="comment">&#x27;Merge是合并的意思，合并的时候会弹窗说“合并单元格时，仅保留左上角的值，而放弃其他值。”</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A1:A10&quot;).Merge</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;UnMerge表示：取消合并单元格，执行时可注释掉上面一行的代码</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A1:A10&quot;).UnMerge</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果想要合并，并且保留其他单元格的内容</span></span><br><span class="line">    <span class="comment">&#x27;就用一个for循环，把A1-A10的内容全部连接到一个字符串上</span></span><br><span class="line">    <span class="comment">&#x27;再把这个字符串输出到A1里面</span></span><br><span class="line">    <span class="comment">&#x27;再合并单元格，舍弃其他单元格的值</span></span><br><span class="line">    <span class="keyword">Dim</span> Num <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> txt <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;为了方便观察，可以在“视图”里面，打开监视窗口，并且把变量txt【添加监视】</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> Num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">&#x27;txt = txt &amp; Cells(Num, 1) &amp; &quot;-&quot;</span></span><br><span class="line">        <span class="comment">&#x27;这样出来，字符串最后会有一个短横线，比如【文本-文本-文本-文本-文本-文本-文本-文本-文本-文本-】</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;如果不想要这个短横线</span></span><br><span class="line">        <span class="comment">&#x27;就可以在循环的时候，加一个判断的语句</span></span><br><span class="line">        <span class="comment">&#x27;如果是第10个单元格，末尾不加短横线</span></span><br><span class="line">        <span class="comment">&#x27;如果不是第10个单元格，通过短横线，进行连接分隔</span></span><br><span class="line">        <span class="keyword">If</span> Num = <span class="number">10</span> <span class="keyword">Then</span></span><br><span class="line">            txt = txt &amp; Cells(Num, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            txt = txt &amp; Cells(Num, <span class="number">1</span>) &amp; <span class="string">&quot;-&quot;</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span> Num</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>) = txt</span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Merge</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-阻止Excel提醒弹窗出现"><a href="#Range对象-阻止Excel提醒弹窗出现" class="headerlink" title="Range对象_阻止Excel提醒弹窗出现"></a>Range对象_阻止Excel提醒弹窗出现</h2><p>比如执行上面一节的代码的时候，会出现一个弹窗【合并单元格时，仅保留左上角的值，而放弃其他值。】此时单击“确定”，就会只保留左上角的值。</p>
<p>如果不想要弹窗出现，可以用<em>Application</em>这个对象</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Application.DisplayAlerts = <span class="literal">False</span></span><br><span class="line"><span class="comment">&#x27;把这一句写在代码前半部分</span></span><br><span class="line"><span class="comment">&#x27;就是不要弹窗出现的意思</span></span><br><span class="line"><span class="comment">&#x27;即“阻止Excel通过弹窗进行提醒”</span></span><br><span class="line"></span><br><span class="line">Application.DisplayAlerts = <span class="literal">True</span></span><br><span class="line"><span class="comment">&#x27;再把这句写在End Sub之前，就代表</span></span><br><span class="line"><span class="comment">&#x27;在这个Sub以内，就是只是在这个程序中阻止弹窗出现</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置数字格式"><a href="#Range对象-设置数字格式" class="headerlink" title="Range对象_设置数字格式"></a>Range对象_设置数字格式</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> RangeTest12()</span><br><span class="line">    Range(<span class="string">&quot;G1:G10&quot;</span>).Value = <span class="number">100000</span></span><br><span class="line">    Range(<span class="string">&quot;G1:G10&quot;</span>).NumberFormat = <span class="string">&quot;￥#,##0.00&quot;</span></span><br><span class="line">    <span class="comment">&#x27;如果不知道数字格式怎么用代码写，就去查吧</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-插入删除行和列-删除-清除单元格"><a href="#Range对象-插入删除行和列-删除-清除单元格" class="headerlink" title="Range对象_插入删除行和列+删除&#x2F;清除单元格"></a>Range对象_插入删除行和列+删除&#x2F;清除单元格</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> RangeTest13()</span><br><span class="line">    Range(<span class="string">&quot;A1:N30&quot;</span>).Value = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;插入单行</span></span><br><span class="line">    <span class="comment">&#x27;方法一：在第3行的上方，插入一行</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;3:3&quot;).Insert</span></span><br><span class="line">    <span class="comment">&#x27;方法二：在A5单元格上方，插入1行</span></span><br><span class="line">    <span class="comment">&#x27;就是在A5单元格对应的这一行的上方，插入一行</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A5&quot;).EntireRow.Insert</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;插入单列</span></span><br><span class="line">    <span class="comment">&#x27;方法一：在C列的左侧，插入了一列</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;C:C&quot;).Insert</span></span><br><span class="line">    <span class="comment">&#x27;方法二：在E1单元格左侧，插入1列</span></span><br><span class="line">    <span class="comment">&#x27;就是在E1单元格对应的这一列的左侧，插入1列</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;E1&quot;).EntireColumn.Insert</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;删除单行</span></span><br><span class="line">    <span class="comment">&#x27;删除第3行</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;3:3&quot;).Delete</span></span><br><span class="line">    <span class="comment">&#x27;删除A5这一行</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A5&quot;).EntireRow.Delete</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;删除单列</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;C:C&quot;).Delete</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;E1&quot;).EntireColumn.Delete</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;==============分割线=======================</span></span><br><span class="line">    <span class="comment">&#x27;插入多行</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A3:A5&quot;).EntireRow.Insert</span></span><br><span class="line">    <span class="comment">&#x27;效果就是3.4.5行新增了3行空白行</span></span><br><span class="line">    <span class="comment">&#x27;Rows(&quot;9:11&quot;).Insert</span></span><br><span class="line">    <span class="comment">&#x27;效果就是9.10.11行新增了3行空白行</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;插入多列</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;C1:E1&quot;).EntireColumn.Insert</span></span><br><span class="line">    <span class="comment">&#x27;Columns(&quot;G:I&quot;).Insert</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;删除多行(下面的行会自动补上)</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A3:A5&quot;).Delete &#x27;这样只会删除这3个单元格</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;A3:A5&quot;).EntireRow.Delete</span></span><br><span class="line">    <span class="comment">&#x27;Rows(&quot;6:8&quot;).Delete</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;删除多列(右边的列会自动补上)</span></span><br><span class="line">    <span class="comment">&#x27;Range(&quot;C1:E1&quot;).EntireColumn.Delete</span></span><br><span class="line">    <span class="comment">&#x27;Columns(&quot;D:F&quot;).Delete</span></span><br><span class="line">    </span><br><span class="line">     </span><br><span class="line">     <span class="comment">&#x27;==============分割线=======================</span></span><br><span class="line">     <span class="comment">&#x27;删除单元格(删除后右侧内容会自动补上)</span></span><br><span class="line">     <span class="comment">&#x27;Range(&quot;B3:D10&quot;).Delete</span></span><br><span class="line">    </span><br><span class="line">     <span class="comment">&#x27;删除单元格(删除后，不希望其他内容移动，也就是清除内容，可以用clear)</span></span><br><span class="line">     Range(<span class="string">&quot;F5:I10&quot;</span>).Clear</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-设置行高与列宽"><a href="#Range对象-设置行高与列宽" class="headerlink" title="Range对象_设置行高与列宽"></a>Range对象_设置行高与列宽</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> RangeTest14()</span><br><span class="line">    <span class="comment">&#x27;设置单行行高</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).RowHeight = <span class="number">30</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;设置多行行高</span></span><br><span class="line">    Range(<span class="string">&quot;A3:A5&quot;</span>).EntireRow.RowHeight = <span class="number">40</span></span><br><span class="line">    Rows(<span class="string">&quot;7:12&quot;</span>).RowHeight = <span class="number">50</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;设置单列列宽</span></span><br><span class="line">    Range(<span class="string">&quot;C1&quot;</span>).ColumnWidth = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;设置多列列宽</span></span><br><span class="line">    Range(<span class="string">&quot;D1:F1&quot;</span>).EntireColumn.ColumnWidth = <span class="number">30</span></span><br><span class="line">    Columns(<span class="string">&quot;H:J&quot;</span>).ColumnWidth = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;设置列宽行高自适应</span></span><br><span class="line">    Rows(<span class="string">&quot;1:10&quot;</span>).AutoFit</span><br><span class="line">    Columns(<span class="string">&quot;A:J&quot;</span>).AutoFit</span><br><span class="line">  </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-隐藏和取消隐藏-行和列"><a href="#Range对象-隐藏和取消隐藏-行和列" class="headerlink" title="Range对象_隐藏和取消隐藏 行和列"></a>Range对象_隐藏和取消隐藏 行和列</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> RangeTest15()</span><br><span class="line">    <span class="comment">&#x27;隐藏多行</span></span><br><span class="line">    Range(<span class="string">&quot;A3:A5&quot;</span>).EntireRow.Hidden = <span class="literal">True</span>  </span><br><span class="line">    <span class="comment">&#x27;隐藏多列</span></span><br><span class="line">    Range(<span class="string">&quot;G1:I1&quot;</span>).EntireColumn.Hidden = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;显示行和列，即取消隐藏行和列  </span></span><br><span class="line">    Range(<span class="string">&quot;A3:A5&quot;</span>).EntireRow.Hidden = <span class="literal">False</span></span><br><span class="line">    Range(<span class="string">&quot;G1:I1&quot;</span>).EntireColumn.Hidden = <span class="literal">False</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Range对象-清除单元格格式及内容"><a href="#Range对象-清除单元格格式及内容" class="headerlink" title="Range对象_清除单元格格式及内容"></a>Range对象_清除单元格格式及内容</h2><p>分别表示清除批注、内容、格式、超链接</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> RangeTest16()</span><br><span class="line">    <span class="comment">&#x27;清除格式</span></span><br><span class="line">    Range(<span class="string">&quot;A1:N30&quot;</span>).Value = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;对A1:N30的单元格设置格式</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">With</span> Range(<span class="string">&quot;A1:N30&quot;</span>).Font</span><br><span class="line">        .Color = vbRed</span><br><span class="line">        .Name = <span class="string">&quot;微软雅黑&quot;</span></span><br><span class="line">        .Bold = <span class="literal">True</span></span><br><span class="line">        .Underline = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;清除A1:N3的格式</span></span><br><span class="line">    Range(<span class="string">&quot;A1:N3&quot;</span>).ClearFormats</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;清除A1:K15的内容</span></span><br><span class="line">    Range(<span class="string">&quot;A1:K15&quot;</span>).ClearContents</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;或者一步到位，直接一个clear清除内容和格式</span></span><br><span class="line">    Range(<span class="string">&quot;A1:K15&quot;</span>).Clear</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Sheets对象-Sheets对象的基本使用"><a href="#Sheets对象-Sheets对象的基本使用" class="headerlink" title="Sheets对象_Sheets对象的基本使用"></a>Sheets对象_Sheets对象的基本使用</h2><p>针对工作表的操作</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SheetsTest()</span><br><span class="line">    <span class="comment">&#x27;写名称：Sheet2是工作表的名称</span></span><br><span class="line">    <span class="comment">&#x27;【更推荐写名称这个，具有唯一性，不会因为sheet表的移动而发生改变】</span></span><br><span class="line">    <span class="comment">&#x27;Worksheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;) = 100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;按顺序：第3张工作表</span></span><br><span class="line">    <span class="comment">&#x27;Worksheets(3).Range(&quot;B2&quot;).Value = 1000</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Sheets(<span class="string">&quot;Sheet2&quot;</span>).Range(<span class="string">&quot;B2&quot;</span>).Value = <span class="number">5000</span></span><br><span class="line">    Sheets(<span class="number">2</span>).Range(<span class="string">&quot;C2&quot;</span>).Value = <span class="number">7999</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;好像sheets和Worksheets一样，但是他们是不一样的</span></span><br><span class="line">    <span class="comment">&#x27;Worksheets：表示的就是普通的工作表</span></span><br><span class="line">    <span class="comment">&#x27;Sheets：既可以表示包含数据的工作表，也可以表示这个插入图表的工作表</span></span><br><span class="line">        <span class="comment">&#x27;就是在Sheet表那里，点击插入，可以插入的是Chart图表</span></span><br><span class="line">        <span class="comment">&#x27;实际操作中，用Sheets比较方便</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="comment">&#x27;选择工作表，</span></span><br><span class="line">    <span class="comment">&#x27;效果类似从别的工作表跳到这个工作表里面</span></span><br><span class="line">    Sheets(<span class="string">&quot;Sheet4&quot;</span>).<span class="keyword">Select</span></span><br><span class="line">    <span class="comment">&#x27;在A10输入值</span></span><br><span class="line">    Range(<span class="string">&quot;A10&quot;</span>).Value = <span class="number">9999</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Sheets对象-添加工作表"><a href="#Sheets对象-添加工作表" class="headerlink" title="Sheets对象_添加工作表"></a>Sheets对象_添加工作表</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SheetsTest2()</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;Sheets.Add</span></span><br><span class="line">    <span class="comment">&#x27;若当前活动的工作表是“Sheet2”，执行这个代码后，会在当前工作表的左侧，也就是前面，插入一个新的工作表</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;若是想要明确指定插入的工作表是某张工作表的前/后面</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;比如想要在工作表Sheet4后面插入一个工作表</span></span><br><span class="line">    <span class="comment">&#x27;Sheets.Add after:=Sheets(&quot;Sheet4&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;在sheet1前面插入一个工作表</span></span><br><span class="line">    <span class="comment">&#x27;Sheets.Add before:=Sheets(&quot;Sheet1&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;弹窗显示第一个sheet表的名称</span></span><br><span class="line">    <span class="comment">&#x27;MsgBox Sheets(1).Name</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;把第2个工作表的名称改成“添加工作表2”</span></span><br><span class="line">    <span class="comment">&#x27;Sheets(2).Name = &quot;添加工作表2&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;在添加工作表时，设置好添加的工作表的名称</span></span><br><span class="line">    <span class="comment">&#x27;即在指定位置，添加一个指定名称的Sheet表</span></span><br><span class="line">    <span class="comment">&#x27;在sheet6前面，插入一个名称为“指定名称的工作表”的工作表</span></span><br><span class="line">    Sheets(<span class="string">&quot;sheet6&quot;</span>).<span class="keyword">Select</span>         <span class="comment">&#x27;这一步会跳到Sheet6里</span></span><br><span class="line">    Sheets.Add.Name = <span class="string">&quot;指定名称的工作表&quot;</span>        <span class="comment">&#x27;这一步会在Sheet6前面插入一个有名称的工作表</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Sheets对象-移动工作表"><a href="#Sheets对象-移动工作表" class="headerlink" title="Sheets对象_移动工作表"></a>Sheets对象_移动工作表</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SheetsTest3()</span><br><span class="line">    <span class="comment">&#x27;把“添加工作表”这个sheet移动，放在“指定名称的工作表”之前</span></span><br><span class="line">    Sheets(<span class="string">&quot;添加工作表&quot;</span>).Move before:=Sheets(<span class="string">&quot;指定名称的工作表&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;把“添加工作表”这个sheet移动，放在“Sheet4”之前</span></span><br><span class="line">    Sheets(<span class="string">&quot;添加工作表&quot;</span>).Move after:=Sheets(<span class="string">&quot;Sheet4&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Sheets对象-复制工作表"><a href="#Sheets对象-复制工作表" class="headerlink" title="Sheets对象_复制工作表"></a>Sheets对象_复制工作表</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SheetsTest4()</span><br><span class="line">    <span class="comment">&#x27;既然要复制，那还需要指定复制后的位置</span></span><br><span class="line">    <span class="comment">&#x27;把&quot;添加工作表&quot;，复制后，放在Sheet2前面</span></span><br><span class="line">    Sheets(<span class="string">&quot;添加工作表&quot;</span>).Copy before:=Sheets(<span class="string">&quot;Sheet2&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;把&quot;添加工作表&quot;，复制后，放在Sheet6后面</span></span><br><span class="line">    Sheets(<span class="string">&quot;添加工作表&quot;</span>).Copy after:=Sheets(<span class="string">&quot;Sheet6&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Sheets对象-隐藏和删除工作表"><a href="#Sheets对象-隐藏和删除工作表" class="headerlink" title="Sheets对象_隐藏和删除工作表"></a>Sheets对象_隐藏和删除工作表</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SheetsTest5()</span><br><span class="line">    <span class="comment">&#x27;隐藏Sheet1</span></span><br><span class="line">    <span class="comment">&#x27;就是能看见吗？不能的意思</span></span><br><span class="line">    <span class="comment">&#x27;Sheets(&quot;Sheet1&quot;).Visible = False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;取消隐藏Sheet1</span></span><br><span class="line">    <span class="comment">&#x27;Sheets(&quot;Sheet1&quot;).Visible = True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;删除工作表</span></span><br><span class="line">    <span class="comment">&#x27;不可恢复，不可撤销，谨慎操作</span></span><br><span class="line">    <span class="comment">&#x27;Sheets(&quot;Sheet6&quot;).Delete</span></span><br><span class="line">    <span class="comment">&#x27;只写这一行，会有弹窗</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果不想要弹窗，就这么写</span></span><br><span class="line">    <span class="comment">&#x27;不可恢复，不可撤销，谨慎操作</span></span><br><span class="line">    Application.DisplayAlerts = <span class="literal">False</span></span><br><span class="line">    Sheets(<span class="string">&quot;Sheet1&quot;</span>).Delete</span><br><span class="line">    Application.DisplayAlerts = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Workbooks对象-新建工作簿"><a href="#Workbooks对象-新建工作簿" class="headerlink" title="Workbooks对象_新建工作簿"></a>Workbooks对象_新建工作簿</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> WorkbooksTest()</span><br><span class="line">    <span class="comment">&#x27;Workbooks.Add</span></span><br><span class="line">    <span class="comment">&#x27;运行后，只会新建一个工作簿，但是没有保存</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;新建文档，并且设置好另存为的路径及名称</span></span><br><span class="line">    <span class="comment">&#x27;设置保存的地方</span></span><br><span class="line">    <span class="comment">&#x27;filename后面要加一个完整的路径，并且加上文件的名字+格式</span></span><br><span class="line">    Workbooks.Add.SaveAs Filename:=<span class="string">&quot;C:\Users\陈勇平\Desktop\vvjjcjy\测试文档.xlsx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Workbooks对象-打开和关闭工作簿"><a href="#Workbooks对象-打开和关闭工作簿" class="headerlink" title="Workbooks对象_打开和关闭工作簿"></a>Workbooks对象_打开和关闭工作簿</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> WorkbooksTest2()</span><br><span class="line">    <span class="comment">&#x27;打开工作簿</span></span><br><span class="line">    <span class="comment">&#x27;记得写后缀名</span></span><br><span class="line">    <span class="comment">&#x27;Workbooks.Open Filename:=&quot;C:\Users\陈勇平\Desktop\vvjjcjy\测试文档.xlsx&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;关闭工作簿</span></span><br><span class="line">    <span class="comment">&#x27;因为Excel不会同时打开重名的工作簿，所以一个名字只会有1个打开着的工作簿</span></span><br><span class="line">    </span><br><span class="line">    Workbooks(<span class="string">&quot;测试文档.xlsx&quot;</span>).Close</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Workbooks对象-保存工作簿"><a href="#Workbooks对象-保存工作簿" class="headerlink" title="Workbooks对象_保存工作簿"></a>Workbooks对象_保存工作簿</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> WorkbooksTest3()</span><br><span class="line">    <span class="comment">&#x27;先对表格做修改</span></span><br><span class="line">    Range(<span class="string">&quot;A1:A10&quot;</span>).Value = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    Workbooks(<span class="string">&quot;20221029jy.xlsm&quot;</span>).Save</span><br><span class="line">    <span class="comment">&#x27;此时已经成功进行了保存</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Workbooks对象-删除工作簿"><a href="#Workbooks对象-删除工作簿" class="headerlink" title="Workbooks对象_删除工作簿"></a>Workbooks对象_删除工作簿</h2><p>用kill</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> WorkbooksTest4()</span><br><span class="line">    Kill pathname:=<span class="string">&quot;C:\Users\陈勇平\Desktop\vvjjcjy\测试文档.xlsx&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Workbooks对象-显示文档的名称及路径"><a href="#Workbooks对象-显示文档的名称及路径" class="headerlink" title="Workbooks对象_显示文档的名称及路径"></a>Workbooks对象_显示文档的名称及路径</h2><p>path: 路径</p>
<p>name: 文件名</p>
<p>full name: 路径＋名称</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> WorkbooksTest5()</span><br><span class="line">    <span class="comment">&#x27;弹窗显示，显示当前文档的路径</span></span><br><span class="line">    MsgBox ThisWorkbook.Path</span><br><span class="line">    <span class="comment">&#x27;在某个单元格中显示，显示当前文档的路径</span></span><br><span class="line">		<span class="comment">&#x27;效果类似：C:\Users\******\Desktop</span></span><br><span class="line">    Range(<span class="string">&quot;A20&quot;</span>).Value = ThisWorkbook.Path</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;ThisWorkbook与ActiveWorkbook的区别</span></span><br><span class="line">    <span class="comment">&#x27;ThisWorkbook：表示这个模块所在的这个文档</span></span><br><span class="line">    <span class="comment">&#x27;ActiveWorkbook：表示当前的活动工作簿</span></span><br><span class="line">    <span class="comment">&#x27;【这两个有可能不一样】</span></span><br><span class="line">		MsgBox ThisWorkbook.Name</span><br><span class="line">    MsgBox ActiveWorkbook.Name</span><br><span class="line">    Range(<span class="string">&quot;A21&quot;</span>).Value = ThisWorkbook.Name</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;一步到位，显示路径+名称</span></span><br><span class="line">    <span class="comment">&#x27;效果类似：C:\Users\******\Desktop\20221029Jemma.xlsm</span></span><br><span class="line">    MsgBox ThisWorkbook.FullName</span><br><span class="line">    MsgBox ActiveWorkbook.FullName</span><br><span class="line">    Range(<span class="string">&quot;A22&quot;</span>).Value = ThisWorkbook.FullName</span><br><span class="line"></span><br><span class="line">		<span class="comment">&#x27;打开相同路径下的其他文件，需要输入名称及后缀名</span></span><br><span class="line">    Workbooks.Open Filename:=ThisWorkbook.Path &amp; <span class="string">&quot;\&quot;</span> &amp; <span class="string">&quot;******.xlsm&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="使用ForEach遍历工作簿"><a href="#使用ForEach遍历工作簿" class="headerlink" title="使用ForEach遍历工作簿"></a>使用ForEach遍历工作簿</h2><p>遍历3个Excel文档，展示它们的名称</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ForEachTest()</span><br><span class="line">    <span class="comment">&#x27;for循环时，遍历的都是一些基本的数据类型，比如整数、小数、文本、日期等等</span></span><br><span class="line">    <span class="comment">&#x27;遍历对象，需要用for each</span></span><br><span class="line">    <span class="comment">&#x27;操作方法类似</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> book <span class="keyword">As</span> Workbook</span><br><span class="line">    <span class="comment">&#x27;workbook 既是对象，也可以是一种数据类型——工作簿类型</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> book <span class="keyword">In</span> Workbooks</span><br><span class="line">    <span class="comment">&#x27;for each表示遍历，workbooks表示现在打开的所有工作簿</span></span><br><span class="line">    <span class="comment">&#x27;也就是去遍历每一个打开的工作簿，每一个工作簿的名称都会赋值给变量book</span></span><br><span class="line">        MsgBox book.Name</span><br><span class="line">    <span class="keyword">Next</span> book</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;使用ForEach遍历Workbooks（打开的所有的工作簿）</span></span><br><span class="line">		<span class="comment">&#x27;打开的工作簿赋值给变量book</span></span><br><span class="line">		<span class="comment">&#x27;book的数据类型就是Workbook，所以可以接受Workbooks遍历后的赋值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="使用ForEach遍历工作表"><a href="#使用ForEach遍历工作表" class="headerlink" title="使用ForEach遍历工作表"></a>使用ForEach遍历工作表</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ForEachTest2()</span><br><span class="line">    <span class="keyword">Dim</span> sheet <span class="keyword">As</span> Worksheet</span><br><span class="line">    <span class="comment">&#x27;定义一个变量，为Worksheet类型</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> sheet <span class="keyword">In</span> Worksheets</span><br><span class="line">    <span class="comment">&#x27;Worksheets表示：当前工作簿中的这些工作表</span></span><br><span class="line">    <span class="comment">&#x27;遍历工作表，并且把每个工作表赋值给变量sheet</span></span><br><span class="line">        </span><br><span class="line">        MsgBox sheet.Name</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span> sheet</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="使用ForEach遍历单元格"><a href="#使用ForEach遍历单元格" class="headerlink" title="使用ForEach遍历单元格"></a>使用ForEach遍历单元格</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ForEachTest3()</span><br><span class="line">    <span class="keyword">Dim</span> cell <span class="keyword">As</span> Range</span><br><span class="line"><span class="comment">&#x27;    &#x27;方法一：for each</span></span><br><span class="line"><span class="comment">&#x27;    For Each cell In Range(&quot;A5:A10&quot;)</span></span><br><span class="line"><span class="comment">&#x27;        MsgBox cell.Value</span></span><br><span class="line"><span class="comment">&#x27;        &#x27;如果不想弹窗太多，可以把数据范围弄小一点</span></span><br><span class="line"><span class="comment">&#x27;    Next cell</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;方法二：for循环</span></span><br><span class="line">    <span class="keyword">Dim</span> index <span class="keyword">As</span> <span class="type">Integer</span>, RowIndex <span class="keyword">As</span> <span class="type">Integer</span>, ColumnIndex <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> Rng <span class="keyword">As</span> Range</span><br><span class="line">    <span class="keyword">Set</span> Rng = Range(<span class="string">&quot;A5:A10&quot;</span>)</span><br><span class="line">    <span class="comment">&#x27;Set的应用：这里的Rng是个对象类型</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> RowIndex = <span class="number">1</span> <span class="keyword">To</span> Rng.Rows.Count</span><br><span class="line">        <span class="comment">&#x27;Rng.Rows.Count:表示的是Range(&quot;A5:A10&quot;)，这里面有多少行，即行的数量</span></span><br><span class="line">        <span class="keyword">For</span> ColumnIndex = <span class="number">1</span> <span class="keyword">To</span> Rng.Columns.Count</span><br><span class="line">            <span class="comment">&#x27;可以弹窗显示</span></span><br><span class="line">            <span class="comment">&#x27;MsgBox Rng.Cells(RowIndex, ColumnIndex)</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">&#x27;弹窗显示如果很多，就可以把这部分数据安排到别的单元格区域去</span></span><br><span class="line">            Range(<span class="string">&quot;C14&quot;</span>).Offset(RowIndex, ColumnIndex) = Rng.Cells(RowIndex, ColumnIndex)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">Next</span> ColumnIndex</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span> RowIndex</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h1 id="【Chapter-4】VBA日期与文本函数"><a href="#【Chapter-4】VBA日期与文本函数" class="headerlink" title="【Chapter 4】VBA日期与文本函数"></a>【Chapter 4】VBA日期与文本函数</h1><h2 id="日期类型数据基础知识"><a href="#日期类型数据基础知识" class="headerlink" title="日期类型数据基础知识"></a>日期类型数据基础知识</h2><p>不是Excel函数，而是VBA函数。</p>
<p>“立即窗口”中的内容会叠加，不会自动消失。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DateTimeFunctionTest()</span><br><span class="line">    <span class="comment">&#x27;VBA中提供了很多的函数，msgbox就是VBA的函数</span></span><br><span class="line">    <span class="comment">&#x27;前缀VBA.可以省略</span></span><br><span class="line">    <span class="comment">&#x27;msgbox本质上也是个vba函数，只是我们之前用的时候没加上前缀</span></span><br><span class="line">    <span class="comment">&#x27;VBA.MsgBox &quot;VBA函数&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;常用的有2类函数：1.对于日期和时间处理的函数；2. 对于文本和字符串的函数</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> dt <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;dt = #11/5/2022#</span></span><br><span class="line">    <span class="comment">&#x27;MsgBox dt</span></span><br><span class="line">    <span class="comment">&#x27;如果显示出来只有年月，是和本机电脑显示日期的格式有关</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Debug.Print dt</span></span><br><span class="line">    <span class="comment">&#x27;如果不想要msgbox弹窗，可以用Debug.Print配合【视图-立即窗口】</span></span><br><span class="line">    <span class="comment">&#x27;如果&quot;立即窗口&quot;有多余信息，可以选中后delete掉</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;获得当天日期？</span></span><br><span class="line">    dt = VBA.<span class="type">Date</span></span><br><span class="line">    Debug.Print dt</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如获得当前时间？</span></span><br><span class="line">    dt = VBA.Time</span><br><span class="line">    Debug.Print dt</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;使当天日期与时间同时显示出来？</span></span><br><span class="line">    dt = VBA.Now</span><br><span class="line">    Debug.Print dt</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;单独获得年月日、时分秒？</span></span><br><span class="line">    Debug.Print VBA.Year(dt)</span><br><span class="line">    Debug.Print VBA.Month(dt)</span><br><span class="line">    Debug.Print VBA.Day(dt)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;不写vba.的前缀也可以</span></span><br><span class="line">    Debug.Print Hour(dt)</span><br><span class="line">    Debug.Print Minute(dt)</span><br><span class="line">    Debug.Print Second(dt)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="日期格式化操作"><a href="#日期格式化操作" class="headerlink" title="日期格式化操作"></a>日期格式化操作</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DateTimeFunctionTest2()</span><br><span class="line">    <span class="keyword">Dim</span> dt <span class="keyword">As</span> <span class="type">Date</span>, dt2 <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    dt = <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    dt2 = VBA.Time</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;通过VBA的format进行日期的格式化操作</span></span><br><span class="line">    Debug.Print VBA.Format(dt, <span class="string">&quot;yyyy-mm-dd&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.Format(dt, <span class="string">&quot;现在是yyyy年mm月dd日，我好爱你！&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;通过VBA的FormatDateTime函数，设置日期的格式，和本机的日期、事件的格式设置相关</span></span><br><span class="line">    Debug.Print VBA.FormatDateTime(dt, vbGeneralDate) <span class="comment">&#x27;默认的日期格式</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.FormatDateTime(dt, vbLongDate) <span class="comment">&#x27;效果是长日期，如2022年11月9日</span></span><br><span class="line">    Debug.Print VBA.FormatDateTime(dt, vbShortDate) <span class="comment">&#x27;效果是短日期，如2022/11/9</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.FormatDateTime(dt2, vbLongTime) <span class="comment">&#x27;效果是长时间，17:28:13</span></span><br><span class="line">    Debug.Print VBA.FormatDateTime(dt2, vbShortTime) <span class="comment">&#x27;效果是短时间，17:28</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果想对单元格中的日期进行设置</span></span><br><span class="line">    <span class="comment">&#x27;NumberFormat不是VBA提供的日期函数，是单元格的属性</span></span><br><span class="line">    Range(<span class="string">&quot;A2:A21&quot;</span>).NumberFormat = <span class="string">&quot;yyyy年mm月dd日&quot;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="日期计算操作"><a href="#日期计算操作" class="headerlink" title="日期计算操作"></a>日期计算操作</h2><p>可以用<em>VBA.DateDiff</em>直接相减，也可以<em>VBA.DateAdd</em>表示 加&#x2F;减 几年几月几日</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DateTimeFunctionTest3()</span><br><span class="line">    <span class="keyword">Dim</span> StartDate <span class="keyword">As</span> <span class="type">Date</span>, EndDate <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    StartDate = <span class="type">Date</span> <span class="comment">&#x27;获取当期日期</span></span><br><span class="line">    EndDate = <span class="literal">#12/12/2024#</span> <span class="comment">&#x27;赋值一个日期</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print <span class="string">&quot;剩余天数：&quot;</span> &amp; (EndDate - StartDate) &amp; <span class="string">&quot; Days&quot;</span></span><br><span class="line">    <span class="comment">&#x27;把2个日期直接相减，可以获得他们相差的天数</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;也可以用函数</span></span><br><span class="line">    <span class="comment">&#x27;如果想要知道他们相差的年份/月数</span></span><br><span class="line">    <span class="comment">&#x27;</span></span><br><span class="line">    Debug.Print <span class="string">&quot;剩余天数：&quot;</span> &amp; VBA.DateDiff(<span class="string">&quot;d&quot;</span>, StartDate, EndDate) &amp; <span class="string">&quot; Days&quot;</span></span><br><span class="line">      </span><br><span class="line">    Debug.Print <span class="string">&quot;剩余月数：&quot;</span> &amp; VBA.DateDiff(<span class="string">&quot;m&quot;</span>, StartDate, EndDate) &amp; <span class="string">&quot; Months&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;注意年数要使用4个y，“yyyy”</span></span><br><span class="line">    Debug.Print <span class="string">&quot;剩余年数：&quot;</span> &amp; VBA.DateDiff(<span class="string">&quot;yyyy&quot;</span>, StartDate, EndDate) &amp; <span class="string">&quot; Years&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;在 当期日期 上加上正的5年，得到的日期</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;表示在 当期日期 上加上5年，得到的日期</span></span><br><span class="line">    Debug.Print VBA.DateAdd(<span class="string">&quot;yyyy&quot;</span>, <span class="number">5</span>, StartDate)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;表示在 当期日期 上加上5个月，得到的日期</span></span><br><span class="line">    Debug.Print VBA.DateAdd(<span class="string">&quot;m&quot;</span>, <span class="number">5</span>, StartDate)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;表示在 当期日期 上加上10天，得到的日期</span></span><br><span class="line">    Debug.Print VBA.DateAdd(<span class="string">&quot;d&quot;</span>, <span class="number">10</span>, StartDate)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;也可以加上负数，表示在 当期日期 减去5年/5个月/10天</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.DateAdd(<span class="string">&quot;yyyy&quot;</span>, -<span class="number">5</span>, StartDate)</span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.DateAdd(<span class="string">&quot;m&quot;</span>, -<span class="number">5</span>, StartDate)</span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.DateAdd(<span class="string">&quot;d&quot;</span>, -<span class="number">10</span>, StartDate)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;表示在当期日期上先加5年，再加5个月，再加10天</span></span><br><span class="line">    <span class="comment">&#x27;可以用函数赋值的思想，一步一步操作</span></span><br><span class="line">    </span><br><span class="line">    StartDate = VBA.DateAdd(<span class="string">&quot;yyyy&quot;</span>, <span class="number">5</span>, StartDate)</span><br><span class="line">    Debug.Print <span class="string">&quot;先加上5年后的日期：&quot;</span> &amp; StartDate</span><br><span class="line">    </span><br><span class="line">    StartDate = VBA.DateAdd(<span class="string">&quot;m&quot;</span>, <span class="number">5</span>, StartDate)</span><br><span class="line">    Debug.Print <span class="string">&quot;先加上5个月的日期：&quot;</span> &amp; StartDate</span><br><span class="line"></span><br><span class="line">    StartDate = VBA.DateAdd(<span class="string">&quot;d&quot;</span>, <span class="number">10</span>, StartDate)</span><br><span class="line">    Debug.Print <span class="string">&quot;先加上10天后的日期：&quot;</span> &amp; StartDate</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="日期案例实战"><a href="#日期案例实战" class="headerlink" title="日期案例实战"></a>日期案例实战</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DateTimeFunctionTest4()</span><br><span class="line">    <span class="comment">&#x27;计算日期1和日期2的相隔天数，并存储到C列</span></span><br><span class="line">    <span class="keyword">Dim</span> StartDate <span class="keyword">As</span> <span class="type">Date</span>, EndDate <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Cell表示A列活动的单元格</span></span><br><span class="line">    <span class="comment">&#x27;NextCell表示B列活动的单元格</span></span><br><span class="line">    <span class="comment">&#x27;DiffCell表示C列活动的单元格</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> Cell <span class="keyword">As</span> Range, NextCell <span class="keyword">As</span> Range, DiffCell <span class="keyword">As</span> Range</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;遍历</span></span><br><span class="line">    <span class="comment">&#x27;针对A列的A2单元格，到最末尾的单元格进行遍历</span></span><br><span class="line">    <span class="comment">&#x27;表示从A2开始，到A2最底下这块区域</span></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> Cell <span class="keyword">In</span> Range(Range(<span class="string">&quot;A2&quot;</span>), Range(<span class="string">&quot;A2&quot;</span>).<span class="keyword">End</span>(xlDown))</span><br><span class="line">    </span><br><span class="line">        <span class="comment">&#x27;针对A列的活动单元格进行格式化操作</span></span><br><span class="line">        Cell.NumberFormat = <span class="string">&quot;yyyy-mm-dd&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;获得A列活动单元格旁边的单元格，赋值给NextCell</span></span><br><span class="line">        <span class="keyword">Set</span> NextCell = Cell.Offset(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment">&#x27;针对B列的活动单元格进行格式化操作</span></span><br><span class="line">        NextCell.NumberFormat = <span class="string">&quot;yyyy-mm-dd&quot;</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">&#x27;获得C列的对应单元格</span></span><br><span class="line">        <span class="keyword">Set</span> DiffCell = NextCell.Offset(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;获得日期1、日期2，分别赋值给日期类型的变量</span></span><br><span class="line">        StartDate = Cell.Value</span><br><span class="line">        EndDate = NextCell.Value</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;使用VBA提供的DateDiff函数，获取相差天数，算出的结果赋值给C列对应单元格</span></span><br><span class="line">        DiffCell.Value = DateDiff(<span class="string">&quot;d&quot;</span>, StartDate, EndDate)</span><br><span class="line"></span><br><span class="line">				<span class="comment">&#x27;把相差天数超过400的，字体颜色设置成红色，并进行加粗</span></span><br><span class="line">        <span class="keyword">If</span> DiffCell &gt; <span class="number">400</span> <span class="keyword">Then</span></span><br><span class="line">            DiffCell.Font.Color = vbRed</span><br><span class="line">            DiffCell.Font.Bold = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span> Cell</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="文本类型数据基础知识"><a href="#文本类型数据基础知识" class="headerlink" title="文本类型数据基础知识"></a>文本类型数据基础知识</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> StringTest()</span><br><span class="line">    <span class="keyword">Dim</span> Str <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;文本类型变量赋值</span></span><br><span class="line">    Str = <span class="string">&quot;文本类型数值&quot;</span></span><br><span class="line">    Debug.Print Str</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;隐式类型转换</span></span><br><span class="line">    <span class="comment">&#x27;整数类型数据，赋值给文本类型变量</span></span><br><span class="line">    <span class="comment">&#x27;为什么没问题？因为发生了隐式类型转化，也就是说，这里看上去是123456这样1个整数类型的数据；</span></span><br><span class="line">    <span class="comment">&#x27;但是实际上它已经是包括有双引号这样的1个文本类型数据，即“123456”</span></span><br><span class="line">    </span><br><span class="line">    Str = <span class="number">123456</span></span><br><span class="line">    Debug.Print Str</span><br><span class="line">    <span class="comment">&#x27;有方法可以查看当前的str是个什么数据类型</span></span><br><span class="line">    <span class="comment">&#x27;可以发现这里的123456是文本数据类型，string，变量类型没有发生变化</span></span><br><span class="line">    Debug.Print TypeName(Str)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;显示类型转换</span></span><br><span class="line">    Str = <span class="built_in">CStr</span>(<span class="number">123456</span>) <span class="comment">&#x27;这里的作用就是把123456，用VBA的方法变成文本数据类型</span></span><br><span class="line">    Debug.Print Str</span><br><span class="line">    Debug.Print TypeName(Str)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;固定长度文本变量</span></span><br><span class="line">    <span class="keyword">Dim</span> s <span class="keyword">As</span> <span class="type">String</span> * <span class="number">3</span></span><br><span class="line">    s = Str</span><br><span class="line">    Debug.Print <span class="string">&quot;Str的内容是：&quot;</span> &amp; Str</span><br><span class="line">    Debug.Print <span class="string">&quot;s的内容是：&quot;</span> &amp; s</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;为什么str是123456，而s是123呢？</span></span><br><span class="line">    <span class="comment">&#x27;因为定义s变量的时候，我们限制了它的长度为3；会把超出它限制长度的数据给删除</span></span><br><span class="line">    <span class="comment">&#x27;和python里不一样</span></span><br><span class="line">    <span class="comment">&#x27;实际编写代码时，不推荐使用</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="拆分字符串"><a href="#拆分字符串" class="headerlink" title="拆分字符串"></a>拆分字符串</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> StringTest2()</span><br><span class="line">    <span class="keyword">Dim</span> str <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    str = <span class="string">&quot;本节课是关于字符串的拆分&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">&#x27;    &#x27;left，mid，right函数</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print VBA.Left(str, 3)</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print VBA.Right(str, 3)</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;2个参数，表示截取哪个字符串，要从左/右截取字符串的长度</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print VBA.Mid(str, 4) &#x27;第3个参数，不填默认从指定的字符串开始，往后的所有内容都会获取到</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print VBA.Mid(str, 4, 3) &#x27;第3个参数，填了就表示，从第4个文字开始，想要获取几个长度的文字</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;有固定放分隔符，需要定义一个数组，由于不知道长度，就是不知道会拆分成几个，就定义1个动态数组</span></span><br><span class="line"><span class="comment">&#x27;    Dim SplitStr() As String</span></span><br><span class="line"><span class="comment">&#x27;    str = &quot;ACV-KJH-OMS-LLX&quot;</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;split函数：根据特定的字符对文本字符串进行拆分</span></span><br><span class="line"><span class="comment">&#x27;    SplitStr = Split(str, &quot;-&quot;, 2)</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;第1个参数表示，需要进行拆分的字符串</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;第2个参数表示，根据哪个分隔符拆分</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;第3个参数表示，我们想要把这个文本的字符串，想要拆分成几份，那么在从左往右拆分时，已拆到这个数量时，就不继续拆分，即使后面还有这个拆分符；不填的话就是有多少拆多少</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;第4个参数，有3中可选，我们这里进行更加详细的说明</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;    &#x27;想要展示数组，需要通过for循环，遍历数组内容</span></span><br><span class="line"><span class="comment">&#x27;    Dim index As Integer</span></span><br><span class="line"><span class="comment">&#x27;    For index = LBound(SplitStr) To UBound(SplitStr)</span></span><br><span class="line"><span class="comment">&#x27;        Debug.Print SplitStr(index)</span></span><br><span class="line"><span class="comment">&#x27;    Next index</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第4个参数就表示，假如是用英文字母做拆分符号，那么是否采用大小写敏感</span></span><br><span class="line">    </span><br><span class="line">    str = <span class="string">&quot;JKavcFGAJKLAHYH&quot;</span></span><br><span class="line">    <span class="comment">&#x27;这个字符串里，有大写的A和小写的a</span></span><br><span class="line">    <span class="comment">&#x27;假定我们就用字母Dd，把这个文本的字符串进行拆分</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;大小写敏感，表示和大小写相关，那么只会对A进行拆分，a不进行拆分</span></span><br><span class="line">    <span class="comment">&#x27;SplitStr = Split(str, &quot;A&quot;, , vbBinaryCompare)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;与数据库有关，目前暂时不学习，目前只涉及到excel，而不是数据库</span></span><br><span class="line">    <span class="comment">&#x27;SplitStr = Split(str, &quot;A&quot;, , vbDatabaseCompare)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;大小写不敏感，表示和大小写吧相关，A和a都会进行拆分</span></span><br><span class="line">    SplitStr = Split(str, <span class="string">&quot;A&quot;</span>, , vbTextCompare)</span><br><span class="line">    </span><br><span class="line">     <span class="comment">&#x27;想要展示数组，需要通过for循环，遍历数组内容</span></span><br><span class="line">    <span class="keyword">Dim</span> index <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> index = LBound(SplitStr) <span class="keyword">To</span> UBound(SplitStr)</span><br><span class="line">        Debug.Print SplitStr(index)</span><br><span class="line">    <span class="keyword">Next</span> index</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="拆分字符串应用案例"><a href="#拆分字符串应用案例" class="headerlink" title="拆分字符串应用案例"></a>拆分字符串应用案例</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetOrderPart(OrderInfoRange <span class="keyword">As</span> Range, index <span class="keyword">As</span> <span class="type">Integer</span>)</span><br><span class="line"><span class="comment">&#x27;编写一个子函数，函数名是GetOrderPart，&quot;意思是获得订单编号对应部分“；</span></span><br><span class="line"><span class="comment">&#x27;订单编号是类似ABC-123-jlj这样的数据</span></span><br><span class="line"><span class="comment">&#x27;第一个参数：设置了1个range类型的变量作为参数，指引用的单元格，也就是想要用短横线作为分隔符的原始数据/针对哪个单元格中的内容进行拆分</span></span><br><span class="line"><span class="comment">&#x27;第二个参数：用短横线作为分隔符，拆分后的字符串会有好几个，我们想要输出其中的第几个</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> InfoAray() <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    <span class="comment">&#x27;设置了一个文本类型的数组，用于接收拆分之后的信息</span></span><br><span class="line">    </span><br><span class="line">    InfoAray = Split(OrderInfoRange, <span class="string">&quot;-&quot;</span>)</span><br><span class="line">    <span class="comment">&#x27;拆分，针对单元格中的内容进行拆分，拆分的分隔符就是短横线；用InfoAray进行接收，会有&gt;=1个部分，组成了数组</span></span><br><span class="line">    </span><br><span class="line">    GetOrderPart = InfoAray(index - <span class="number">1</span>)</span><br><span class="line">    <span class="comment">&#x27;返回指定部分，即数组中的第(index-1)个：因为文本类型的数组是从0开始，所以index要减1；数组中的第(index-1)个就是这个函数的结果，即输出的结果</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<h2 id="连接字符串"><a href="#连接字符串" class="headerlink" title="连接字符串"></a>连接字符串</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> StringTest3()</span><br><span class="line">    <span class="keyword">Dim</span> str1 <span class="keyword">As</span> <span class="type">String</span>, str2 <span class="keyword">As</span> <span class="type">String</span>, str3 <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    str1 = <span class="string">&quot;蓦然回首&quot;</span></span><br><span class="line">    str2 = <span class="string">&quot;那人却在&quot;</span></span><br><span class="line">    str3 = <span class="string">&quot;灯火阑珊处&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;通过&amp;链接运算符</span></span><br><span class="line">    Debug.Print str1 &amp; <span class="string">&quot;，&quot;</span> &amp; str2 &amp; <span class="string">&quot;，&quot;</span> &amp; str3 &amp; <span class="string">&quot;。&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;通过VBA的Join函数，实现字符串数组元素的连接</span></span><br><span class="line">    <span class="comment">&#x27;第一步：把想要连接的内容，转变成字符串数组；</span></span><br><span class="line">    <span class="comment">&#x27;第二步：通过join函数进行连接，设定特点字符进行连接</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;先把str1.2.3转化成一个字符串的数组</span></span><br><span class="line">    <span class="keyword">Dim</span> strarray() <span class="keyword">As</span> Variant</span><br><span class="line">    <span class="comment">&#x27;声明一个可变的类型的动态数组</span></span><br><span class="line">    </span><br><span class="line">    strarray = Array(str1, str2, str3)</span><br><span class="line">    <span class="comment">&#x27;VBA有1个array函数，就是把变量包含的所有内容，作为这样的数组元素；用array函数处理之后，就会返回这样的1个数组</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print <span class="keyword">Join</span>(strarray, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> StrConcat(str1 <span class="keyword">As</span> <span class="type">String</span>, str2 <span class="keyword">As</span> <span class="type">String</span>, str3 <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"><span class="comment">&#x27;这个函数的用处在于把(str1, str2, str3)这3个文本的内容，用斜杠/连接起来</span></span><br><span class="line">    <span class="keyword">Dim</span> strarray() <span class="keyword">As</span> Variant</span><br><span class="line">    strarray = Array(str1, str2, str3)</span><br><span class="line">    StrConcat = <span class="keyword">Join</span>(strarray, <span class="string">&quot;/&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<h2 id="替换字符串"><a href="#替换字符串" class="headerlink" title="替换字符串"></a>替换字符串</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> StringTest4()</span><br><span class="line">    <span class="keyword">Dim</span> str <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    <span class="comment">&#x27;字符串穿插了很多d，其中有大写的和小写的</span></span><br><span class="line">    str = <span class="string">&quot;dfhDGHJdttDOO99gggd&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;把字符串中的小写d全都替换成短横线-</span></span><br><span class="line">    Debug.Print Replace(str, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;-&quot;</span>)</span><br><span class="line">    <span class="comment">&#x27;效果是【-fhDGHJ-ttDOO99ggg-】</span></span><br><span class="line">    <span class="comment">&#x27;默认情况下，大小写敏感</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第1个参数：需要对哪个字符串进行部分字符串的替换</span></span><br><span class="line">    <span class="comment">&#x27;第2个参数：对哪个字符串进行替换</span></span><br><span class="line">    <span class="comment">&#x27;第3个参数：替换成什么字符串</span></span><br><span class="line">    <span class="comment">&#x27;第4个参数：设置替换的起始位置，即从str第一个字符开始计数，从第几个字符串开始替换，没有设置为起点范围内的字符，都会自动被清除掉</span></span><br><span class="line">    <span class="comment">&#x27;第5个参数：设置替换的数量，替换了这么多之后，后面的就不再进行替换</span></span><br><span class="line">    <span class="comment">&#x27;第6个参数：大小写敏感，vbBinaryCompare——大小写敏感；vbTextCompare——大小写不敏感</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第6个参数：想要实现大小写不敏感的效果，需要去考虑最后一个参数</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;大小写敏感:</span></span><br><span class="line">    Debug.Print Replace(str, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;-&quot;</span>, , , vbBinaryCompare)</span><br><span class="line">    <span class="comment">&#x27;效果：【-fhDGHJ-ttDOO99ggg-】</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;大小写不敏感</span></span><br><span class="line">    Debug.Print Replace(str, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;-&quot;</span>, , , vbTextCompare)</span><br><span class="line">    <span class="comment">&#x27;效果：【-fh-GHJ-tt-OO99ggg-】</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第4个参数：设置替换的起始位置，即从str第一个字符开始计数，从第几个字符串开始替换，没有设置为起点范围内的字符，都会自动被清除掉</span></span><br><span class="line">    Debug.Print Replace(str, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="number">3</span>, , vbTextCompare)</span><br><span class="line">    <span class="comment">&#x27;效果：【h-GHJ-tt-OO99ggg-】</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;第5个参数：设置替换的数量，替换了这么多之后，后面的就不再进行替换</span></span><br><span class="line">    Debug.Print Replace(str, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="number">3</span>, <span class="number">2</span>, vbTextCompare)</span><br><span class="line">    <span class="comment">&#x27;效果：【h-GHJ-ttDOO99gggd】</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;目的是将JK替换为AC</span></span><br><span class="line"><span class="keyword">Function</span> replaceJKtoAC(orderinforange <span class="keyword">As</span> Range)</span><br><span class="line">    replaceJKtoAC = Replace(orderinforange.Value, <span class="string">&quot;JK&quot;</span>, <span class="string">&quot;AC&quot;</span>, , <span class="number">1</span>, vbTextCompare)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;有点像定义一个y=f(x),x&gt;0,y=(x+1)*(x-9)</span></span><br></pre></td></tr></table></figure>

<h2 id="字母大小写设置"><a href="#字母大小写设置" class="headerlink" title="字母大小写设置"></a>字母大小写设置</h2><p>大小写不敏感：vbTextCompare</p>
<p>大小写敏感：vbBinaryCompare</p>
<p>大小写设置本身就是很重要的一个点</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> StringTest5()</span><br><span class="line">    <span class="keyword">Dim</span> str1 <span class="keyword">As</span> <span class="type">String</span>, str2 <span class="keyword">As</span> <span class="type">String</span>, str3 <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    str1 = <span class="string">&quot;JK&quot;</span></span><br><span class="line">    str2 = <span class="string">&quot;jk&quot;</span></span><br><span class="line">    str3 = <span class="string">&quot;jkJK&quot;</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print str1 = str2</span><br><span class="line">    <span class="comment">&#x27;结果是False，说明：默认情况下，大小写敏感。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;comp,compare的缩写</span></span><br><span class="line">    Debug.Print StrComp(str1, str2, vbTextCompare)</span><br><span class="line">    <span class="comment">&#x27;结果是0，说明相等</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print StrComp(str1, str3, vbTextCompare)</span><br><span class="line">    <span class="comment">&#x27;结果是-1，说明不相等</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;切换大小写，可以使用函数LCase（小写处理）、Ucase（大写处理）</span></span><br><span class="line">    Debug.Print LCase(str1)</span><br><span class="line">    Debug.Print UCase(str2)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;切换大小写，也可以使用大小写切换函数，根据后面的参数，表现为不同的效果</span></span><br><span class="line">    <span class="comment">&#x27;Conv，Converter</span></span><br><span class="line">    Debug.Print StrConv(str3, vbUpperCase) <span class="comment">&#x27;全部变成大写</span></span><br><span class="line">    Debug.Print StrConv(str3, vbLowerCase) <span class="comment">&#x27;全部变成小写</span></span><br><span class="line">    Debug.Print StrConv(str3, vbProperCase) <span class="comment">&#x27;首字母变成大写，其他字母全都变成小写</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="查找字符串"><a href="#查找字符串" class="headerlink" title="查找字符串"></a>查找字符串</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> StringTest()</span><br><span class="line">    <span class="keyword">Dim</span> str <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    str = <span class="string">&quot;ABdCDdEAFdGaAbcddAefg&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;获取某个字母的起始位置</span></span><br><span class="line">    <span class="comment">&#x27;使用Instr查看在某个文本变量中，是否存在某个字符串，如果存在，就会返回相应的位置；</span></span><br><span class="line">    <span class="comment">&#x27;如果不存在，就返回0</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print InStr(1, str, &quot;d&quot;, vbBinaryCompare)</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print InStr(12, str, &quot;d&quot;, vbBinaryCompare)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;想要查找字母d出现的次数</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> index <span class="keyword">As</span> <span class="type">Integer</span>, count <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    index = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;只要还有“d”存在，就继续执行</span></span><br><span class="line">    <span class="keyword">While</span> index &lt;&gt; <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">        <span class="comment">&#x27;不加这段代码的话，档要查找的字符串是整个字符串的第一个字母的时候，会有bug</span></span><br><span class="line">        <span class="comment">&#x27;因为是从整个字符串的第二个字母开始查找的，那么第一个位置的字符串就会查找不到</span></span><br><span class="line">        <span class="keyword">If</span> count = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">            index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">        <span class="comment">&#x27;从上一次查找到的位置的右边开始，继续查找“d”的位置</span></span><br><span class="line">        index = InStr(index + <span class="number">1</span>, str, <span class="string">&quot;A&quot;</span>, vbBinaryCompare)</span><br><span class="line">        <span class="comment">&#x27;如果不为0，就继续查找</span></span><br><span class="line">        <span class="keyword">If</span> index &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">            count = count + <span class="number">1</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        Debug.Print index</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    Wend</span><br><span class="line">    </span><br><span class="line">    Debug.Print <span class="string">&quot;Count=&quot;</span> &amp; count</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="LIKE运算符"><a href="#LIKE运算符" class="headerlink" title="LIKE运算符"></a>LIKE运算符</h2><table>
<thead>
<tr>
<th>Pattern规则</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>零个或多个字符</td>
</tr>
<tr>
<td>?</td>
<td>任意单个字符</td>
</tr>
<tr>
<td>#</td>
<td>任何单个数字 (0-9)</td>
</tr>
<tr>
<td>[ charlist ]</td>
<td>charlist 内的任意单个字符</td>
</tr>
<tr>
<td>[ !charlist ]</td>
<td>charlist 外的任意单个字符</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>订单编号(练习素材)</th>
</tr>
</thead>
<tbody><tr>
<td>IPV-NSU-36456</td>
</tr>
<tr>
<td>TS-EYS-77G</td>
</tr>
<tr>
<td>HDC-HUJ-19481</td>
</tr>
<tr>
<td>OY-HX-815</td>
</tr>
<tr>
<td>LNG-ZSN-831</td>
</tr>
<tr>
<td>OS-SW-852</td>
</tr>
<tr>
<td>NVH-OHD-9376</td>
</tr>
<tr>
<td>OZW-SR-125</td>
</tr>
<tr>
<td>JI-TKX-132</td>
</tr>
<tr>
<td>FGX-CPZ-26532</td>
</tr>
<tr>
<td>EY-HXR-4334</td>
</tr>
<tr>
<td>UUK-IZT-46</td>
</tr>
<tr>
<td>ZUF-BCV-6146</td>
</tr>
<tr>
<td>GHW-UOU-457</td>
</tr>
<tr>
<td>SHN-MJN-37</td>
</tr>
<tr>
<td>DHD-OCT-3716</td>
</tr>
</tbody></table>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> StringTest()</span><br><span class="line">    <span class="comment">&#x27;Like：符合某个文本的模式</span></span><br><span class="line">    <span class="comment">&#x27;I*：设置了某个模型，含义就是以I字母开头</span></span><br><span class="line">    <span class="comment">&#x27;下面这行代码的意思就是，验证这个字符串是不是以字母A开头，是的话就输出TRUE，不是就输出FALSE</span></span><br><span class="line">    <span class="comment">&#x27;只有A这个字符，也是会返回TRUE</span></span><br><span class="line">    <span class="comment">&#x27;Debug.Print &quot;ABC-DEF-GHIJ&quot; Like &quot;A*&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> pattern <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;以O开头</span></span><br><span class="line">    <span class="comment">&#x27;pattern = &quot;O*&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;以两个字符开头</span></span><br><span class="line">    <span class="comment">&#x27;也就是短横线左侧有两个字符，所以要加个短横线；短横线右侧就可以有0个或者多个字符串，所以要加个*</span></span><br><span class="line">    <span class="comment">&#x27;pattern = &quot;??-*&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;以3个数字结尾，就是最后短横线后面只有3个数字</span></span><br><span class="line">    <span class="comment">&#x27;pattern = &quot;*-###&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;以O和G开头，记得加上双引号</span></span><br><span class="line">    <span class="comment">&#x27;pattern = &quot;[OG]*&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;不以O和G开头，记得加上双引号</span></span><br><span class="line">    <span class="comment">&#x27;pattern = &quot;[!OG]*&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;以O开头，两个字符开头，中间两个字符，三个数字结尾</span></span><br><span class="line">    pattern = <span class="string">&quot;O?-??-###&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> cell <span class="keyword">As</span> Range</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> cell <span class="keyword">In</span> Range(<span class="string">&quot;A2&quot;</span>, Range(<span class="string">&quot;A2&quot;</span>).<span class="keyword">End</span>(xlDown)) <span class="comment">&#x27;从A2开始的，到A2以下的所有单元格</span></span><br><span class="line">        cell.Font.Color = vbBlack <span class="comment">&#x27;如果重复操作几次，修改过格式，需要先把之前操作的格式清除，也就是把字体颜色变成黑色</span></span><br><span class="line">        <span class="keyword">If</span> cell.Value <span class="built_in">Like</span> pattern <span class="keyword">Then</span></span><br><span class="line">            cell.Font.Color = vbRed</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> cell</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="Excel内置函数的使用"><a href="#Excel内置函数的使用" class="headerlink" title="Excel内置函数的使用"></a>Excel内置函数的使用</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ExcelFunctionTest()</span><br><span class="line">    Range(<span class="string">&quot;E2&quot;</span>).Value = <span class="string">&quot;求和结果：&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;F2&quot;</span>).Value = Application.WorksheetFunction.Sum(Range(<span class="string">&quot;A1:A15&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;E3&quot;</span>).Value = <span class="string">&quot;最大值为：&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;F3&quot;</span>).Value = Application.WorksheetFunction.Max(Range(<span class="string">&quot;A1:A15&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;E4&quot;</span>).Value = <span class="string">&quot;最小值为：&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;F4&quot;</span>).Value = Application.WorksheetFunction.Min(Range(<span class="string">&quot;A1:A15&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;E6&quot;</span>).Value = <span class="string">&quot;排名第5的单元格的值为：&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;F6&quot;</span>).Value = Application.WorksheetFunction.Large(Range(<span class="string">&quot;A1:A15&quot;</span>), <span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Range(<span class="string">&quot;E8&quot;</span>).Value = <span class="string">&quot;对大于5000的数进行求和：&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;F8&quot;</span>).Value = Application.WorksheetFunction.SumIf(Range(<span class="string">&quot;A1:A15&quot;</span>), <span class="string">&quot;&gt;&quot;</span> &amp; <span class="number">5000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;并不是Excel所有的内置函数都可以进行使用</span></span><br><span class="line">    <span class="comment">&#x27;VBA函数包含的功能，与Excel内置函数有冲突时，Excel内置函数无法使用！</span></span><br><span class="line">    <span class="comment">&#x27;就是说，当你想用一个Excel内置函数却发现VBA不支持时，有可能是VBA自己有这个功能的函数</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;举例</span></span><br><span class="line">    <span class="comment">&#x27;无法使用Excel里面的rand函数生成随机数，因为VBA有这个功能的函数</span></span><br><span class="line">    <span class="comment">&#x27;Application.WorksheetFunction.Rand</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;初始化随机数：0~1（不包含）</span></span><br><span class="line">    <span class="comment">&#x27;会在H4单元格生成一个0~1（不包含）之间的随机数</span></span><br><span class="line">    VBA.Randomize</span><br><span class="line">    Range(<span class="string">&quot;H3&quot;</span>).Value = <span class="string">&quot;生成一个0~1（不包含）之间的随机数&quot;</span></span><br><span class="line">    Range(<span class="string">&quot;H4&quot;</span>).Value = VBA.Rnd</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h1 id="【Chapter-5】VBA异常和事件处理"><a href="#【Chapter-5】VBA异常和事件处理" class="headerlink" title="【Chapter 5】VBA异常和事件处理"></a>【Chapter 5】VBA异常和事件处理</h1><h2 id="VBA程序异常OnError处理"><a href="#VBA程序异常OnError处理" class="headerlink" title="VBA程序异常OnError处理"></a>VBA程序异常OnError处理</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ExceptionTest1()</span><br><span class="line">    <span class="keyword">Dim</span> Num <span class="keyword">As</span> Variant</span><br><span class="line">    </span><br><span class="line">    Num = InputBox(<span class="string">&quot;请输入一个数字：&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;输出输入的数字的平方根</span></span><br><span class="line"><span class="comment">&#x27;    Debug.Print VBA.Sqr(Num)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;假如输入的是负数/文本/空值，就会报错</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;思路一：用if和msgbox</span></span><br><span class="line">    <span class="keyword">If</span> Num &lt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;请不要输入负数&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> <span class="built_in">Not</span> VBA.IsNumeric(Num) <span class="keyword">Then</span></span><br><span class="line">        MsgBox <span class="string">&quot;请输入数字&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        Debug.Print VBA.Sqr(Num)</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ExceptionTest2()</span><br><span class="line">    <span class="keyword">Dim</span> Num <span class="keyword">As</span> Variant</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果出现错误，就跳过其他代码，直接跳转到相应标签</span></span><br><span class="line">    <span class="comment">&#x27;如果没有这行代码，那么输入负数/文本/空值时，就会提示错误</span></span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> ErrorHandler</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Num = InputBox(<span class="string">&quot;请输入一个数字：&quot;</span>)</span><br><span class="line">    Debug.Print VBA.Sqr(Num)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;没有错误，不再显示错误信息</span></span><br><span class="line">    <span class="comment">&#x27;如果没有这段代码，那么输入正数时，代码运行没有任何错误时，也会弹窗“请确认输入一个正数”</span></span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    </span><br><span class="line"><span class="symbol">ErrorHandler:</span></span><br><span class="line">    MsgBox <span class="string">&quot;请确认输入一个正数&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ExceptionTest3()</span><br><span class="line">    <span class="keyword">Dim</span> Num <span class="keyword">As</span> Variant</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;出现错误，跳过继续执行；可以跳过不止一次</span></span><br><span class="line">    <span class="comment">&#x27;没有这段代码，代码执行会报错；加上这段代码，就代码不会报错，只是继续往下执行：弹窗“异常”</span></span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Num = InputBox(<span class="string">&quot;请输入一个数字：&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    Debug.Print VBA.Sqr(Num)</span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    </span><br><span class="line">    MsgBox <span class="string">&quot;VBA异常处理1&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;如果不想要下面的代码出现错误时，和上面是一样的处理方式，那么就用这段代码</span></span><br><span class="line">    <span class="comment">&#x27;重置错误默认处理方式</span></span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    Debug.Print <span class="number">1</span> / <span class="number">0</span> <span class="comment">&#x27;不会在立即窗口出现结果，因为有上面的代码，所以出现错误就跳过了，继续执行接下来的代码</span></span><br><span class="line">    </span><br><span class="line">    MsgBox <span class="string">&quot;VBA异常处理2&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="VBA程序异常Resume处理"><a href="#VBA程序异常Resume处理" class="headerlink" title="VBA程序异常Resume处理"></a>VBA程序异常Resume处理</h2><p>可以考虑再听一遍课程，resume的三种用法下，代码的运行逻辑不一样</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ExceptionTest()</span><br><span class="line">    <span class="keyword">Dim</span> Num <span class="keyword">As</span> Variant</span><br><span class="line">        </span><br><span class="line"><span class="symbol">InputNum:</span></span><br><span class="line">    <span class="comment">&#x27;如果出现错误，就跳过其他代码，直接跳转到相应标签</span></span><br><span class="line">    <span class="comment">&#x27;如果没有这行代码，那么输入负数/文本/空值时，就会提示错误</span></span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> ErrorHandler</span><br><span class="line"></span><br><span class="line">    Num = InputBox(<span class="string">&quot;请输入一个数字：&quot;</span>)</span><br><span class="line">    Debug.Print VBA.Sqr(Num)</span><br><span class="line">    </span><br><span class="line">    MsgBox <span class="string">&quot;VBA代码异常&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;没有错误，不再显示错误信息</span></span><br><span class="line">    <span class="comment">&#x27;如果没有这段代码，那么输入正数时，代码运行没有任何错误时，也会弹窗“请确认输入一个正数”</span></span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">    </span><br><span class="line"><span class="symbol">ErrorHandler:</span></span><br><span class="line">    MsgBox <span class="string">&quot;请确认输入一个正数&quot;</span></span><br><span class="line">    <span class="comment">&#x27;弹出这个窗口后，点击“确定”，这个程序就结束了，这是因为程序的意思是，</span></span><br><span class="line">    <span class="comment">&#x27;出现错误后直接跳过其他代码，跳转到这个弹窗，作用仅仅是弹窗一下</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;resume有三种使用方式：</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;方法一：</span></span><br><span class="line">    <span class="comment">&#x27;如果想要弹窗之后，处理错误之后，继续允许输入数字，再写一个标签InputNum，到达相应的标签处再次运行</span></span><br><span class="line"><span class="comment">&#x27;    Resume InputNum</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;方法二：</span></span><br><span class="line">    <span class="comment">&#x27;跳过错误的代码行，继续执行</span></span><br><span class="line"><span class="comment">&#x27;    Resume Next</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;方法三：</span></span><br><span class="line">    <span class="comment">&#x27;从出现错误的代码处开始执行（就是Debug.Print VBA.Sqr(Num)这一行）</span></span><br><span class="line">    <span class="comment">&#x27;如果进入死循环，就长按ESC按钮；</span></span><br><span class="line">    <span class="comment">&#x27;如果出现错误，就将num赋值为100</span></span><br><span class="line">    <span class="comment">&#x27;Num=100</span></span><br><span class="line">    Num = -Num</span><br><span class="line">    <span class="keyword">Resume</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="VBA程序Bug处理技巧"><a href="#VBA程序Bug处理技巧" class="headerlink" title="VBA程序Bug处理技巧"></a>VBA程序Bug处理技巧</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"><span class="keyword">Sub</span> DebugTest1()</span><br><span class="line">    <span class="comment">&#x27;编译错误</span></span><br><span class="line">    <span class="comment">&#x27;查看代码，确保代码语法没有问题</span></span><br><span class="line">    <span class="comment">&#x27;比如这里少了个括号或者英文引号之类的</span></span><br><span class="line">    Range(<span class="string">&quot;A1&quot;</span>).Value = <span class="number">100</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DebugTest2()</span><br><span class="line">    <span class="comment">&#x27;运行时错误</span></span><br><span class="line">    <span class="comment">&#x27;执行代码的时候，如果代码行数很多，遇到了“运行时错误”，且不知道哪一行代码错了</span></span><br><span class="line">    <span class="comment">&#x27;1. 可以点击【调试】按钮，它会提示你哪一行代码错了</span></span><br><span class="line">    <span class="comment">&#x27;2. 还可以通过注释某一行代码的方式，去缩小错误排查范围</span></span><br><span class="line">    <span class="comment">&#x27;3. 也可以通过逐语句执行的方式</span></span><br><span class="line">    <span class="keyword">Dim</span> Num <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> Num = <span class="number">1</span> <span class="keyword">To</span> <span class="number">10</span></span><br><span class="line">        Range(<span class="string">&quot;A&quot;</span> &amp; Num).Value = Num * <span class="number">100</span></span><br><span class="line">        Range(<span class="string">&quot;A&quot;</span> &amp; Num).Interior.Color = vbRed</span><br><span class="line">    <span class="keyword">Next</span> Num</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> DebugTest3()</span><br><span class="line"><span class="comment">&#x27;1. 明确非常常见的错误：程序没有语法错误，而是程序执行的结果并没有出现预期的结果，逻辑性错误。</span></span><br><span class="line"><span class="comment">&#x27;2. 针对程序的逻辑性错误，就需要通过变量或者表达式在执行的过程中的内容判定逻辑问题出在哪里。</span></span><br><span class="line"><span class="comment">&#x27;3. 有三种方式查看变量的内容。本地窗口、监控窗口、立即窗口</span></span><br><span class="line"><span class="comment">&#x27;4. 打断点：希望程序在哪个位置停止运行，方便我们查看当前状态下的变量以及表达式的内容。</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;1. 可以逐行写注释，来展示思路</span></span><br><span class="line">    <span class="comment">&#x27;2. 还可以通过打断点的方式，就是在这行代码的左侧，点一下红色，会有个红点</span></span><br><span class="line">        <span class="comment">&#x27;这个红点的意思就是：程序运行时，到达这个断点之后，就停止了运行，可以查看到达这个断点的时候，各个变量的数值是多少（有点麻烦）</span></span><br><span class="line">    <span class="comment">&#x27;3. 想要看到各个变量的值，还可以去【视图-本地窗口】，可以看到当前的子程序中，所有的相关的变量所发生的变化</span></span><br><span class="line">    <span class="comment">&#x27;4. 【视图-立即窗口】，输入【?Num1】，然后回车，可以展示当前变量的值</span></span><br><span class="line">    <span class="comment">&#x27;5. 【视图-监视窗口】，可以指定想要监视某个变量，比如想要监视变量num1，就鼠标点在num1处，右击，点击“添加监视”；</span></span><br><span class="line">        <span class="comment">&#x27;【监视窗口】，除了可以监视变量，还可以监视表达式，比如想要监视【Num1 * Num2】的结果，就鼠标左键选中代码中的Num1 * Num2，然后右击“添加监视”；监视【Num2 &amp; &quot;*&quot; &amp; Num1 &amp; &quot;=&quot; &amp; (Num1 * Num2)】也可以</span></span><br><span class="line">    <span class="keyword">Dim</span> Num1 <span class="keyword">As</span> <span class="type">Integer</span>, Num2 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;将num1作为行数</span></span><br><span class="line">    <span class="keyword">For</span> Num1 = <span class="number">1</span> <span class="keyword">To</span> <span class="number">9</span></span><br><span class="line">        <span class="comment">&#x27;将num2作为列数</span></span><br><span class="line">        <span class="keyword">For</span> Num2 = <span class="number">1</span> <span class="keyword">To</span> <span class="number">9</span></span><br><span class="line">            <span class="comment">&#x27;只有行数大于列数的时候，才会执行相应的内容设置代码</span></span><br><span class="line">            <span class="keyword">If</span> Num1 &gt;= Num2 <span class="keyword">Then</span></span><br><span class="line">                <span class="comment">&#x27;设置相应单元格的内容</span></span><br><span class="line">                Cells(Num1, Num2) = Num2 &amp; <span class="string">&quot;*&quot;</span> &amp; Num1 &amp; <span class="string">&quot;=&quot;</span> &amp; (Num1 * Num2)</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">Next</span> Num2</span><br><span class="line">    <span class="keyword">Next</span> Num1</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<h2 id="工作表—事件处理程序"><a href="#工作表—事件处理程序" class="headerlink" title="工作表—事件处理程序"></a>工作表—事件处理程序</h2><h2 id="工作簿—事件处理程序"><a href="#工作簿—事件处理程序" class="headerlink" title="工作簿—事件处理程序"></a>工作簿—事件处理程序</h2><h1 id="【Chapter-6】MsgBox和InputBox"><a href="#【Chapter-6】MsgBox和InputBox" class="headerlink" title="【Chapter 6】MsgBox和InputBox"></a>【Chapter 6】MsgBox和InputBox</h1><p>MsgBox各个参数的作用</p>
<p>MsgBox返回值处理技巧</p>
<p>InputBox函数的使用方式</p>
<p>InputBox函数的Type参数使用</p>
<p>【Chapter 7】VBA工作应用实战</p>
<p>拆分工作表（上）</p>
<p>拆分工作表（下）</p>
<p>多工作表合并</p>
<p>拆分成多工作簿</p>
<p>多工作簿合并</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://yoursite.com">JiuGuiChen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/">http://yoursite.com/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://yoursite.com" target="_blank">九规而已</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/Excel.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/01/18/%E5%9F%BA%E9%87%91%E6%94%BB%E7%95%A5/" title="基金攻略"><img class="cover" src="/img/jijin.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">基金攻略</div></div><div class="info-2"><div class="info-item-1">雪球基金第一课 目录 序方三文：投资基金能否实现财务自由？ 一、普通人财富管理的最佳选择1.1 公募基金的优势1.1.1 买基金≠买股票基金就是我们把钱委托给基金公司，交给基金经理进行打理，然后去买各种资产。本质上，基金是一个个的投资组合，投资者能赚多少钱，主要看底层投的是什么资产。总之，基金并不是什么具体的投资标的，而是一种投资工具。公募基金经过了20年的发展，覆盖范围极广，目前各个大类资产类别均有公募基金的身影。不管是常见的股票债券，还是美国、日本、印度、越南等海外市场的QDII基金，亦或是黄金、石油、豆粕、生猪等商品基金，甚至是房地产等实物资产基金（REITs）……基金几乎覆盖了所有你能想到的投资品种，堪称“万物皆可基金”。这也意味着，普通投资者可以通过公募基金，一站式实现多元资产配置。 1.1.2 投资门槛低不需要太多的时间、足够多的本金以及软件能力，也不需要财务知识、看得懂经济形势等，更不需要非常强大的心理承受能力和执行力 只需要根据自己的需求选择合适的基金产品，对市场和整个投资组合有一个简单的把控，即可。 1.1.3...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JiuGuiChen</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JiuGuiChen"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎光临我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Chapter-1%E3%80%911%E5%AE%8F%E5%BD%95%E5%88%B6%E6%96%B9%E6%B3%95%E4%B8%8E%E6%8A%80%E5%B7%A7"><span class="toc-number">1.</span> <span class="toc-text">【Chapter 1】1宏录制方法与技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%8F%E5%92%8CVBA"><span class="toc-number">1.1.</span> <span class="toc-text">什么是宏和VBA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8F%E5%AE%89%E5%85%A8%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">宏安全设置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Chapter-2%E3%80%91VBA%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">【Chapter 2】VBA编程基础语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%AF%B9%E5%BC%95%E7%94%A8"><span class="toc-number">2.1.</span> <span class="toc-text">相对引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E5%AE%8F%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text">运行宏的方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E7%BC%96%E5%86%99VBA%E4%BB%A3%E7%A0%81"><span class="toc-number">2.3.</span> <span class="toc-text">自己编写VBA代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AAVBA%E7%A8%8B%E5%BA%8F%E5%8F%8A%E5%BC%95%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%86%85%E5%AE%B9"><span class="toc-number">2.4.</span> <span class="toc-text">多个VBA程序及引用单元格内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-number">2.5.</span> <span class="toc-text">变量的含义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%98%E9%87%8F"><span class="toc-number">2.6.</span> <span class="toc-text">不同数据类型的变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E"><span class="toc-number">2.7.</span> <span class="toc-text">多变量声明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Variant%E5%8F%AF%E5%8F%98%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.8.</span> <span class="toc-text">Variant可变数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E"><span class="toc-number">2.9.</span> <span class="toc-text">强制变量声明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.10.</span> <span class="toc-text">变量的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#static%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="toc-number">2.11.</span> <span class="toc-text">static修饰符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.12.</span> <span class="toc-text">常量的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.13.</span> <span class="toc-text">数学运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.14.</span> <span class="toc-text">比较运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.15.</span> <span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VBA%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">2.16.</span> <span class="toc-text">VBA命名规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#If%E9%80%89%E6%8B%A9%E7%BB%93%E6%9E%84"><span class="toc-number">2.17.</span> <span class="toc-text">If选择结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SelectCase%E9%80%89%E6%8B%A9%E7%BB%93%E6%9E%84"><span class="toc-number">2.18.</span> <span class="toc-text">SelectCase选择结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#For-Next%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">2.19.</span> <span class="toc-text">For-Next循环结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#For-Next%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84-1"><span class="toc-number">2.20.</span> <span class="toc-text">For-Next循环结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.21.</span> <span class="toc-text">Step的应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%B8%AD%E6%96%ADFor%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.22.</span> <span class="toc-text">如何中断For循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97for%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.23.</span> <span class="toc-text">嵌套for循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DoUntil%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">2.24.</span> <span class="toc-text">DoUntil循环结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E6%97%A0%E5%8F%82%E6%95%B0%E5%AD%90%E8%BF%87%E7%A8%8B"><span class="toc-number">2.25.</span> <span class="toc-text">编写无参数子过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E5%8F%82%E6%95%B0%E5%AD%90%E8%BF%87%E7%A8%8B%E7%9A%84%E7%BC%96%E5%86%99%E5%92%8C%E8%B0%83%E7%94%A8"><span class="toc-number">2.26.</span> <span class="toc-text">有参数子过程的编写和调用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-number">2.26.1.</span> <span class="toc-text">一个参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-number">2.26.2.</span> <span class="toc-text">多个参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%EF%BC%9AFunction%E8%A1%A8%E7%A4%BA%E5%87%BD%E6%95%B0%E8%BF%87%E7%A8%8B"><span class="toc-number">2.27.</span> <span class="toc-text">编写自定义函数：Function表示函数过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">2.28.</span> <span class="toc-text">一维数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Option-Base"><span class="toc-number">2.29.</span> <span class="toc-text">Option Base</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">2.30.</span> <span class="toc-text">二维数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84"><span class="toc-number">2.31.</span> <span class="toc-text">动态数组</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Chapter-3%E3%80%91%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%92%8C%E4%B8%89"><span class="toc-number">3.</span> <span class="toc-text">【Chapter 3】面向对象和三</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E5%85%A5%E9%97%A8%EF%BC%89"><span class="toc-number">3.1.</span> <span class="toc-text">理解面向对象（入门）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%B1%82%E7%BA%A7%E6%A1%86%E6%9E%B6"><span class="toc-number">3.2.</span> <span class="toc-text">对象层级框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E5%BC%95%E7%94%A8"><span class="toc-number">3.3.</span> <span class="toc-text">单元格引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cells%E5%92%8COffset%E5%B1%9E%E6%80%A7"><span class="toc-number">3.4.</span> <span class="toc-text">Cells和Offset属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Select%E5%92%8CActivate%E6%96%B9%E6%B3%95"><span class="toc-number">3.5.</span> <span class="toc-text">Select和Activate方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1%E7%9A%84End%E5%B1%9E%E6%80%A7"><span class="toc-number">3.6.</span> <span class="toc-text">Range对象的End属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E5%89%AA%E5%88%87%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4"><span class="toc-number">3.7.</span> <span class="toc-text">Range对象_剪切复制粘贴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E5%85%AC%E5%BC%8F"><span class="toc-number">3.8.</span> <span class="toc-text">Range对象_设置单元格公式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E9%80%89%E6%8B%A9%E6%80%A7%E7%B2%98%E8%B4%B4"><span class="toc-number">3.9.</span> <span class="toc-text">Range对象_选择性粘贴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E5%AD%97%E4%BD%93%E6%95%88%E6%9E%9C"><span class="toc-number">3.10.</span> <span class="toc-text">Range对象_设置字体效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%96%87%E6%A1%A3%E6%9F%A5%E7%9C%8B%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="toc-number">3.11.</span> <span class="toc-text">通过文档查看对象属性和方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#With%E8%AF%AD%E6%B3%95%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.12.</span> <span class="toc-text">With语法使用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E8%BE%B9%E6%A1%86%E7%BA%BF"><span class="toc-number">3.13.</span> <span class="toc-text">Range对象_设置边框线</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E5%A1%AB%E5%85%85%E9%A2%9C%E8%89%B2"><span class="toc-number">3.14.</span> <span class="toc-text">Range对象_设置填充颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F"><span class="toc-number">3.15.</span> <span class="toc-text">Range对象_设置对齐方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E7%BC%A9%E8%BF%9B%E5%A4%A7%E5%B0%8F"><span class="toc-number">3.16.</span> <span class="toc-text">Range对象_设置缩进大小</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E6%8D%A2%E8%A1%8C"><span class="toc-number">3.17.</span> <span class="toc-text">Range对象_设置自动换行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">3.18.</span> <span class="toc-text">Range对象_合并单元格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E9%98%BB%E6%AD%A2Excel%E6%8F%90%E9%86%92%E5%BC%B9%E7%AA%97%E5%87%BA%E7%8E%B0"><span class="toc-number">3.19.</span> <span class="toc-text">Range对象_阻止Excel提醒弹窗出现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.20.</span> <span class="toc-text">Range对象_设置数字格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E6%8F%92%E5%85%A5%E5%88%A0%E9%99%A4%E8%A1%8C%E5%92%8C%E5%88%97-%E5%88%A0%E9%99%A4-%E6%B8%85%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">3.21.</span> <span class="toc-text">Range对象_插入删除行和列+删除&#x2F;清除单元格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E8%AE%BE%E7%BD%AE%E8%A1%8C%E9%AB%98%E4%B8%8E%E5%88%97%E5%AE%BD"><span class="toc-number">3.22.</span> <span class="toc-text">Range对象_设置行高与列宽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E9%9A%90%E8%97%8F%E5%92%8C%E5%8F%96%E6%B6%88%E9%9A%90%E8%97%8F-%E8%A1%8C%E5%92%8C%E5%88%97"><span class="toc-number">3.23.</span> <span class="toc-text">Range对象_隐藏和取消隐藏 行和列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Range%E5%AF%B9%E8%B1%A1-%E6%B8%85%E9%99%A4%E5%8D%95%E5%85%83%E6%A0%BC%E6%A0%BC%E5%BC%8F%E5%8F%8A%E5%86%85%E5%AE%B9"><span class="toc-number">3.24.</span> <span class="toc-text">Range对象_清除单元格格式及内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sheets%E5%AF%B9%E8%B1%A1-Sheets%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">3.25.</span> <span class="toc-text">Sheets对象_Sheets对象的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sheets%E5%AF%B9%E8%B1%A1-%E6%B7%BB%E5%8A%A0%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">3.26.</span> <span class="toc-text">Sheets对象_添加工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sheets%E5%AF%B9%E8%B1%A1-%E7%A7%BB%E5%8A%A8%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">3.27.</span> <span class="toc-text">Sheets对象_移动工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sheets%E5%AF%B9%E8%B1%A1-%E5%A4%8D%E5%88%B6%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">3.28.</span> <span class="toc-text">Sheets对象_复制工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sheets%E5%AF%B9%E8%B1%A1-%E9%9A%90%E8%97%8F%E5%92%8C%E5%88%A0%E9%99%A4%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">3.29.</span> <span class="toc-text">Sheets对象_隐藏和删除工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Workbooks%E5%AF%B9%E8%B1%A1-%E6%96%B0%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">3.30.</span> <span class="toc-text">Workbooks对象_新建工作簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Workbooks%E5%AF%B9%E8%B1%A1-%E6%89%93%E5%BC%80%E5%92%8C%E5%85%B3%E9%97%AD%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">3.31.</span> <span class="toc-text">Workbooks对象_打开和关闭工作簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Workbooks%E5%AF%B9%E8%B1%A1-%E4%BF%9D%E5%AD%98%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">3.32.</span> <span class="toc-text">Workbooks对象_保存工作簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Workbooks%E5%AF%B9%E8%B1%A1-%E5%88%A0%E9%99%A4%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">3.33.</span> <span class="toc-text">Workbooks对象_删除工作簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Workbooks%E5%AF%B9%E8%B1%A1-%E6%98%BE%E7%A4%BA%E6%96%87%E6%A1%A3%E7%9A%84%E5%90%8D%E7%A7%B0%E5%8F%8A%E8%B7%AF%E5%BE%84"><span class="toc-number">3.34.</span> <span class="toc-text">Workbooks对象_显示文档的名称及路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ForEach%E9%81%8D%E5%8E%86%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">3.35.</span> <span class="toc-text">使用ForEach遍历工作簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ForEach%E9%81%8D%E5%8E%86%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">3.36.</span> <span class="toc-text">使用ForEach遍历工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ForEach%E9%81%8D%E5%8E%86%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">3.37.</span> <span class="toc-text">使用ForEach遍历单元格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Chapter-4%E3%80%91VBA%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%96%87%E6%9C%AC%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">【Chapter 4】VBA日期与文本函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">4.1.</span> <span class="toc-text">日期类型数据基础知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">日期格式化操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E8%AE%A1%E7%AE%97%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.</span> <span class="toc-text">日期计算操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98"><span class="toc-number">4.4.</span> <span class="toc-text">日期案例实战</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">4.5.</span> <span class="toc-text">文本类型数据基础知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.6.</span> <span class="toc-text">拆分字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">4.7.</span> <span class="toc-text">拆分字符串应用案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.8.</span> <span class="toc-text">连接字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.9.</span> <span class="toc-text">替换字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E6%AF%8D%E5%A4%A7%E5%B0%8F%E5%86%99%E8%AE%BE%E7%BD%AE"><span class="toc-number">4.10.</span> <span class="toc-text">字母大小写设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.11.</span> <span class="toc-text">查找字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LIKE%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.12.</span> <span class="toc-text">LIKE运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Excel%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.13.</span> <span class="toc-text">Excel内置函数的使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Chapter-5%E3%80%91VBA%E5%BC%82%E5%B8%B8%E5%92%8C%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">【Chapter 5】VBA异常和事件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VBA%E7%A8%8B%E5%BA%8F%E5%BC%82%E5%B8%B8OnError%E5%A4%84%E7%90%86"><span class="toc-number">5.1.</span> <span class="toc-text">VBA程序异常OnError处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VBA%E7%A8%8B%E5%BA%8F%E5%BC%82%E5%B8%B8Resume%E5%A4%84%E7%90%86"><span class="toc-number">5.2.</span> <span class="toc-text">VBA程序异常Resume处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VBA%E7%A8%8B%E5%BA%8FBug%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7"><span class="toc-number">5.3.</span> <span class="toc-text">VBA程序Bug处理技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E2%80%94%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">5.4.</span> <span class="toc-text">工作表—事件处理程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E7%B0%BF%E2%80%94%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">5.5.</span> <span class="toc-text">工作簿—事件处理程序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Chapter-6%E3%80%91MsgBox%E5%92%8CInputBox"><span class="toc-number">6.</span> <span class="toc-text">【Chapter 6】MsgBox和InputBox</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/26/%E3%80%90Excel%E9%AB%98%E9%98%B6%E3%80%91%E5%AE%8F%E4%B8%8EVBA/" title="【Excel高阶】宏与VBA">【Excel高阶】宏与VBA</a><time datetime="2025-02-26T14:41:14.000Z" title="发表于 2025-02-26 22:41:14">2025-02-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/18/%E5%9F%BA%E9%87%91%E6%94%BB%E7%95%A5/" title="基金攻略">基金攻略</a><time datetime="2025-01-18T14:38:15.000Z" title="发表于 2025-01-18 22:38:15">2025-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/18/%E8%BA%B2%E5%9C%A8%E8%9A%8A%E5%AD%90%E8%83%8C%E5%90%8E%E7%9A%84%E5%A4%A7%E8%B1%A1/" title="躲在蚊子背后的大象">躲在蚊子背后的大象</a><time datetime="2025-01-18T09:03:30.000Z" title="发表于 2025-01-18 17:03:30">2025-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/21/B%E7%AB%99%E7%9B%B8%E5%85%B3/" title="B站相关">B站相关</a><time datetime="2024-12-21T11:58:49.000Z" title="发表于 2024-12-21 19:58:49">2024-12-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/21/%E5%B8%B8%E7%94%A8%E7%BD%91%E7%AB%99/" title="常用网站">常用网站</a><time datetime="2024-12-21T06:55:03.000Z" title="发表于 2024-12-21 14:55:03">2024-12-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By JiuGuiChen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.3</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>